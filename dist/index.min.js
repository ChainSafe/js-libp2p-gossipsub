(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PGossipsub=(()=>{var Dh=Object.create;var es=Object.defineProperty;var kh=Object.getOwnPropertyDescriptor;var Mh=Object.getOwnPropertyNames;var Nh=Object.getPrototypeOf,Lh=Object.prototype.hasOwnProperty;var Na=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var G=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Re=(e,t)=>{for(var r in t)es(e,r,{get:t[r],enumerable:!0})},La=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Mh(t))!Lh.call(e,s)&&s!==r&&es(e,s,{get:()=>t[s],enumerable:!(n=kh(t,s))||n.enumerable});return e};var he=(e,t,r)=>(r=e!=null?Dh(Nh(e)):{},La(t||!e||!e.__esModule?es(r,"default",{value:e,enumerable:!0}):r,e)),Oh=e=>La(es({},"__esModule",{value:!0}),e);var fc=G((u2,uc)=>{var jr=1e3,$r=jr*60,Yr=$r*60,br=Yr*24,Yl=br*7,Zl=br*365.25;uc.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Ql(e);if(r==="number"&&isFinite(e))return t.long?Jl(e):Xl(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ql(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Zl;case"weeks":case"week":case"w":return r*Yl;case"days":case"day":case"d":return r*br;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Yr;case"minutes":case"minute":case"mins":case"min":case"m":return r*$r;case"seconds":case"second":case"secs":case"sec":case"s":return r*jr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Xl(e){var t=Math.abs(e);return t>=br?Math.round(e/br)+"d":t>=Yr?Math.round(e/Yr)+"h":t>=$r?Math.round(e/$r)+"m":t>=jr?Math.round(e/jr)+"s":e+"ms"}function Jl(e){var t=Math.abs(e);return t>=br?ss(e,t,br,"day"):t>=Yr?ss(e,t,Yr,"hour"):t>=$r?ss(e,t,$r,"minute"):t>=jr?ss(e,t,jr,"second"):e+" ms"}function ss(e,t,r,n){var s=t>=r*1.5;return Math.round(e/r)+" "+n+(s?"s":"")}});var lc=G((f2,hc)=>{function ep(e){r.debug=r,r.default=r,r.coerce=f,r.disable=i,r.enable=s,r.enabled=o,r.humanize=fc(),r.destroy=u,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let h=0;for(let l=0;l<c.length;l++)h=(h<<5)-h+c.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(c){let h,l=null,g,p;function d(...y){if(!d.enabled)return;let m=d,E=Number(new Date),x=E-(h||E);m.diff=x,m.prev=h,m.curr=E,h=E,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let C=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(w,_)=>{if(w==="%%")return"%";C++;let A=r.formatters[_];if(typeof A=="function"){let F=y[C];w=A.call(m,F),y.splice(C,1),C--}return w}),r.formatArgs.call(m,y),(m.log||r.log).apply(m,y)}return d.namespace=c,d.useColors=r.useColors(),d.color=r.selectColor(c),d.extend=n,d.destroy=r.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,p=r.enabled(c)),p),set:y=>{l=y}}),typeof r.init=="function"&&r.init(d),d}function n(c,h){let l=r(this.namespace+(typeof h>"u"?":":h)+c);return l.log=this.log,l}function s(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let h,l=(typeof c=="string"?c:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)l[h]&&(c=l[h].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(c))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function f(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}hc.exports=ep});var pc=G((rt,is)=>{rt.formatArgs=rp;rt.save=np;rt.load=sp;rt.useColors=tp;rt.storage=ip();rt.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();rt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function tp(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function rp(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+is.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),e.splice(n,0,t)}rt.log=console.debug||console.log||(()=>{});function np(e){try{e?rt.storage.setItem("debug",e):rt.storage.removeItem("debug")}catch{}}function sp(){let e;try{e=rt.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function ip(){try{return localStorage}catch{}}is.exports=lc()(rt);var{formatters:op}=is.exports;op.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var gc=G((m2,dc)=>{"use strict";dc.exports=cp;function cp(e,t){for(var r=new Array(arguments.length-1),n=0,s=2,i=!0;s<arguments.length;)r[n++]=arguments[s++];return new Promise(function(a,f){r[n]=function(c){if(i)if(i=!1,c)f(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{e.apply(t||null,r)}catch(u){i&&(i=!1,f(u))}})}});var vc=G(bc=>{"use strict";var us=bc;us.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var Zr=new Array(64),mc=new Array(123);for(lt=0;lt<64;)mc[Zr[lt]=lt<26?lt+65:lt<52?lt+71:lt<62?lt-4:lt-59|43]=lt++;var lt;us.encode=function(t,r,n){for(var s=null,i=[],o=0,a=0,f;r<n;){var u=t[r++];switch(a){case 0:i[o++]=Zr[u>>2],f=(u&3)<<4,a=1;break;case 1:i[o++]=Zr[f|u>>4],f=(u&15)<<2,a=2;break;case 2:i[o++]=Zr[f|u>>6],i[o++]=Zr[u&63],a=0;break}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),o=0)}return a&&(i[o++]=Zr[f],i[o++]=61,a===1&&(i[o++]=61)),s?(o&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))};var yc="invalid encoding";us.decode=function(t,r,n){for(var s=n,i=0,o,a=0;a<t.length;){var f=t.charCodeAt(a++);if(f===61&&i>1)break;if((f=mc[f])===void 0)throw Error(yc);switch(i){case 0:o=f,i=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,i=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,i=3;break;case 3:r[n++]=(o&3)<<6|f,i=0;break}}if(i===1)throw Error(yc);return n-s};us.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var wc=G((v2,xc)=>{"use strict";xc.exports=fs;function fs(){this._listeners={}}fs.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};fs.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],s=0;s<n.length;)n[s].fn===r?n.splice(s,1):++s;return this};fs.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],s=1;s<arguments.length;)n.push(arguments[s++]);for(s=0;s<r.length;)r[s].fn.apply(r[s++].ctx,n)}return this}});var Tc=G((x2,Bc)=>{"use strict";Bc.exports=Sc(Sc);function Sc(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function s(f,u,c){t[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3]}function i(f,u,c){t[0]=f,u[c]=r[3],u[c+1]=r[2],u[c+2]=r[1],u[c+3]=r[0]}e.writeFloatLE=n?s:i,e.writeFloatBE=n?i:s;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],t[0]}function a(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],t[0]}e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(n,s,i,o){var a=s<0?1:0;if(a&&(s=-s),s===0)n(1/s>0?0:2147483648,i,o);else if(isNaN(s))n(2143289344,i,o);else if(s>34028234663852886e22)n((a<<31|2139095040)>>>0,i,o);else if(s<11754943508222875e-54)n((a<<31|Math.round(s/1401298464324817e-60))>>>0,i,o);else{var f=Math.floor(Math.log(s)/Math.LN2),u=Math.round(s*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|u)>>>0,i,o)}}e.writeFloatLE=t.bind(null,Ec),e.writeFloatBE=t.bind(null,Ic);function r(n,s,i){var o=n(s,i),a=(o>>31)*2+1,f=o>>>23&255,u=o&8388607;return f===255?u?NaN:a*(1/0):f===0?a*1401298464324817e-60*u:a*Math.pow(2,f-150)*(u+8388608)}e.readFloatLE=r.bind(null,_c),e.readFloatBE=r.bind(null,Cc)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function s(f,u,c){t[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3],u[c+4]=r[4],u[c+5]=r[5],u[c+6]=r[6],u[c+7]=r[7]}function i(f,u,c){t[0]=f,u[c]=r[7],u[c+1]=r[6],u[c+2]=r[5],u[c+3]=r[4],u[c+4]=r[3],u[c+5]=r[2],u[c+6]=r[1],u[c+7]=r[0]}e.writeDoubleLE=n?s:i,e.writeDoubleBE=n?i:s;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],t[0]}function a(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],t[0]}e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(n,s,i,o,a,f){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,f+s),n(1/o>0?0:2147483648,a,f+i);else if(isNaN(o))n(0,a,f+s),n(2146959360,a,f+i);else if(o>17976931348623157e292)n(0,a,f+s),n((u<<31|2146435072)>>>0,a,f+i);else{var c;if(o<22250738585072014e-324)c=o/5e-324,n(c>>>0,a,f+s),n((u<<31|c/4294967296)>>>0,a,f+i);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),c=o*Math.pow(2,-h),n(c*4503599627370496>>>0,a,f+s),n((u<<31|h+1023<<20|c*1048576&1048575)>>>0,a,f+i)}}}e.writeDoubleLE=t.bind(null,Ec,0,4),e.writeDoubleBE=t.bind(null,Ic,4,0);function r(n,s,i,o,a){var f=n(o,a+s),u=n(o,a+i),c=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,_c,0,4),e.readDoubleBE=r.bind(null,Cc,4,0)}(),e}function Ec(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Ic(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function _c(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Cc(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Ac=G((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Rc=G(Pc=>{"use strict";var Gi=Pc;Gi.length=function(t){for(var r=0,n=0,s=0;s<t.length;++s)n=t.charCodeAt(s),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(s+1)&64512)===56320?(++s,r+=4):r+=3;return r};Gi.read=function(t,r,n){var s=n-r;if(s<1)return"";for(var i=null,o=[],a=0,f;r<n;)f=t[r++],f<128?o[a++]=f:f>191&&f<224?o[a++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,o[a++]=55296+(f>>10),o[a++]=56320+(f&1023)):o[a++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Gi.write=function(t,r,n){for(var s=n,i,o,a=0;a<t.length;++a)i=t.charCodeAt(a),i<128?r[n++]=i:i<2048?(r[n++]=i>>6|192,r[n++]=i&63|128):(i&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++a,r[n++]=i>>18|240,r[n++]=i>>12&63|128,r[n++]=i>>6&63|128,r[n++]=i&63|128):(r[n++]=i>>12|224,r[n++]=i>>6&63|128,r[n++]=i&63|128);return n-s}});var kc=G((S2,Dc)=>{"use strict";Dc.exports=up;function up(e,t,r){var n=r||8192,s=n>>>1,i=null,o=n;return function(f){if(f<1||f>s)return e(f);o+f>n&&(i=e(n),o=0);var u=t.call(i,o,o+=f);return o&7&&(o=(o|7)+1),u}}});var Nc=G((E2,Mc)=>{"use strict";Mc.exports=ke;var An=Ot();function ke(e,t){this.lo=e>>>0,this.hi=t>>>0}var vr=ke.zero=new ke(0,0);vr.toNumber=function(){return 0};vr.zzEncode=vr.zzDecode=function(){return this};vr.length=function(){return 1};var fp=ke.zeroHash="\0\0\0\0\0\0\0\0";ke.fromNumber=function(t){if(t===0)return vr;var r=t<0;r&&(t=-t);var n=t>>>0,s=(t-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new ke(n,s)};ke.from=function(t){if(typeof t=="number")return ke.fromNumber(t);if(An.isString(t))if(An.Long)t=An.Long.fromString(t);else return ke.fromNumber(parseInt(t,10));return t.low||t.high?new ke(t.low>>>0,t.high>>>0):vr};ke.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};ke.prototype.toLong=function(t){return An.Long?new An.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var tr=String.prototype.charCodeAt;ke.fromHash=function(t){return t===fp?vr:new ke((tr.call(t,0)|tr.call(t,1)<<8|tr.call(t,2)<<16|tr.call(t,3)<<24)>>>0,(tr.call(t,4)|tr.call(t,5)<<8|tr.call(t,6)<<16|tr.call(t,7)<<24)>>>0)};ke.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ke.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};ke.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};ke.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Ot=G(Wi=>{"use strict";var z=Wi;z.asPromise=gc();z.base64=vc();z.EventEmitter=wc();z.float=Tc();z.inquire=Ac();z.utf8=Rc();z.pool=kc();z.LongBits=Nc();z.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);z.global=z.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Wi;z.emptyArray=Object.freeze?Object.freeze([]):[];z.emptyObject=Object.freeze?Object.freeze({}):{};z.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};z.isString=function(t){return typeof t=="string"||t instanceof String};z.isObject=function(t){return t&&typeof t=="object"};z.isset=z.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};z.Buffer=function(){try{var e=z.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();z._Buffer_from=null;z._Buffer_allocUnsafe=null;z.newBuffer=function(t){return typeof t=="number"?z.Buffer?z._Buffer_allocUnsafe(t):new z.Array(t):z.Buffer?z._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};z.Array=typeof Uint8Array<"u"?Uint8Array:Array;z.Long=z.global.dcodeIO&&z.global.dcodeIO.Long||z.global.Long||z.inquire("long");z.key2Re=/^true|false|0|1$/;z.key32Re=/^-?(?:0|[1-9][0-9]*)$/;z.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;z.longToHash=function(t){return t?z.LongBits.from(t).toHash():z.LongBits.zeroHash};z.longFromHash=function(t,r){var n=z.LongBits.fromHash(t);return z.Long?z.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Lc(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)(e[n[s]]===void 0||!r)&&(e[n[s]]=t[n[s]]);return e}z.merge=Lc;z.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Oc(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Lc(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}z.newError=Oc;z.ProtocolError=Oc("ProtocolError");z.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var s=Object.keys(this),i=s.length-1;i>-1;--i)if(r[s[i]]===1&&this[s[i]]!==void 0&&this[s[i]]!==null)return s[i]}};z.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};z.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};z._configure=function(){var e=z.Buffer;if(!e){z._Buffer_from=z._Buffer_allocUnsafe=null;return}z._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},z._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var ls=G((_2,qc)=>{"use strict";qc.exports=re;var at=Ot(),ji,hs=at.LongBits,Fc=at.base64,Uc=at.utf8;function Pn(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Yi(){}function hp(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function re(){this.len=0,this.head=new Pn(Yi,0,0),this.tail=this.head,this.states=null}var Kc=function(){return at.Buffer?function(){return(re.create=function(){return new ji})()}:function(){return new re}};re.create=Kc();re.alloc=function(t){return new at.Array(t)};at.Array!==Array&&(re.alloc=at.pool(re.alloc,at.Array.prototype.subarray));re.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Pn(t,r,n),this.len+=r,this};function Zi(e,t,r){t[r]=e&255}function lp(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Qi(e,t){this.len=e,this.next=void 0,this.val=t}Qi.prototype=Object.create(Pn.prototype);Qi.prototype.fn=lp;re.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Qi((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};re.prototype.int32=function(t){return t<0?this._push(Xi,10,hs.fromNumber(t)):this.uint32(t)};re.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Xi(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}re.prototype.uint64=function(t){var r=hs.from(t);return this._push(Xi,r.length(),r)};re.prototype.int64=re.prototype.uint64;re.prototype.sint64=function(t){var r=hs.from(t).zzEncode();return this._push(Xi,r.length(),r)};re.prototype.bool=function(t){return this._push(Zi,1,t?1:0)};function $i(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}re.prototype.fixed32=function(t){return this._push($i,4,t>>>0)};re.prototype.sfixed32=re.prototype.fixed32;re.prototype.fixed64=function(t){var r=hs.from(t);return this._push($i,4,r.lo)._push($i,4,r.hi)};re.prototype.sfixed64=re.prototype.fixed64;re.prototype.float=function(t){return this._push(at.float.writeFloatLE,4,t)};re.prototype.double=function(t){return this._push(at.float.writeDoubleLE,8,t)};var pp=at.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var s=0;s<t.length;++s)r[n+s]=t[s]};re.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Zi,1,0);if(at.isString(t)){var n=re.alloc(r=Fc.length(t));Fc.decode(t,n,0),t=n}return this.uint32(r)._push(pp,r,t)};re.prototype.string=function(t){var r=Uc.length(t);return r?this.uint32(r)._push(Uc.write,r,t):this._push(Zi,1,0)};re.prototype.fork=function(){return this.states=new hp(this),this.head=this.tail=new Pn(Yi,0,0),this.len=0,this};re.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Pn(Yi,0,0),this.len=0),this};re.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};re.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};re._configure=function(e){ji=e,re.create=Kc(),ji._configure()}});var Ji=G((C2,zc)=>{"use strict";zc.exports=wt;var Vc=ls();(wt.prototype=Object.create(Vc.prototype)).constructor=wt;var rr=Ot();function wt(){Vc.call(this)}wt._configure=function(){wt.alloc=rr._Buffer_allocUnsafe,wt.writeBytesBuffer=rr.Buffer&&rr.Buffer.prototype instanceof Uint8Array&&rr.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var s=0;s<t.length;)r[n++]=t[s++]}};wt.prototype.bytes=function(t){rr.isString(t)&&(t=rr._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(wt.writeBytesBuffer,r,t),this};function dp(e,t,r){e.length<40?rr.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}wt.prototype.string=function(t){var r=rr.Buffer.byteLength(t);return this.uint32(r),r&&this._push(dp,r,t),this};wt._configure()});var ds=G((B2,$c)=>{"use strict";$c.exports=Ie;var pt=Ot(),to,Wc=pt.LongBits,gp=pt.utf8;function dt(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Ie(e){this.buf=e,this.pos=0,this.len=e.length}var Hc=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Ie(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Ie(t);throw Error("illegal buffer")},jc=function(){return pt.Buffer?function(r){return(Ie.create=function(s){return pt.Buffer.isBuffer(s)?new to(s):Hc(s)})(r)}:Hc};Ie.create=jc();Ie.prototype._slice=pt.Array.prototype.subarray||pt.Array.prototype.slice;Ie.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,dt(this,10);return t}}();Ie.prototype.int32=function(){return this.uint32()|0};Ie.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function eo(){var e=new Wc(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw dt(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw dt(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Ie.prototype.bool=function(){return this.uint32()!==0};function ps(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Ie.prototype.fixed32=function(){if(this.pos+4>this.len)throw dt(this,4);return ps(this.buf,this.pos+=4)};Ie.prototype.sfixed32=function(){if(this.pos+4>this.len)throw dt(this,4);return ps(this.buf,this.pos+=4)|0};function Gc(){if(this.pos+8>this.len)throw dt(this,8);return new Wc(ps(this.buf,this.pos+=4),ps(this.buf,this.pos+=4))}Ie.prototype.float=function(){if(this.pos+4>this.len)throw dt(this,4);var t=pt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Ie.prototype.double=function(){if(this.pos+8>this.len)throw dt(this,4);var t=pt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Ie.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw dt(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var s=pt.Buffer;return s?s.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};Ie.prototype.string=function(){var t=this.bytes();return gp.read(t,0,t.length)};Ie.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw dt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw dt(this);while(this.buf[this.pos++]&128);return this};Ie.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Ie._configure=function(e){to=e,Ie.create=jc(),to._configure();var t=pt.Long?"toLong":"toNumber";pt.merge(Ie.prototype,{int64:function(){return eo.call(this)[t](!1)},uint64:function(){return eo.call(this)[t](!0)},sint64:function(){return eo.call(this).zzDecode()[t](!1)},fixed64:function(){return Gc.call(this)[t](!0)},sfixed64:function(){return Gc.call(this)[t](!1)}})}});var ro=G((T2,Qc)=>{"use strict";Qc.exports=xr;var Zc=ds();(xr.prototype=Object.create(Zc.prototype)).constructor=xr;var Yc=Ot();function xr(e){Zc.call(this,e)}xr._configure=function(){Yc.Buffer&&(xr.prototype._slice=Yc.Buffer.prototype.slice)};xr.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};xr._configure()});var Jc=G((A2,Xc)=>{"use strict";Xc.exports=Rn;var no=Ot();(Rn.prototype=Object.create(no.EventEmitter.prototype)).constructor=Rn;function Rn(e,t,r){if(typeof e!="function")throw TypeError("rpcImpl must be a function");no.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}Rn.prototype.rpcCall=function e(t,r,n,s,i){if(!s)throw TypeError("request must be specified");var o=this;if(!i)return no.asPromise(e,o,t,r,n,s);if(!o.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return o.rpcImpl(t,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(f,u){if(f)return o.emit("error",f,t),i(f);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(c){return o.emit("error",c,t),i(c)}return o.emit("data",u,t),i(null,u)})}catch(a){o.emit("error",a,t),setTimeout(function(){i(a)},0);return}};Rn.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var tu=G(eu=>{"use strict";var yp=eu;yp.Service=Jc()});var nu=G((R2,ru)=>{"use strict";ru.exports={}});var ou=G(iu=>{"use strict";var Xe=iu;Xe.build="minimal";Xe.Writer=ls();Xe.BufferWriter=Ji();Xe.Reader=ds();Xe.BufferReader=ro();Xe.util=Ot();Xe.rpc=tu();Xe.roots=nu();Xe.configure=su;function su(){Xe.util._configure(),Xe.Writer._configure(Xe.BufferWriter),Xe.Reader._configure(Xe.BufferReader)}su()});var so=G((k2,au)=>{"use strict";au.exports=ou()});var uu=G((cu,Dn)=>{"use strict";(function(e,t){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],t):typeof Na=="function"&&typeof Dn=="object"&&Dn&&Dn.exports&&(Dn.exports=t(so()))})(cu,function(e){"use strict";var t=e.Reader,r=e.Writer,n=e.util,s=e.roots.default||(e.roots.default={});return s.RPC=function(){function i(a){if(this.subscriptions=[],this.messages=[],a)for(var f=Object.keys(a),u=0;u<f.length;++u)a[f[u]]!=null&&(this[f[u]]=a[f[u]])}i.prototype.subscriptions=n.emptyArray,i.prototype.messages=n.emptyArray,i.prototype.control=null;var o;return Object.defineProperty(i.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),i.encode=function(f,u){if(u||(u=r.create()),f.subscriptions!=null&&f.subscriptions.length)for(var c=0;c<f.subscriptions.length;++c)s.RPC.SubOpts.encode(f.subscriptions[c],u.uint32(10).fork()).ldelim();if(f.messages!=null&&f.messages.length)for(var c=0;c<f.messages.length;++c)s.RPC.Message.encode(f.messages[c],u.uint32(18).fork()).ldelim();return f.control!=null&&Object.hasOwnProperty.call(f,"control")&&s.RPC.ControlMessage.encode(f.control,u.uint32(26).fork()).ldelim(),u},i.decode=function(f,u){f instanceof t||(f=t.create(f));for(var c=u===void 0?f.len:f.pos+u,h=new s.RPC;f.pos<c;){var l=f.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(s.RPC.SubOpts.decode(f,f.uint32()));break;case 2:h.messages&&h.messages.length||(h.messages=[]),h.messages.push(s.RPC.Message.decode(f,f.uint32()));break;case 3:h.control=s.RPC.ControlMessage.decode(f,f.uint32());break;default:f.skipType(l&7);break}}return h},i.fromObject=function(f){if(f instanceof s.RPC)return f;var u=new s.RPC;if(f.subscriptions){if(!Array.isArray(f.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var c=0;c<f.subscriptions.length;++c){if(typeof f.subscriptions[c]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[c]=s.RPC.SubOpts.fromObject(f.subscriptions[c])}}if(f.messages){if(!Array.isArray(f.messages))throw TypeError(".RPC.messages: array expected");u.messages=[];for(var c=0;c<f.messages.length;++c){if(typeof f.messages[c]!="object")throw TypeError(".RPC.messages: object expected");u.messages[c]=s.RPC.Message.fromObject(f.messages[c])}}if(f.control!=null){if(typeof f.control!="object")throw TypeError(".RPC.control: object expected");u.control=s.RPC.ControlMessage.fromObject(f.control)}return u},i.toObject=function(f,u){u||(u={});var c={};if((u.arrays||u.defaults)&&(c.subscriptions=[],c.messages=[]),f.subscriptions&&f.subscriptions.length){c.subscriptions=[];for(var h=0;h<f.subscriptions.length;++h)c.subscriptions[h]=s.RPC.SubOpts.toObject(f.subscriptions[h],u)}if(f.messages&&f.messages.length){c.messages=[];for(var h=0;h<f.messages.length;++h)c.messages[h]=s.RPC.Message.toObject(f.messages[h],u)}return f.control!=null&&f.hasOwnProperty("control")&&(c.control=s.RPC.ControlMessage.toObject(f.control,u),u.oneofs&&(c._control="control")),c},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.SubOpts=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.subscribe=null,a.prototype.topic=null;var f;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(f=["subscribe"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(f=["topic"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.subscribe!=null&&Object.hasOwnProperty.call(c,"subscribe")&&h.uint32(8).bool(c.subscribe),c.topic!=null&&Object.hasOwnProperty.call(c,"topic")&&h.uint32(18).string(c.topic),h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.SubOpts;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.subscribe=c.bool();break;case 2:g.topic=c.string();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.SubOpts)return c;var h=new s.RPC.SubOpts;return c.subscribe!=null&&(h.subscribe=!!c.subscribe),c.topic!=null&&(h.topic=String(c.topic)),h},a.toObject=function(c,h){h||(h={});var l={};return c.subscribe!=null&&c.hasOwnProperty("subscribe")&&(l.subscribe=c.subscribe,h.oneofs&&(l._subscribe="subscribe")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic,h.oneofs&&(l._topic="topic")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.Message=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null;var f;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(f=["from"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(f=["data"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(f=["seqno"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(f=["signature"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(f=["key"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.from!=null&&Object.hasOwnProperty.call(c,"from")&&h.uint32(10).bytes(c.from),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&h.uint32(18).bytes(c.data),c.seqno!=null&&Object.hasOwnProperty.call(c,"seqno")&&h.uint32(26).bytes(c.seqno),h.uint32(34).string(c.topic),c.signature!=null&&Object.hasOwnProperty.call(c,"signature")&&h.uint32(42).bytes(c.signature),c.key!=null&&Object.hasOwnProperty.call(c,"key")&&h.uint32(50).bytes(c.key),h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.Message;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.from=c.bytes();break;case 2:g.data=c.bytes();break;case 3:g.seqno=c.bytes();break;case 4:g.topic=c.string();break;case 5:g.signature=c.bytes();break;case 6:g.key=c.bytes();break;default:c.skipType(p&7);break}}if(!g.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:g});return g},a.fromObject=function(c){if(c instanceof s.RPC.Message)return c;var h=new s.RPC.Message;return c.from!=null&&(typeof c.from=="string"?n.base64.decode(c.from,h.from=n.newBuffer(n.base64.length(c.from)),0):c.from.length&&(h.from=c.from)),c.data!=null&&(typeof c.data=="string"?n.base64.decode(c.data,h.data=n.newBuffer(n.base64.length(c.data)),0):c.data.length&&(h.data=c.data)),c.seqno!=null&&(typeof c.seqno=="string"?n.base64.decode(c.seqno,h.seqno=n.newBuffer(n.base64.length(c.seqno)),0):c.seqno.length&&(h.seqno=c.seqno)),c.topic!=null&&(h.topic=String(c.topic)),c.signature!=null&&(typeof c.signature=="string"?n.base64.decode(c.signature,h.signature=n.newBuffer(n.base64.length(c.signature)),0):c.signature.length&&(h.signature=c.signature)),c.key!=null&&(typeof c.key=="string"?n.base64.decode(c.key,h.key=n.newBuffer(n.base64.length(c.key)),0):c.key.length&&(h.key=c.key)),h},a.toObject=function(c,h){h||(h={});var l={};return h.defaults&&(l.topic=""),c.from!=null&&c.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(c.from,0,c.from.length):h.bytes===Array?Array.prototype.slice.call(c.from):c.from,h.oneofs&&(l._from="from")),c.data!=null&&c.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(c.data,0,c.data.length):h.bytes===Array?Array.prototype.slice.call(c.data):c.data,h.oneofs&&(l._data="data")),c.seqno!=null&&c.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(c.seqno,0,c.seqno.length):h.bytes===Array?Array.prototype.slice.call(c.seqno):c.seqno,h.oneofs&&(l._seqno="seqno")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic),c.signature!=null&&c.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(c.signature,0,c.signature.length):h.bytes===Array?Array.prototype.slice.call(c.signature):c.signature,h.oneofs&&(l._signature="signature")),c.key!=null&&c.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(c.key,0,c.key.length):h.bytes===Array?Array.prototype.slice.call(c.key):c.key,h.oneofs&&(l._key="key")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.ControlMessage=function(){function a(f){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)s.RPC.ControlIHave.encode(u.ihave[h],c.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)s.RPC.ControlIWant.encode(u.iwant[h],c.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)s.RPC.ControlGraft.encode(u.graft[h],c.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)s.RPC.ControlPrune.encode(u.prune[h],c.uint32(34).fork()).ldelim();return c},a.decode=function(u,c){u instanceof t||(u=t.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new s.RPC.ControlMessage;u.pos<h;){var g=u.uint32();switch(g>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(s.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(s.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(s.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(s.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(g&7);break}}return l},a.fromObject=function(u){if(u instanceof s.RPC.ControlMessage)return u;var c=new s.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");c.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");c.ihave[h]=s.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");c.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");c.iwant[h]=s.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");c.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");c.graft[h]=s.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");c.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");c.prune[h]=s.RPC.ControlPrune.fromObject(u.prune[h])}}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var l=0;l<u.ihave.length;++l)h.ihave[l]=s.RPC.ControlIHave.toObject(u.ihave[l],c)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var l=0;l<u.iwant.length;++l)h.iwant[l]=s.RPC.ControlIWant.toObject(u.iwant[l],c)}if(u.graft&&u.graft.length){h.graft=[];for(var l=0;l<u.graft.length;++l)h.graft[l]=s.RPC.ControlGraft.toObject(u.graft[l],c)}if(u.prune&&u.prune.length){h.prune=[];for(var l=0;l<u.prune.length;++l)h.prune[l]=s.RPC.ControlPrune.toObject(u.prune[l],c)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.messageIDs!=null&&c.messageIDs.length)for(var l=0;l<c.messageIDs.length;++l)h.uint32(18).bytes(c.messageIDs[l]);return h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlIHave;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;case 2:g.messageIDs&&g.messageIDs.length||(g.messageIDs=[]),g.messageIDs.push(c.bytes());break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlIHave)return c;var h=new s.RPC.ControlIHave;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.messageIDs){if(!Array.isArray(c.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<c.messageIDs.length;++l)typeof c.messageIDs[l]=="string"?n.base64.decode(c.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(c.messageIDs[l])),0):c.messageIDs[l].length&&(h.messageIDs[l]=c.messageIDs[l])}return h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.messageIDs&&c.messageIDs.length){l.messageIDs=[];for(var g=0;g<c.messageIDs.length;++g)l.messageIDs[g]=h.bytes===String?n.base64.encode(c.messageIDs[g],0,c.messageIDs[g].length):h.bytes===Array?Array.prototype.slice.call(c.messageIDs[g]):c.messageIDs[g]}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.ControlIWant=function(){function a(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)c.uint32(10).bytes(u.messageIDs[h]);return c},a.decode=function(u,c){u instanceof t||(u=t.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new s.RPC.ControlIWant;u.pos<h;){var g=u.uint32();switch(g>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(u.bytes());break;default:u.skipType(g&7);break}}return l},a.fromObject=function(u){if(u instanceof s.RPC.ControlIWant)return u;var c=new s.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");c.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?n.base64.decode(u.messageIDs[h],c.messageIDs[h]=n.newBuffer(n.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(c.messageIDs[h]=u.messageIDs[h])}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)h.messageIDs[l]=c.bytes===String?n.base64.encode(u.messageIDs[l],0,u.messageIDs[l].length):c.bytes===Array?Array.prototype.slice.call(u.messageIDs[l]):u.messageIDs[l]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.ControlGraft=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlGraft;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlGraft)return c;var h=new s.RPC.ControlGraft;return c.topicID!=null&&(h.topicID=String(c.topicID)),h},a.toObject=function(c,h){h||(h={});var l={};return c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(f=["backoff"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.peers!=null&&c.peers.length)for(var l=0;l<c.peers.length;++l)s.RPC.PeerInfo.encode(c.peers[l],h.uint32(18).fork()).ldelim();return c.backoff!=null&&Object.hasOwnProperty.call(c,"backoff")&&h.uint32(24).uint64(c.backoff),h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.ControlPrune;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.topicID=c.string();break;case 2:g.peers&&g.peers.length||(g.peers=[]),g.peers.push(s.RPC.PeerInfo.decode(c,c.uint32()));break;case 3:g.backoff=c.uint64();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.ControlPrune)return c;var h=new s.RPC.ControlPrune;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.peers){if(!Array.isArray(c.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<c.peers.length;++l){if(typeof c.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=s.RPC.PeerInfo.fromObject(c.peers[l])}}return c.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(c.backoff)).unsigned=!0:typeof c.backoff=="string"?h.backoff=parseInt(c.backoff,10):typeof c.backoff=="number"?h.backoff=c.backoff:typeof c.backoff=="object"&&(h.backoff=new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.peers&&c.peers.length){l.peers=[];for(var g=0;g<c.peers.length;++g)l.peers[g]=s.RPC.PeerInfo.toObject(c.peers[g],h)}return c.backoff!=null&&c.hasOwnProperty("backoff")&&(typeof c.backoff=="number"?l.backoff=h.longs===String?String(c.backoff):c.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(c.backoff):h.longs===Number?new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0):c.backoff,h.oneofs&&(l._backoff="backoff")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i.PeerInfo=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var f;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(f=["peerID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(f=["signedPeerRecord"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.peerID!=null&&Object.hasOwnProperty.call(c,"peerID")&&h.uint32(10).bytes(c.peerID),c.signedPeerRecord!=null&&Object.hasOwnProperty.call(c,"signedPeerRecord")&&h.uint32(18).bytes(c.signedPeerRecord),h},a.decode=function(c,h){c instanceof t||(c=t.create(c));for(var l=h===void 0?c.len:c.pos+h,g=new s.RPC.PeerInfo;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:g.peerID=c.bytes();break;case 2:g.signedPeerRecord=c.bytes();break;default:c.skipType(p&7);break}}return g},a.fromObject=function(c){if(c instanceof s.RPC.PeerInfo)return c;var h=new s.RPC.PeerInfo;return c.peerID!=null&&(typeof c.peerID=="string"?n.base64.decode(c.peerID,h.peerID=n.newBuffer(n.base64.length(c.peerID)),0):c.peerID.length&&(h.peerID=c.peerID)),c.signedPeerRecord!=null&&(typeof c.signedPeerRecord=="string"?n.base64.decode(c.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(c.signedPeerRecord)),0):c.signedPeerRecord.length&&(h.signedPeerRecord=c.signedPeerRecord)),h},a.toObject=function(c,h){h||(h={});var l={};return c.peerID!=null&&c.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(c.peerID,0,c.peerID.length):h.bytes===Array?Array.prototype.slice.call(c.peerID):c.peerID,h.oneofs&&(l._peerID="peerID")),c.signedPeerRecord!=null&&c.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(c.signedPeerRecord,0,c.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(c.signedPeerRecord):c.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),i}(),s})});var ae=G((j2,yu)=>{yu.exports={options:{usePureJavaScript:!1}}});var vu=G(($2,bu)=>{var co={};bu.exports=co;var mu={};co.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=vp(e,t);else{var s=0,i=t.length,o=t.charAt(0),a=[0];for(s=0;s<e.length;++s){for(var f=0,u=e[s];f<a.length;++f)u+=a[f]<<8,a[f]=u%i,u=u/i|0;for(;u>0;)a.push(u%i),u=u/i|0}for(s=0;e[s]===0&&s<e.length-1;++s)n+=o;for(s=a.length-1;s>=0;--s)n+=t[a[s]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};co.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=mu[t];if(!r){r=mu[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var s=t.length,i=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var f=0,u=a;f<o.length;++f)u+=o[f]*s,o[f]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var c=0;e[c]===i&&c<e.length-1;++c)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function vp(e,t){var r=0,n=t.length,s=t.charAt(0),i=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<i.length;++o)a+=i[o]<<8,i[o]=a%n,a=a/n|0;for(;a>0;)i.push(a%n),a=a/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=s;for(r=i.length-1;r>=0;--r)f+=t[i[r]];return f}});var _e=G((Y2,Eu)=>{var xu=ae(),wu=vu(),v=Eu.exports=xu.util=xu.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){v.nextTick=process.nextTick,typeof setImmediate=="function"?v.setImmediate=setImmediate:v.setImmediate=v.nextTick;return}if(typeof setImmediate=="function"){v.setImmediate=function(){return setImmediate.apply(void 0,arguments)},v.nextTick=function(a){return setImmediate(a)};return}if(v.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(c){c()})}};var o=a,e="forge.setImmediate",t=[];v.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,s=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(u){u()})}).observe(s,{attributes:!0});var i=v.setImmediate;v.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),i(f)):(t.push(f),t.length===1&&s.setAttribute("a",n=!n))}}v.nextTick=v.setImmediate})();v.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;v.globalScope=function(){return v.isNodejs?globalThis:typeof self>"u"?window:self}();v.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};v.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};v.isArrayBufferView=function(e){return e&&v.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Mn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}v.ByteBuffer=uo;function uo(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(v.isArrayBuffer(e)||v.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof uo||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}v.ByteStringBuffer=uo;var xp=4096;v.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>xp&&(this.data.substr(0,1),this._constructedStringLength=0)};v.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};v.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};v.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};v.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};v.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};v.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(v.encodeUtf8(e))};v.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};v.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};v.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};v.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};v.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};v.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};v.ByteStringBuffer.prototype.putInt=function(e,t){Mn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};v.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};v.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};v.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};v.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};v.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};v.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};v.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};v.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};v.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};v.ByteStringBuffer.prototype.getInt=function(e){Mn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};v.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};v.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};v.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};v.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};v.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};v.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};v.ByteStringBuffer.prototype.copy=function(){var e=v.createBuffer(this.data);return e.read=this.read,e};v.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};v.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};v.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};v.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};v.ByteStringBuffer.prototype.toString=function(){return v.decodeUtf8(this.bytes())};function wp(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=v.isArrayBuffer(e),n=v.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}v.DataBuffer=wp;v.DataBuffer.prototype.length=function(){return this.write-this.read};v.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};v.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};v.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};v.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};v.DataBuffer.prototype.putBytes=function(e,t){if(v.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var s=new Uint8Array(this.data.buffer,this.write);return s.set(r),this.write+=n,this}if(v.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var s=new Uint8Array(this.data.buffer);return s.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof v.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&v.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var s=new Uint8Array(e.data.byteLength,this.write);return s.set(r),this.write+=r.byteLength,this}if(e instanceof v.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var i;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.hex.decode(e,i,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.base64.decode(e,i,this.write),this;if(t==="utf8"&&(e=v.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.raw.decode(i),this;if(t==="utf16")return this.accommodate(e.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=v.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};v.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};v.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};v.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};v.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};v.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};v.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};v.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};v.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};v.DataBuffer.prototype.putInt=function(e,t){Mn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};v.DataBuffer.prototype.putSignedInt=function(e,t){return Mn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};v.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};v.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};v.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};v.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};v.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};v.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};v.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};v.DataBuffer.prototype.getInt=function(e){Mn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};v.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};v.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};v.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};v.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};v.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};v.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};v.DataBuffer.prototype.copy=function(){return new v.DataBuffer(this)};v.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};v.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};v.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};v.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};v.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return v.binary.raw.encode(t);if(e==="hex")return v.binary.hex.encode(t);if(e==="base64")return v.binary.base64.encode(t);if(e==="utf8")return v.text.utf8.decode(t);if(e==="utf16")return v.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};v.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=v.encodeUtf8(e)),new v.ByteBuffer(e)};v.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};v.xorBytes=function(e,t,r){for(var n="",s="",i="",o=0,a=0;r>0;--r,++o)s=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=i,i="",a=0),i+=String.fromCharCode(s),++a;return n+=i,n};v.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};v.bytesToHex=function(e){return v.createBuffer(e).toHex()};v.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var nr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Su="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";v.encode64=function(e,t){for(var r="",n="",s,i,o,a=0;a<e.length;)s=e.charCodeAt(a++),i=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=nr.charAt(s>>2),r+=nr.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=nr.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":nr.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};v.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,s,i,o=0;o<e.length;)r=sr[e.charCodeAt(o++)-43],n=sr[e.charCodeAt(o++)-43],s=sr[e.charCodeAt(o++)-43],i=sr[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),s!==64&&(t+=String.fromCharCode((n&15)<<4|s>>2),i!==64&&(t+=String.fromCharCode((s&3)<<6|i)));return t};v.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};v.decodeUtf8=function(e){return decodeURIComponent(escape(e))};v.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:wu.encode,decode:wu.decode}};v.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};v.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var s=r,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n};v.binary.hex.encode=v.bytesToHex;v.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var s=0,i=r;for(e.length&1&&(s=1,n[i++]=parseInt(e[0],16));s<e.length;s+=2)n[i++]=parseInt(e.substr(s,2),16);return t?i-r:n};v.binary.base64.encode=function(e,t){for(var r="",n="",s,i,o,a=0;a<e.byteLength;)s=e[a++],i=e[a++],o=e[a++],r+=nr.charAt(s>>2),r+=nr.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=nr.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":nr.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};v.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var s,i,o,a,f=0,u=r;f<e.length;)s=sr[e.charCodeAt(f++)-43],i=sr[e.charCodeAt(f++)-43],o=sr[e.charCodeAt(f++)-43],a=sr[e.charCodeAt(f++)-43],n[u++]=s<<2|i>>4,o!==64&&(n[u++]=(i&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return t?u-r:n.subarray(0,u)};v.binary.base58.encode=function(e,t){return v.binary.baseN.encode(e,Su,t)};v.binary.base58.decode=function(e,t){return v.binary.baseN.decode(e,Su,t)};v.text={utf8:{},utf16:{}};v.text.utf8.encode=function(e,t,r){e=v.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var s=r,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n};v.text.utf8.decode=function(e){return v.decodeUtf8(String.fromCharCode.apply(null,e))};v.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var s=new Uint16Array(n.buffer);r=r||0;for(var i=r,o=r,a=0;a<e.length;++a)s[o++]=e.charCodeAt(a),i+=2;return t?i-r:n};v.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};v.deflate=function(e,t,r){if(t=v.decode64(e.deflate(v.encode64(t)).rval),r){var n=2,s=t.charCodeAt(1);s&32&&(n=6),t=t.substring(n,t.length-4)}return t};v.inflate=function(e,t,r){var n=e.inflate(v.encode64(t)).rval;return n===null?null:v.decode64(n)};var fo=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=v.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},ho=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(v.decode64(r))),r},Sp=function(e,t,r,n){var s=ho(e,t);s===null&&(s={}),s[r]=n,fo(e,t,s)},Ep=function(e,t,r){var n=ho(e,t);return n!==null&&(n=r in n?n[r]:null),n},Ip=function(e,t,r){var n=ho(e,t);if(n!==null&&r in n){delete n[r];var s=!0;for(var i in n){s=!1;break}s&&(n=null),fo(e,t,n)}},_p=function(e,t){fo(e,t,null)},ms=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var s,i=!1,o=null;for(var a in r){s=r[a];try{if(s==="flash"||s==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),i=s==="flash"}(s==="web"||s==="both")&&(t[0]=localStorage,n=e.apply(this,t),i=!0)}catch(f){o=f}if(i)break}if(!i)throw o;return n};v.setItem=function(e,t,r,n,s){ms(Sp,arguments,s)};v.getItem=function(e,t,r,n){return ms(Ep,arguments,n)};v.removeItem=function(e,t,r,n){ms(Ip,arguments,n)};v.clearItems=function(e,t,r){ms(_p,arguments,r)};v.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};v.format=function(e){for(var t=/%./g,r,n,s=0,i=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&i.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[s+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(e.substring(o)),i.join("")};v.formatNumber=function(e,t,r,n){var s=e,i=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,f=s<0?"-":"",u=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",c=u.length>3?u.length%3:0;return f+(c?u.substr(0,c)+a:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-u).toFixed(i).slice(2):"")};v.formatSize=function(e){return e>=1073741824?e=v.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=v.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=v.formatNumber(e/1024,0)+" KiB":e=v.formatNumber(e,0)+" bytes",e};v.bytesFromIP=function(e){return e.indexOf(".")!==-1?v.bytesFromIPv4(e):e.indexOf(":")!==-1?v.bytesFromIPv6(e):null};v.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=v.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};v.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=v.createBuffer(),s=0;s<8;++s){if(!e[s]||e[s].length===0){n.fillWithByte(0,r),r=0;continue}var i=v.hexToBytes(e[s]);i.length<2&&n.putByte(0),n.putBytes(i)}return n.getBytes()};v.bytesToIP=function(e){return e.length===4?v.bytesToIPv4(e):e.length===16?v.bytesToIPv6(e):null};v.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};v.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,s=0;s<e.length;s+=2){for(var i=v.bytesToHex(e[s]+e[s+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(i)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};v.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in v&&!e.update)return t(null,v.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return v.cores=navigator.hardwareConcurrency,t(null,v.cores);if(typeof Worker>"u")return v.cores=1,t(null,v.cores);if(typeof Blob>"u")return v.cores=2,t(null,v.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,f){if(a===0){var u=Math.floor(o.reduce(function(c,h){return c+h},0)/o.length);return v.cores=Math.max(1,u),URL.revokeObjectURL(r),t(null,v.cores)}s(f,function(c,h){o.push(i(f,h)),n(o,a-1,f)})}function s(o,a){for(var f=[],u=[],c=0;c<o;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var g=0;g<o;++g)f[g].terminate();a(null,u)}}),f.push(h)}for(var c=0;c<o;++c)f[c].postMessage(c)}function i(o,a){for(var f=[],u=0;u<o;++u)for(var c=a[u],h=f[u]=[],l=0;l<o;++l)if(u!==l){var g=a[l];(c.st>g.st&&c.st<g.et||g.st>c.st&&g.st<c.et)&&h.push(l)}return f.reduce(function(p,d){return Math.max(p,d.length)},0)}}});var bs=G((Z2,Iu)=>{var Nn=ae();Nn.pki=Nn.pki||{};var lo=Iu.exports=Nn.pki.oids=Nn.oids=Nn.oids||{};function R(e,t){lo[e]=t,lo[t]=e}function ie(e,t){lo[e]=t}R("1.2.840.113549.1.1.1","rsaEncryption");R("1.2.840.113549.1.1.4","md5WithRSAEncryption");R("1.2.840.113549.1.1.5","sha1WithRSAEncryption");R("1.2.840.113549.1.1.7","RSAES-OAEP");R("1.2.840.113549.1.1.8","mgf1");R("1.2.840.113549.1.1.9","pSpecified");R("1.2.840.113549.1.1.10","RSASSA-PSS");R("1.2.840.113549.1.1.11","sha256WithRSAEncryption");R("1.2.840.113549.1.1.12","sha384WithRSAEncryption");R("1.2.840.113549.1.1.13","sha512WithRSAEncryption");R("1.3.101.112","EdDSA25519");R("1.2.840.10040.4.3","dsa-with-sha1");R("1.3.14.3.2.7","desCBC");R("1.3.14.3.2.26","sha1");R("1.3.14.3.2.29","sha1WithRSASignature");R("2.16.840.1.101.3.4.2.1","sha256");R("2.16.840.1.101.3.4.2.2","sha384");R("2.16.840.1.101.3.4.2.3","sha512");R("2.16.840.1.101.3.4.2.4","sha224");R("2.16.840.1.101.3.4.2.5","sha512-224");R("2.16.840.1.101.3.4.2.6","sha512-256");R("1.2.840.113549.2.2","md2");R("1.2.840.113549.2.5","md5");R("1.2.840.113549.1.7.1","data");R("1.2.840.113549.1.7.2","signedData");R("1.2.840.113549.1.7.3","envelopedData");R("1.2.840.113549.1.7.4","signedAndEnvelopedData");R("1.2.840.113549.1.7.5","digestedData");R("1.2.840.113549.1.7.6","encryptedData");R("1.2.840.113549.1.9.1","emailAddress");R("1.2.840.113549.1.9.2","unstructuredName");R("1.2.840.113549.1.9.3","contentType");R("1.2.840.113549.1.9.4","messageDigest");R("1.2.840.113549.1.9.5","signingTime");R("1.2.840.113549.1.9.6","counterSignature");R("1.2.840.113549.1.9.7","challengePassword");R("1.2.840.113549.1.9.8","unstructuredAddress");R("1.2.840.113549.1.9.14","extensionRequest");R("1.2.840.113549.1.9.20","friendlyName");R("1.2.840.113549.1.9.21","localKeyId");R("1.2.840.113549.1.9.22.1","x509Certificate");R("1.2.840.113549.1.12.10.1.1","keyBag");R("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");R("1.2.840.113549.1.12.10.1.3","certBag");R("1.2.840.113549.1.12.10.1.4","crlBag");R("1.2.840.113549.1.12.10.1.5","secretBag");R("1.2.840.113549.1.12.10.1.6","safeContentsBag");R("1.2.840.113549.1.5.13","pkcs5PBES2");R("1.2.840.113549.1.5.12","pkcs5PBKDF2");R("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");R("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");R("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");R("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");R("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");R("1.2.840.113549.2.7","hmacWithSHA1");R("1.2.840.113549.2.8","hmacWithSHA224");R("1.2.840.113549.2.9","hmacWithSHA256");R("1.2.840.113549.2.10","hmacWithSHA384");R("1.2.840.113549.2.11","hmacWithSHA512");R("1.2.840.113549.3.7","des-EDE3-CBC");R("2.16.840.1.101.3.4.1.2","aes128-CBC");R("2.16.840.1.101.3.4.1.22","aes192-CBC");R("2.16.840.1.101.3.4.1.42","aes256-CBC");R("2.5.4.3","commonName");R("2.5.4.4","surname");R("2.5.4.5","serialNumber");R("2.5.4.6","countryName");R("2.5.4.7","localityName");R("2.5.4.8","stateOrProvinceName");R("2.5.4.9","streetAddress");R("2.5.4.10","organizationName");R("2.5.4.11","organizationalUnitName");R("2.5.4.12","title");R("2.5.4.13","description");R("2.5.4.15","businessCategory");R("2.5.4.17","postalCode");R("2.5.4.42","givenName");R("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");R("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");R("2.16.840.1.113730.1.1","nsCertType");R("2.16.840.1.113730.1.13","nsComment");ie("2.5.29.1","authorityKeyIdentifier");ie("2.5.29.2","keyAttributes");ie("2.5.29.3","certificatePolicies");ie("2.5.29.4","keyUsageRestriction");ie("2.5.29.5","policyMapping");ie("2.5.29.6","subtreesConstraint");ie("2.5.29.7","subjectAltName");ie("2.5.29.8","issuerAltName");ie("2.5.29.9","subjectDirectoryAttributes");ie("2.5.29.10","basicConstraints");ie("2.5.29.11","nameConstraints");ie("2.5.29.12","policyConstraints");ie("2.5.29.13","basicConstraints");R("2.5.29.14","subjectKeyIdentifier");R("2.5.29.15","keyUsage");ie("2.5.29.16","privateKeyUsagePeriod");R("2.5.29.17","subjectAltName");R("2.5.29.18","issuerAltName");R("2.5.29.19","basicConstraints");ie("2.5.29.20","cRLNumber");ie("2.5.29.21","cRLReason");ie("2.5.29.22","expirationDate");ie("2.5.29.23","instructionCode");ie("2.5.29.24","invalidityDate");ie("2.5.29.25","cRLDistributionPoints");ie("2.5.29.26","issuingDistributionPoint");ie("2.5.29.27","deltaCRLIndicator");ie("2.5.29.28","issuingDistributionPoint");ie("2.5.29.29","certificateIssuer");ie("2.5.29.30","nameConstraints");R("2.5.29.31","cRLDistributionPoints");R("2.5.29.32","certificatePolicies");ie("2.5.29.33","policyMappings");ie("2.5.29.34","policyConstraints");R("2.5.29.35","authorityKeyIdentifier");ie("2.5.29.36","policyConstraints");R("2.5.29.37","extKeyUsage");ie("2.5.29.46","freshestCRL");ie("2.5.29.54","inhibitAnyPolicy");R("1.3.6.1.4.1.11129.2.4.2","timestampList");R("1.3.6.1.5.5.7.1.1","authorityInfoAccess");R("1.3.6.1.5.5.7.3.1","serverAuth");R("1.3.6.1.5.5.7.3.2","clientAuth");R("1.3.6.1.5.5.7.3.3","codeSigning");R("1.3.6.1.5.5.7.3.4","emailProtection");R("1.3.6.1.5.5.7.3.8","timeStamping")});var On=G((Q2,Cu)=>{var de=ae();_e();bs();var N=Cu.exports=de.asn1=de.asn1||{};N.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};N.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};N.create=function(e,t,r,n,s){if(de.util.isArray(n)){for(var i=[],o=0;o<n.length;++o)n[o]!==void 0&&i.push(n[o]);n=i}var a={tagClass:e,type:t,constructed:r,composed:r||de.util.isArray(n),value:n};return s&&"bitStringContents"in s&&(a.bitStringContents=s.bitStringContents,a.original=N.copy(a)),a};N.copy=function(e,t){var r;if(de.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(N.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:N.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};N.equals=function(e,t,r){if(de.util.isArray(e)){if(!de.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!N.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&N.equals(e.value,t.value);return r&&r.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s};N.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Ln(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Cp=function(e,t){var r=e.getByte();if(t--,r!==128){var n,s=r&128;if(!s)n=r;else{var i=r&127;Ln(e,t,i),n=e.getInt(i<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};N.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=de.util.createBuffer(e));var r=e.length(),n=vs(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=e.length(),s}return n};function vs(e,t,r,n){var s;Ln(e,t,2);var i=e.getByte();t--;var o=i&192,a=i&31;s=e.length();var f=Cp(e,t);if(t-=s-e.length(),f!==void 0&&f>t){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=e.length(),u.remaining=t,u.requested=f,u}f=t}var c,h,l=(i&32)===32;if(l)if(c=[],f===void 0)for(;;){if(Ln(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}s=e.length(),c.push(vs(e,t,r+1,n)),t-=s-e.length()}else for(;f>0;)s=e.length(),c.push(vs(e,f,r+1,n)),t-=s-e.length(),f-=s-e.length();if(c===void 0&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&(h=e.bytes(f)),c===void 0&&n.decodeBitStrings&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&f>1){var g=e.read,p=t,d=0;if(a===N.Type.BITSTRING&&(Ln(e,t,1),d=e.getByte(),t--),d===0)try{s=e.length();var y={strict:!0,decodeBitStrings:!0},m=vs(e,t,r+1,y),E=s-e.length();t-=E,a==N.Type.BITSTRING&&E++;var x=m.tagClass;E===f&&(x===N.Class.UNIVERSAL||x===N.Class.CONTEXT_SPECIFIC)&&(c=[m])}catch{}c===void 0&&(e.read=g,t=p)}if(c===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(a===N.Type.BMPSTRING)for(c="";f>0;f-=2)Ln(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(f),t-=f}var C=h===void 0?null:{bitStringContents:h};return N.create(o,a,l,c,C)}N.toDer=function(e){var t=de.util.createBuffer(),r=e.tagClass|e.type,n=de.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=N.equals(e,e.original))),s)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var i=0;i<e.value.length;++i)e.value[i]!==void 0&&n.putBuffer(N.toDer(e.value[i]))}else if(e.type===N.Type.BMPSTRING)for(var i=0;i<e.value.length;++i)n.putInt16(e.value.charCodeAt(i));else e.type===N.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var i=a.length-1;i>=0;--i)t.putByte(a.charCodeAt(i))}return t.putBuffer(n),t};N.oidToDer=function(e){var t=e.split("."),r=de.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,s,i,o,a=2;a<t.length;++a){n=!0,s=[],i=parseInt(t[a],10);do o=i&127,i=i>>>7,n||(o|=128),s.push(o),n=!1;while(i>0);for(var f=s.length-1;f>=0;--f)r.putByte(s[f])}return r};N.derToOid=function(e){var t;typeof e=="string"&&(e=de.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};N.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,s=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var f=e.charAt(10),u=10;f!=="+"&&f!=="-"&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,0),u&&(f=e.charAt(u),f==="+"||f==="-")){var c=parseInt(e.substr(u+1,2),10),h=parseInt(e.substr(u+4,2),10),l=c*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};N.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,s=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),f=0,u=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var g=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);u=g*60+p,u*=6e4,l==="+"&&(u*=-1),c=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,f),t.setTime(+t+u)):(t.setFullYear(r,n,s),t.setHours(i,o,a,f)),t};N.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};N.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};N.integerToDer=function(e){var t=de.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};N.derToInteger=function(e){typeof e=="string"&&(e=de.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};N.validate=function(e,t,r,n){var s=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(s=!0,t.value&&de.util.isArray(t.value))for(var i=0,o=0;s&&o<t.value.length;++o)s=t.value[o].optional||!1,e.value[i]&&(s=N.validate(e.value[i],t.value[o],r,n),s?++i:t.value[o].optional&&(s=!0)),!s&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return s};var _u=/[^\\u0000-\\u00ff]/;N.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var s="",i=0;i<t*r;++i)s+=" ";switch(n+=s+"Tag: ",e.tagClass){case N.Class.UNIVERSAL:n+="Universal:";break;case N.Class.APPLICATION:n+="Application:";break;case N.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case N.Class.PRIVATE:n+="Private:";break}if(e.tagClass===N.Class.UNIVERSAL)switch(n+=e.type,e.type){case N.Type.NONE:n+=" (None)";break;case N.Type.BOOLEAN:n+=" (Boolean)";break;case N.Type.INTEGER:n+=" (Integer)";break;case N.Type.BITSTRING:n+=" (Bit string)";break;case N.Type.OCTETSTRING:n+=" (Octet string)";break;case N.Type.NULL:n+=" (Null)";break;case N.Type.OID:n+=" (Object Identifier)";break;case N.Type.ODESC:n+=" (Object Descriptor)";break;case N.Type.EXTERNAL:n+=" (External or Instance of)";break;case N.Type.REAL:n+=" (Real)";break;case N.Type.ENUMERATED:n+=" (Enumerated)";break;case N.Type.EMBEDDED:n+=" (Embedded PDV)";break;case N.Type.UTF8:n+=" (UTF8)";break;case N.Type.ROID:n+=" (Relative Object Identifier)";break;case N.Type.SEQUENCE:n+=" (Sequence)";break;case N.Type.SET:n+=" (Set)";break;case N.Type.PRINTABLESTRING:n+=" (Printable String)";break;case N.Type.IA5String:n+=" (IA5String (ASCII))";break;case N.Type.UTCTIME:n+=" (UTC time)";break;case N.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case N.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=s+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",i=0;i<e.value.length;++i)e.value[i]!==void 0&&(o+=1,a+=N.prettyPrint(e.value[i],t+1,r),i+1<e.value.length&&(a+=","));n+=s+"Sub values: "+o+a}else{if(n+=s+"Value: ",e.type===N.Type.OID){var f=N.derToOid(e.value);n+=f,de.pki&&de.pki.oids&&f in de.pki.oids&&(n+=" ("+de.pki.oids[f]+") ")}if(e.type===N.Type.INTEGER)try{n+=N.derToInteger(e.value)}catch{n+="0x"+de.util.bytesToHex(e.value)}else if(e.type===N.Type.BITSTRING){if(e.value.length>1?n+="0x"+de.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var u=e.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(e.type===N.Type.OCTETSTRING)_u.test(e.value)||(n+="("+e.value+") "),n+="0x"+de.util.bytesToHex(e.value);else if(e.type===N.Type.UTF8)try{n+=de.util.decodeUtf8(e.value)}catch(c){if(c.message==="URI malformed")n+="0x"+de.util.bytesToHex(e.value)+" (malformed UTF8)";else throw c}else e.type===N.Type.PRINTABLESTRING||e.type===N.Type.IA5String?n+=e.value:_u.test(e.value)?n+="0x"+de.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var go=G((X2,Bu)=>{var Me=ae();_e();Bu.exports=Me.cipher=Me.cipher||{};Me.cipher.algorithms=Me.cipher.algorithms||{};Me.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Me.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Me.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Me.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Me.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Me.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Me.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Me.cipher.algorithms[e]=t};Me.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Me.cipher.algorithms?Me.cipher.algorithms[e]:null};var po=Me.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};po.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Me.util.createBuffer(),this.output=e.output||Me.util.createBuffer(),this.mode.start(t)};po.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};po.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var mo=G((J2,Tu)=>{var Ne=ae();_e();Ne.cipher=Ne.cipher||{};var Q=Tu.exports=Ne.cipher.modes=Ne.cipher.modes||{};Q.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.ecb.prototype.start=function(e){};Q.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};Q.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};Q.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};Q.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};Q.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=xs(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Q.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};Q.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Q.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};Q.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};Q.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=xs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32()^this._outBlock[s],t.putInt32(this._inBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)e.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32(),t.putInt32(this._inBlock[s]^this._outBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=xs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb.prototype.decrypt=Q.ofb.prototype.encrypt;Q.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0};Q.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=xs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}ws(this._inBlock)};Q.ctr.prototype.decrypt=Q.ctr.prototype.encrypt;Q.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ne.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Q.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Ne.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Ne.util.createBuffer(e.additionalData):r=Ne.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Ne.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(yo(n*8)))}this._inBlock=this._j0.slice(0),ws(this._inBlock),this._partialBytes=0,r=Ne.util.createBuffer(r),this._aDataLength=yo(r.length()*8);var s=r.length()%this.blockSize;for(s&&r.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Q.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),ws(this._inBlock)};Q.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),ws(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^this._hashBlock[s]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Q.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Ne.util.createBuffer();var n=this._aDataLength.concat(yo(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var s=[];this.cipher.encrypt(this._j0,s);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^s[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Q.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),s=0;s<128;++s){var i=e[s/32|0]&1<<31-s%32;i&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Q.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};Q.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,s=e[n]>>>(7-r%8)*4&15,i=this._m[r][s];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t};Q.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};Q.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,s=16*r,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],f=o/n|0,u=(n-1-o%n)*t;a[f]=1<<t-1<<u,i[o]=this.generateSubHashTable(this.multiply(a,e),t)}return i};Q.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,s=new Array(r);s[n]=e.slice(0);for(var i=n>>>1;i>0;)this.pow(s[2*i],s[i]=[]),i>>=1;for(i=2;i<n;){for(var o=1;o<i;++o){var a=s[i],f=s[o];s[i+o]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}i*=2}for(s[0]=[0,0,0,0],i=n+1;i<r;++i){var u=s[i^n];s[i]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return s};function xs(e,t){if(typeof e=="string"&&(e=Ne.util.createBuffer(e)),Ne.util.isArray(e)&&e.length>4){var r=e;e=Ne.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Ne.util.isArray(e)){for(var s=[],i=t/4,n=0;n<i;++n)s.push(e.getInt32());e=s}return e}function ws(e){e[e.length-1]=e[e.length-1]+1&4294967295}function yo(e){return[e/4294967296|0,e&4294967295]}});var Es=G((ev,Du)=>{var pe=ae();go();mo();_e();Du.exports=pe.aes=pe.aes||{};pe.aes.startEncrypting=function(e,t,r,n){var s=Ss({key:e,output:r,decrypt:!1,mode:n});return s.start(t),s};pe.aes.createEncryptionCipher=function(e,t){return Ss({key:e,output:null,decrypt:!1,mode:t})};pe.aes.startDecrypting=function(e,t,r,n){var s=Ss({key:e,output:r,decrypt:!0,mode:n});return s.start(t),s};pe.aes.createDecryptionCipher=function(e,t){return Ss({key:e,output:null,decrypt:!0,mode:t})};pe.aes.Algorithm=function(e,t){xo||Pu();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,s){return vo(r._w,n,s,!1)},decrypt:function(n,s){return vo(r._w,n,s,!0)}}}),r._init=!1};pe.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=pe.util.createBuffer(t);else if(pe.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=pe.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!pe.util.isArray(t)){r=t,t=[];var s=r.length();if(s===16||s===24||s===32){s=s>>>2;for(var n=0;n<s;++n)t.push(r.getInt32())}}if(!pe.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=Ru(t,e.decrypt&&!o),this._init=!0}};pe.aes._expandKey=function(e,t){return xo||Pu(),Ru(e,t)};pe.aes._updateBlock=vo;Xr("AES-ECB",pe.cipher.modes.ecb);Xr("AES-CBC",pe.cipher.modes.cbc);Xr("AES-CFB",pe.cipher.modes.cfb);Xr("AES-OFB",pe.cipher.modes.ofb);Xr("AES-CTR",pe.cipher.modes.ctr);Xr("AES-GCM",pe.cipher.modes.gcm);function Xr(e,t){var r=function(){return new pe.aes.Algorithm(e,t)};pe.cipher.registerAlgorithm(e,r)}var xo=!1,Qr=4,We,bo,Au,Sr,gt;function Pu(){xo=!0,Au=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;We=new Array(256),bo=new Array(256),Sr=new Array(4),gt=new Array(4);for(var t=0;t<4;++t)Sr[t]=new Array(256),gt[t]=new Array(256);for(var r=0,n=0,s,i,o,a,f,u,c,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,We[r]=a,bo[a]=r,f=e[a],s=e[r],i=e[s],o=e[i],u=f<<24^a<<16^a<<8^(a^f),c=(s^i^o)<<24^(r^o)<<16^(r^i^o)<<8^(r^s^o);for(var h=0;h<4;++h)Sr[h][r]=u,gt[h][a]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=s^e[e[e[s^o]]],n^=e[e[n]])}}function Ru(e,t){for(var r=e.slice(0),n,s=1,i=r.length,o=i+6+1,a=Qr*o,f=i;f<a;++f)n=r[f-1],f%i===0?(n=We[n>>>16&255]<<24^We[n>>>8&255]<<16^We[n&255]<<8^We[n>>>24]^Au[s]<<24,s++):i>6&&f%i===4&&(n=We[n>>>24]<<24^We[n>>>16&255]<<16^We[n>>>8&255]<<8^We[n&255]),r[f]=r[f-i]^n;if(t){var u,c=gt[0],h=gt[1],l=gt[2],g=gt[3],p=r.slice(0);a=r.length;for(var f=0,d=a-Qr;f<a;f+=Qr,d-=Qr)if(f===0||f===a-Qr)p[f]=r[d],p[f+1]=r[d+3],p[f+2]=r[d+2],p[f+3]=r[d+1];else for(var y=0;y<Qr;++y)u=r[d+y],p[f+(3&-y)]=c[We[u>>>24]]^h[We[u>>>16&255]]^l[We[u>>>8&255]]^g[We[u&255]];r=p}return r}function vo(e,t,r,n){var s=e.length/4-1,i,o,a,f,u;n?(i=gt[0],o=gt[1],a=gt[2],f=gt[3],u=bo):(i=Sr[0],o=Sr[1],a=Sr[2],f=Sr[3],u=We);var c,h,l,g,p,d,y;c=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],g=t[n?1:3]^e[3];for(var m=3,E=1;E<s;++E)p=i[c>>>24]^o[h>>>16&255]^a[l>>>8&255]^f[g&255]^e[++m],d=i[h>>>24]^o[l>>>16&255]^a[g>>>8&255]^f[c&255]^e[++m],y=i[l>>>24]^o[g>>>16&255]^a[c>>>8&255]^f[h&255]^e[++m],g=i[g>>>24]^o[c>>>16&255]^a[h>>>8&255]^f[l&255]^e[++m],c=p,h=d,l=y;r[0]=u[c>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[g&255]^e[++m],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[g>>>8&255]<<8^u[c&255]^e[++m],r[2]=u[l>>>24]<<24^u[g>>>16&255]<<16^u[c>>>8&255]<<8^u[h&255]^e[++m],r[n?1:3]=u[g>>>24]<<24^u[c>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^e[++m]}function Ss(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=pe.cipher.createDecipher(r,e.key):n=pe.cipher.createCipher(r,e.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof pe.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Nu=G((tv,Mu)=>{var ye=ae();go();mo();_e();Mu.exports=ye.des=ye.des||{};ye.des.startEncrypting=function(e,t,r,n){var s=Is({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return s.start(t),s};ye.des.createEncryptionCipher=function(e,t){return Is({key:e,output:null,decrypt:!1,mode:t})};ye.des.startDecrypting=function(e,t,r,n){var s=Is({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return s.start(t),s};ye.des.createDecryptionCipher=function(e,t){return Is({key:e,output:null,decrypt:!0,mode:t})};ye.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,s){return ku(r._keys,n,s,!1)},decrypt:function(n,s){return ku(r._keys,n,s,!0)}}}),r._init=!1};ye.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=ye.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Np(t),this._init=!0}};Et("DES-ECB",ye.cipher.modes.ecb);Et("DES-CBC",ye.cipher.modes.cbc);Et("DES-CFB",ye.cipher.modes.cfb);Et("DES-OFB",ye.cipher.modes.ofb);Et("DES-CTR",ye.cipher.modes.ctr);Et("3DES-ECB",ye.cipher.modes.ecb);Et("3DES-CBC",ye.cipher.modes.cbc);Et("3DES-CFB",ye.cipher.modes.cfb);Et("3DES-OFB",ye.cipher.modes.ofb);Et("3DES-CTR",ye.cipher.modes.ctr);function Et(e,t){var r=function(){return new ye.des.Algorithm(e,t)};ye.cipher.registerAlgorithm(e,r)}var Bp=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Tp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Ap=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Pp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Rp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Dp=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],kp=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Mp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Np(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=e.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,x,C=0;C<d;C++){var b=e.getInt32(),w=e.getInt32();x=(b>>>4^w)&252645135,w^=x,b^=x<<4,x=(w>>>-16^b)&65535,b^=x,w^=x<<-16,x=(b>>>2^w)&858993459,w^=x,b^=x<<2,x=(w>>>-16^b)&65535,b^=x,w^=x<<-16,x=(b>>>1^w)&1431655765,w^=x,b^=x<<1,x=(w>>>8^b)&16711935,b^=x,w^=x<<8,x=(b>>>1^w)&1431655765,w^=x,b^=x<<1,x=b<<8|w>>>20&240,b=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=x;for(var _=0;_<m.length;++_){m[_]?(b=b<<2|b>>>26,w=w<<2|w>>>26):(b=b<<1|b>>>27,w=w<<1|w>>>27),b&=-15,w&=-15;var A=t[b>>>28]|r[b>>>24&15]|n[b>>>20&15]|s[b>>>16&15]|i[b>>>12&15]|o[b>>>8&15]|a[b>>>4&15],F=f[w>>>28]|u[w>>>24&15]|c[w>>>20&15]|h[w>>>16&15]|l[w>>>12&15]|g[w>>>8&15]|p[w>>>4&15];x=(F>>>16^A)&65535,y[E++]=A^x,y[E++]=F^x<<16}}return y}function ku(e,t,r,n){var s=e.length===32?3:9,i;s===3?i=n?[30,-2,-2]:[0,32,2]:i=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],f=t[1];o=(a>>>4^f)&252645135,f^=o,a^=o<<4,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var u=0;u<s;u+=3){for(var c=i[u+1],h=i[u+2],l=i[u];l!=c;l+=h){var g=f^e[l],p=(f>>>4|f<<28)^e[l+1];o=a,a=f,f=o^(Tp[g>>>24&63]|Pp[g>>>16&63]|Dp[g>>>8&63]|Mp[g&63]|Bp[p>>>24&63]|Ap[p>>>16&63]|Rp[p>>>8&63]|kp[p&63])}o=a,a=f,f=o}a=a>>>1|a<<31,f=f>>>1|f<<31,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(a>>>4^f)&252645135,f^=o,a^=o<<4,r[0]=a,r[1]=f}function Is(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=ye.cipher.createDecipher(r,e.key):n=ye.cipher.createCipher(r,e.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof ye.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Er=G((rv,Lu)=>{var _s=ae();Lu.exports=_s.md=_s.md||{};_s.md.algorithms=_s.md.algorithms||{}});var Fu=G((nv,Ou)=>{var Ut=ae();Er();_e();var Lp=Ou.exports=Ut.hmac=Ut.hmac||{};Lp.create=function(){var e=null,t=null,r=null,n=null,s={};return s.start=function(i,o){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in Ut.md.algorithms)t=Ut.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else t=i;if(o===null)o=e;else{if(typeof o=="string")o=Ut.util.createBuffer(o);else if(Ut.util.isArray(o)){var a=o;o=Ut.util.createBuffer();for(var f=0;f<a.length;++f)o.putByte(a[f])}var u=o.length();u>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=Ut.util.createBuffer(),n=Ut.util.createBuffer(),u=o.length();for(var f=0;f<u;++f){var a=o.at(f);r.putByte(54^a),n.putByte(92^a)}if(u<t.blockLength)for(var a=t.blockLength-u,f=0;f<a;++f)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},s.update=function(i){t.update(i)},s.getMac=function(){var i=t.digest().bytes();return t.start(),t.update(n),t.update(i),t.digest()},s.digest=s.getMac,s}});var Cs=G(()=>{});var wo=G((ov,Uu)=>{var je=ae();Fu();Er();_e();var Op=je.pkcs5=je.pkcs5||{},Kt;je.util.isNodejs&&!je.options.usePureJavaScript&&(Kt=Cs());Uu.exports=je.pbkdf2=Op.pbkdf2=function(e,t,r,n,s,i){if(typeof s=="function"&&(i=s,s=null),je.util.isNodejs&&!je.options.usePureJavaScript&&Kt.pbkdf2&&(s===null||typeof s!="object")&&(Kt.pbkdf2Sync.length>4||!s||s==="sha1"))return typeof s!="string"&&(s="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),i?Kt.pbkdf2Sync.length===4?Kt.pbkdf2(e,t,r,n,function(x,C){if(x)return i(x);i(null,C.toString("binary"))}):Kt.pbkdf2(e,t,r,n,s,function(x,C){if(x)return i(x);i(null,C.toString("binary"))}):Kt.pbkdf2Sync.length===4?Kt.pbkdf2Sync(e,t,r,n).toString("binary"):Kt.pbkdf2Sync(e,t,r,n,s).toString("binary");if((typeof s>"u"||s===null)&&(s="sha1"),typeof s=="string"){if(!(s in je.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=je.md[s].create()}var o=s.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(i)return i(a);throw a}var f=Math.ceil(n/o),u=n-(f-1)*o,c=je.hmac.create();c.start(s,e);var h="",l,g,p;if(!i){for(var d=1;d<=f;++d){c.start(null,null),c.update(t),c.update(je.util.int32ToBytes(d)),l=p=c.digest().getBytes();for(var y=2;y<=r;++y)c.start(null,null),c.update(p),g=c.digest().getBytes(),l=je.util.xorBytes(l,g,o),p=g;h+=d<f?l:l.substr(0,u)}return h}var d=1,y;function m(){if(d>f)return i(null,h);c.start(null,null),c.update(t),c.update(je.util.int32ToBytes(d)),l=p=c.digest().getBytes(),y=2,E()}function E(){if(y<=r)return c.start(null,null),c.update(p),g=c.digest().getBytes(),l=je.util.xorBytes(l,g,o),p=g,++y,je.util.setImmediate(E);h+=d<f?l:l.substr(0,u),++d,m()}m()}});var Vu=G((av,qu)=>{var Ts=ae();_e();var Ku=qu.exports=Ts.pem=Ts.pem||{};Ku.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Bs(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Bs(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Bs(n)),e.headers)for(var s=0;s<e.headers.length;++s)r+=Bs(e.headers[s]);return e.procType&&(r+=`\r
`),r+=Ts.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Ku.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,s=/\r?\n/,i;i=r.exec(e),!!i;){var o=i[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ts.util.decode64(i[3])};if(t.push(a),!!i[2]){for(var f=i[2].split(s),u=0;i&&u<f.length;){for(var c=f[u].replace(/\s+$/,""),h=u+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;c+=l,u=h}if(i=c.match(n),i){for(var g={name:i[1],values:[]},p=i[2].split(","),d=0;d<p.length;++d)g.values.push(Fp(p[d]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Bs(e){for(var t=e.name+": ",r=[],n=function(f,u){return" "+u},s=0;s<e.values.length;++s)r.push(e.values[s].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var i=0,o=-1,s=0;s<t.length;++s,++i)if(i>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),i=s-o-1,o=-1,++s}else(t[s]===" "||t[s]==="	"||t[s]===",")&&(o=s);return t}function Fp(e){return e.replace(/^\s+/,"")}});var $u=G((cv,ju)=>{var It=ae();Er();_e();var Hu=ju.exports=It.sha256=It.sha256||{};It.md.sha256=It.md.algorithms.sha256=Hu;Hu.create=function(){Gu||Up();var e=null,t=It.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return t=It.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=It.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),zu(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var s=It.util.createBuffer();s.putBytes(t.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(So.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,s.putInt32(u>>>0),u=a>>>0;s.putInt32(u);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};zu(h,r,s);var l=It.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var So=null,Gu=!1,Wu=null;function Up(){So=String.fromCharCode(128),So+=It.util.fillString(String.fromCharCode(0),64),Wu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Gu=!0}function zu(e,t,r){for(var n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E=r.length();E>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,s=t[u-15],s=(s>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,t[u]=n+t[u-7]+s+t[u-16]|0;for(c=e.h0,h=e.h1,l=e.h2,g=e.h3,p=e.h4,d=e.h5,y=e.h6,m=e.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(d^y),i=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&h|l&(c^h),n=m+o+a+Wu[u]+t[u],s=i+f,m=y,y=d,d=p,p=g+n>>>0,g=l,l=h,h=c,c=n+s>>>0;e.h0=e.h0+c|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+g|0,e.h4=e.h4+p|0,e.h5=e.h5+d|0,e.h6=e.h6+y|0,e.h7=e.h7+m|0,E-=64}}});var Zu=G((uv,Yu)=>{var _t=ae();_e();var As=null;_t.util.isNodejs&&!_t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(As=Cs());var Kp=Yu.exports=_t.prng=_t.prng||{};Kp.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),s=0;s<32;++s)n[s]=r.create();t.pools=n,t.pool=0,t.generate=function(u,c){if(!c)return t.generateSync(u);var h=t.plugin.cipher,l=t.plugin.increment,g=t.plugin.formatKey,p=t.plugin.formatSeed,d=_t.util.createBuffer();t.key=null,y();function y(m){if(m)return c(m);if(d.length()>=u)return c(null,d.getBytes(u));if(t.generated>1048575&&(t.key=null),t.key===null)return _t.util.nextTick(function(){i(y)});var E=h(t.key,t.seed);t.generated+=E.length,d.putBytes(E),t.key=g(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),_t.util.setImmediate(y)}},t.generateSync=function(u){var c=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,g=t.plugin.formatSeed;t.key=null;for(var p=_t.util.createBuffer();p.length()<u;){t.generated>1048575&&(t.key=null),t.key===null&&o();var d=c(t.key,t.seed);t.generated+=d.length,p.putBytes(d),t.key=l(c(t.key,h(t.seed))),t.seed=g(c(t.key,t.seed))}return p.getBytes(u)};function i(u){if(t.pools[0].messageLength>=32)return a(),u();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(h,l){if(h)return u(h);t.collect(l),a(),u()})}function o(){if(t.pools[0].messageLength>=32)return a();var u=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(u)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var u=t.plugin.md.create();u.update(t.keyBytes);for(var c=1,h=0;h<32;++h)t.reseeds%c===0&&(u.update(t.pools[h].digest().getBytes()),t.pools[h].start()),c=c<<1;t.keyBytes=u.digest().getBytes(),u.start(),u.update(t.keyBytes);var l=u.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(u){var c=null,h=_t.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(b){return l.getRandomValues(b)});var g=_t.util.createBuffer();if(c)for(;g.length()<u;){var p=Math.max(1,Math.min(u-g.length(),65536)/4),d=new Uint32Array(Math.floor(p));try{c(d);for(var y=0;y<d.length;++y)g.putInt32(d[y])}catch(b){if(!(typeof QuotaExceededError<"u"&&b instanceof QuotaExceededError))throw b}}if(g.length()<u)for(var m,E,x,C=Math.floor(Math.random()*65536);g.length()<u;){E=16807*(C&65535),m=16807*(C>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),C=E&4294967295;for(var y=0;y<3;++y)x=C>>>(y<<3),x^=Math.floor(Math.random()*256),g.putByte(x&255)}return g.getBytes(u)}return As?(t.seedFile=function(u,c){As.randomBytes(u,function(h,l){if(h)return c(h);c(null,l.toString())})},t.seedFileSync=function(u){return As.randomBytes(u).toString()}):(t.seedFile=function(u,c){try{c(null,f(u))}catch(h){c(h)}},t.seedFileSync=f),t.collect=function(u){for(var c=u.length,h=0;h<c;++h)t.pools[t.pool].update(u.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(u,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(u>>l&255);t.collect(h)},t.registerWorker=function(u){if(u===self)t.seedFile=function(h,l){function g(p){var d=p.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",g),l(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(g,p){u.postMessage({forge:{prng:{err:g,bytes:p}}})})};u.addEventListener("message",c)}},t}});var Fn=G((fv,Eo)=>{var Le=ae();Es();$u();Zu();_e();(function(){if(Le.random&&Le.random.getBytes){Eo.exports=Le.random;return}(function(e){var t={},r=new Array(4),n=Le.util.createBuffer();t.formatKey=function(h){var l=Le.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Le.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Le.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Le.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Le.md.sha256;function s(){var h=Le.prng.create(t);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var i=s(),o=null,a=Le.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Le.options.usePureJavaScript||!Le.util.isNodejs&&!o){if(typeof window>"u"||window.document,i.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch{}i.collect(u),u=null}e&&(e().mousemove(function(h){i.collectInt(h.clientX,16),i.collectInt(h.clientY,16)}),e().keypress(function(h){i.collectInt(h.charCode,8)}))}if(!Le.random)Le.random=i;else for(var c in i)Le.random[c]=i[c];Le.random.createInstance=s,Eo.exports=Le.random})(typeof jQuery<"u"?jQuery:null)})()});var ef=G((hv,Ju)=>{var Je=ae();_e();var Io=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Qu=[1,2,3,5],qp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Vp=function(e,t){return(e&65535)>>t|e<<16-t&65535};Ju.exports=Je.rc2=Je.rc2||{};Je.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Je.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),s=t,i=Math.ceil(s/8),o=255>>(s&7),a;for(a=n;a<128;a++)r.putByte(Io[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-i,Io[r.at(128-i)&o]),a=127-i;a>=0;a--)r.setAt(a,Io[r.at(a+1)^r.at(a+i)]);return r};var Xu=function(e,t,r){var n=!1,s=null,i=null,o=null,a,f,u,c,h=[];for(e=Je.rc2.expandKey(e,t),u=0;u<64;u++)h.push(e.getInt16Le());r?(a=function(p){for(u=0;u<4;u++)p[u]+=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=qp(p[u],Qu[u]),c++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(a=function(p){for(u=3;u>=0;u--)p[u]=Vp(p[u],Qu[u]),p[u]-=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),c--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var d=[];for(u=0;u<4;u++){var y=s.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),d.push(y&65535)}c=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](d);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(d[u]):d[u]^=o.getInt16Le()),i.putInt16Le(d[u])},g=null;return g={start:function(p,d){p&&typeof p=="string"&&(p=Je.util.createBuffer(p)),n=!1,s=Je.util.createBuffer(),i=d||new Je.util.createBuffer,o=p,g.output=i},update:function(p){for(n||s.putBuffer(p);s.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(p){var d=!0;if(r)if(p)d=p(8,s,!r);else{var y=s.length()===8?8:8-s.length();s.fillWithByte(y,y)}if(d&&(n=!0,g.update()),!r&&(d=s.length()===0,d))if(p)d=p(8,i,!r);else{var m=i.length(),E=i.at(m-1);E>m?d=!1:i.truncate(E)}return d}},g};Je.rc2.startEncrypting=function(e,t,r){var n=Je.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Je.rc2.createEncryptionCipher=function(e,t){return Xu(e,t,!0)};Je.rc2.startDecrypting=function(e,t,r){var n=Je.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Je.rc2.createDecryptionCipher=function(e,t){return Xu(e,t,!1)}});var Ds=G((lv,uf)=>{var _o=ae();uf.exports=_o.jsbn=_o.jsbn||{};var qt,zp=0xdeadbeefcafe,tf=(zp&16777215)==15715070;function T(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}_o.jsbn.BigInteger=T;function ne(){return new T(null)}function Hp(e,t,r,n,s,i){for(;--i>=0;){var o=t*this.data[e++]+r.data[n]+s;s=Math.floor(o/67108864),r.data[n++]=o&67108863}return s}function Gp(e,t,r,n,s,i){for(var o=t&32767,a=t>>15;--i>=0;){var f=this.data[e]&32767,u=this.data[e++]>>15,c=a*f+u*o;f=o*f+((c&32767)<<15)+r.data[n]+(s&1073741823),s=(f>>>30)+(c>>>15)+a*u+(s>>>30),r.data[n++]=f&1073741823}return s}function rf(e,t,r,n,s,i){for(var o=t&16383,a=t>>14;--i>=0;){var f=this.data[e]&16383,u=this.data[e++]>>14,c=a*f+u*o;f=o*f+((c&16383)<<14)+r.data[n]+s,s=(f>>28)+(c>>14)+a*u,r.data[n++]=f&268435455}return s}typeof navigator>"u"?(T.prototype.am=rf,qt=28):tf&&navigator.appName=="Microsoft Internet Explorer"?(T.prototype.am=Gp,qt=30):tf&&navigator.appName!="Netscape"?(T.prototype.am=Hp,qt=26):(T.prototype.am=rf,qt=28);T.prototype.DB=qt;T.prototype.DM=(1<<qt)-1;T.prototype.DV=1<<qt;var Co=52;T.prototype.FV=Math.pow(2,Co);T.prototype.F1=Co-qt;T.prototype.F2=2*qt-Co;var Wp="0123456789abcdefghijklmnopqrstuvwxyz",Ps=new Array,Jr,ut;Jr="0".charCodeAt(0);for(ut=0;ut<=9;++ut)Ps[Jr++]=ut;Jr="a".charCodeAt(0);for(ut=10;ut<36;++ut)Ps[Jr++]=ut;Jr="A".charCodeAt(0);for(ut=10;ut<36;++ut)Ps[Jr++]=ut;function nf(e){return Wp.charAt(e)}function sf(e,t){var r=Ps[e.charCodeAt(t)];return r??-1}function jp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function $p(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function ir(e){var t=ne();return t.fromInt(e),t}function Yp(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,s=!1,i=0;--n>=0;){var o=r==8?e[n]&255:sf(e,n);if(o<0){e.charAt(n)=="-"&&(s=!0);continue}s=!1,i==0?this.data[this.t++]=o:i+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-i)-1)<<i,this.data[this.t++]=o>>this.DB-i):this.data[this.t-1]|=o<<i,i+=r,i>=this.DB&&(i-=this.DB)}r==8&&e[0]&128&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),s&&T.ZERO.subTo(this,this)}function Zp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Qp(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(s=!0,i=nf(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(s=!0),s&&(i+=nf(n));return s?i:"0"}function Xp(){var e=ne();return T.ZERO.subTo(this,e),e}function Jp(){return this.s<0?this.negate():this}function ed(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Rs(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function td(){return this.t<=0?0:this.DB*(this.t-1)+Rs(this.data[this.t-1]^this.s&this.DM)}function rd(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function nd(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function sd(e,t){var r=e%this.DB,n=this.DB-r,s=(1<<n)-1,i=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+i+1]=this.data[a]>>n|o,o=(this.data[a]&s)<<r;for(a=i-1;a>=0;--a)t.data[a]=0;t.data[i]=o,t.t=this.t+i+1,t.s=this.s,t.clamp()}function id(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,s=this.DB-n,i=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&i)<<s,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&i)<<s),t.t=this.t-r,t.clamp()}function od(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function ad(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t.data[s]=0;for(s=0;s<n.t;++s)t.data[s+r.t]=r.am(0,n.data[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&T.ZERO.subTo(t,t)}function cd(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function ud(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ne());var i=ne(),o=this.s,a=e.s,f=this.DB-Rs(n.data[n.t-1]);f>0?(n.lShiftTo(f,i),s.lShiftTo(f,r)):(n.copyTo(i),s.copyTo(r));var u=i.t,c=i.data[u-1];if(c!=0){var h=c*(1<<this.F1)+(u>1?i.data[u-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,p=1<<this.F2,d=r.t,y=d-u,m=t??ne();for(i.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),T.ONE.dlShiftTo(u,m),m.subTo(i,i);i.t<u;)i.data[i.t++]=0;for(;--y>=0;){var E=r.data[--d]==c?this.DM:Math.floor(r.data[d]*l+(r.data[d-1]+p)*g);if((r.data[d]+=i.am(0,E,r,y,0,u))<E)for(i.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--E;)r.subTo(m,r)}t!=null&&(r.drShiftTo(u,t),o!=a&&T.ZERO.subTo(t,t)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&T.ZERO.subTo(r,r)}}}function fd(e){var t=ne();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(T.ZERO)>0&&e.subTo(t,t),t}function Ir(e){this.m=e}function hd(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ld(e){return e}function pd(e){e.divRemTo(this.m,null,e)}function dd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function gd(e,t){e.squareTo(t),this.reduce(t)}Ir.prototype.convert=hd;Ir.prototype.revert=ld;Ir.prototype.reduce=pd;Ir.prototype.mulTo=dd;Ir.prototype.sqrTo=gd;function yd(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function _r(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function md(e){var t=ne();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(T.ZERO)>0&&this.m.subTo(t,t),t}function bd(e){var t=ne();return e.copyTo(t),this.reduce(t),t}function vd(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function xd(e,t){e.squareTo(t),this.reduce(t)}function wd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}_r.prototype.convert=md;_r.prototype.revert=bd;_r.prototype.reduce=vd;_r.prototype.mulTo=wd;_r.prototype.sqrTo=xd;function Sd(){return(this.t>0?this.data[0]&1:this.s)==0}function Ed(e,t){if(e>4294967295||e<1)return T.ONE;var r=ne(),n=ne(),s=t.convert(this),i=Rs(e)-1;for(s.copyTo(r);--i>=0;)if(t.sqrTo(r,n),(e&1<<i)>0)t.mulTo(n,s,r);else{var o=r;r=n,n=o}return t.revert(r)}function Id(e,t){var r;return e<256||t.isEven()?r=new Ir(t):r=new _r(t),this.exp(e,r)}T.prototype.copyTo=jp;T.prototype.fromInt=$p;T.prototype.fromString=Yp;T.prototype.clamp=Zp;T.prototype.dlShiftTo=rd;T.prototype.drShiftTo=nd;T.prototype.lShiftTo=sd;T.prototype.rShiftTo=id;T.prototype.subTo=od;T.prototype.multiplyTo=ad;T.prototype.squareTo=cd;T.prototype.divRemTo=ud;T.prototype.invDigit=yd;T.prototype.isEven=Sd;T.prototype.exp=Ed;T.prototype.toString=Qp;T.prototype.negate=Xp;T.prototype.abs=Jp;T.prototype.compareTo=ed;T.prototype.bitLength=td;T.prototype.mod=fd;T.prototype.modPowInt=Id;T.ZERO=ir(0);T.ONE=ir(1);function _d(){var e=ne();return this.copyTo(e),e}function Cd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Bd(){return this.t==0?this.s:this.data[0]<<24>>24}function Td(){return this.t==0?this.s:this.data[0]<<16>>16}function Ad(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Pd(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Rd(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=ir(r),s=ne(),i=ne(),o="";for(this.divRemTo(n,s,i);s.signum()>0;)o=(r+i.intValue()).toString(e).substr(1)+o,s.divRemTo(n,s,i);return i.intValue().toString(e)+o}function Dd(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,i=0,o=0,a=0;a<e.length;++a){var f=sf(e,a);if(f<0){e.charAt(a)=="-"&&this.signum()==0&&(s=!0);continue}o=t*o+f,++i>=r&&(this.dMultiply(n),this.dAddOffset(o,0),i=0,o=0)}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(o,0)),s&&T.ZERO.subTo(this,this)}function kd(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(T.ONE.shiftLeft(e-1),Bo,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(T.ONE.shiftLeft(e-1),this);else{var n=new Array,s=e&7;n.length=(e>>3)+1,t.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}}function Md(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,s=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[s++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),s==0&&(this.s&128)!=(n&128)&&++s,(s>0||n!=this.s)&&(t[s++]=n);return t}function Nd(e){return this.compareTo(e)==0}function Ld(e){return this.compareTo(e)<0?this:e}function Od(e){return this.compareTo(e)>0?this:e}function Fd(e,t,r){var n,s,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(s=e.s&this.DM,n=i;n<this.t;++n)r.data[n]=t(this.data[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<e.t;++n)r.data[n]=t(s,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Ud(e,t){return e&t}function Kd(e){var t=ne();return this.bitwiseTo(e,Ud,t),t}function Bo(e,t){return e|t}function qd(e){var t=ne();return this.bitwiseTo(e,Bo,t),t}function of(e,t){return e^t}function Vd(e){var t=ne();return this.bitwiseTo(e,of,t),t}function af(e,t){return e&~t}function zd(e){var t=ne();return this.bitwiseTo(e,af,t),t}function Hd(){for(var e=ne(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Gd(e){var t=ne();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Wd(e){var t=ne();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function jd(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function $d(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+jd(this.data[e]);return this.s<0?this.t*this.DB:-1}function Yd(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Zd(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Yd(this.data[r]^t);return e}function Qd(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Xd(e,t){var r=T.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Jd(e){return this.changeBit(e,Bo)}function eg(e){return this.changeBit(e,af)}function tg(e){return this.changeBit(e,of)}function rg(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function ng(e){var t=ne();return this.addTo(e,t),t}function sg(e){var t=ne();return this.subTo(e,t),t}function ig(e){var t=ne();return this.multiplyTo(e,t),t}function og(e){var t=ne();return this.divRemTo(e,t,null),t}function ag(e){var t=ne();return this.divRemTo(e,null,t),t}function cg(e){var t=ne(),r=ne();return this.divRemTo(e,t,r),new Array(t,r)}function ug(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function fg(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Un(){}function cf(e){return e}function hg(e,t,r){e.multiplyTo(t,r)}function lg(e,t){e.squareTo(t)}Un.prototype.convert=cf;Un.prototype.revert=cf;Un.prototype.mulTo=hg;Un.prototype.sqrTo=lg;function pg(e){return this.exp(e,new Un)}function dg(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var s;for(s=r.t-this.t;n<s;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(s=Math.min(e.t,t);n<s;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function gg(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function en(e){this.r2=ne(),this.q3=ne(),T.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function yg(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ne();return e.copyTo(t),this.reduce(t),t}function mg(e){return e}function bg(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function vg(e,t){e.squareTo(t),this.reduce(t)}function xg(e,t,r){e.multiplyTo(t,r),this.reduce(r)}en.prototype.convert=yg;en.prototype.revert=mg;en.prototype.reduce=bg;en.prototype.mulTo=xg;en.prototype.sqrTo=vg;function wg(e,t){var r=e.bitLength(),n,s=ir(1),i;if(r<=0)return s;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?i=new Ir(t):t.isEven()?i=new en(t):i=new _r(t);var o=new Array,a=3,f=n-1,u=(1<<n)-1;if(o[1]=i.convert(this),n>1){var c=ne();for(i.sqrTo(o[1],c);a<=u;)o[a]=ne(),i.mulTo(c,o[a-2],o[a]),a+=2}var h=e.t-1,l,g=!0,p=ne(),d;for(r=Rs(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&u:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[l].copyTo(s),g=!1;else{for(;a>1;)i.sqrTo(s,p),i.sqrTo(p,s),a-=2;a>0?i.sqrTo(s,p):(d=s,s=p,p=d),i.mulTo(p,o[l],s)}for(;h>=0&&!(e.data[h]&1<<r);)i.sqrTo(s,p),d=s,s=p,p=d,--r<0&&(r=this.DB-1,--h)}return i.revert(s)}function Sg(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(s<i&&(i=s),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r}function Eg(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Ig(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return T.ZERO;for(var r=e.clone(),n=this.clone(),s=ir(1),i=ir(0),o=ir(0),a=ir(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!i.isEven())&&(s.addTo(this,s),i.subTo(e,i)),s.rShiftTo(1,s)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(o,s),i.subTo(a,i)):(n.subTo(r,n),t&&o.subTo(s,o),a.subTo(i,a))}if(n.compareTo(T.ONE)!=0)return T.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var yt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],_g=(1<<26)/yt[yt.length-1];function Cg(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=yt[yt.length-1]){for(t=0;t<yt.length;++t)if(r.data[0]==yt[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<yt.length;){for(var n=yt[t],s=t+1;s<yt.length&&n<_g;)n*=yt[s++];for(n=r.modInt(n);t<s;)if(n%yt[t++]==0)return!1}return r.millerRabin(e)}function Bg(e){var t=this.subtract(T.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),s=Tg(),i,o=0;o<e;++o){do i=new T(this.bitLength(),s);while(i.compareTo(T.ONE)<=0||i.compareTo(t)>=0);var a=i.modPow(n,this);if(a.compareTo(T.ONE)!=0&&a.compareTo(t)!=0){for(var f=1;f++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(T.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function Tg(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}T.prototype.chunkSize=Ad;T.prototype.toRadix=Rd;T.prototype.fromRadix=Dd;T.prototype.fromNumber=kd;T.prototype.bitwiseTo=Fd;T.prototype.changeBit=Xd;T.prototype.addTo=rg;T.prototype.dMultiply=ug;T.prototype.dAddOffset=fg;T.prototype.multiplyLowerTo=dg;T.prototype.multiplyUpperTo=gg;T.prototype.modInt=Eg;T.prototype.millerRabin=Bg;T.prototype.clone=_d;T.prototype.intValue=Cd;T.prototype.byteValue=Bd;T.prototype.shortValue=Td;T.prototype.signum=Pd;T.prototype.toByteArray=Md;T.prototype.equals=Nd;T.prototype.min=Ld;T.prototype.max=Od;T.prototype.and=Kd;T.prototype.or=qd;T.prototype.xor=Vd;T.prototype.andNot=zd;T.prototype.not=Hd;T.prototype.shiftLeft=Gd;T.prototype.shiftRight=Wd;T.prototype.getLowestSetBit=$d;T.prototype.bitCount=Zd;T.prototype.testBit=Qd;T.prototype.setBit=Jd;T.prototype.clearBit=eg;T.prototype.flipBit=tg;T.prototype.add=ng;T.prototype.subtract=sg;T.prototype.multiply=ig;T.prototype.divide=og;T.prototype.remainder=ag;T.prototype.divideAndRemainder=cg;T.prototype.modPow=wg;T.prototype.modInverse=Ig;T.prototype.pow=pg;T.prototype.gcd=Sg;T.prototype.isProbablePrime=Cg});var df=G((pv,pf)=>{var Ct=ae();Er();_e();var hf=pf.exports=Ct.sha1=Ct.sha1||{};Ct.md.sha1=Ct.md.algorithms.sha1=hf;hf.create=function(){lf||Ag();var e=null,t=Ct.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return t=Ct.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=Ct.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),ff(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var s=Ct.util.createBuffer();s.putBytes(t.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(To.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,s.putInt32(u>>>0),u=a>>>0;s.putInt32(u);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ff(h,r,s);var l=Ct.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var To=null,lf=!1;function Ag(){To=String.fromCharCode(128),To+=Ct.util.fillString(String.fromCharCode(0),64),lf=!0}function ff(e,t,r){for(var n,s,i,o,a,f,u,c,h=r.length();h>=64;){for(s=e.h0,i=e.h1,o=e.h2,a=e.h3,f=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,u=a^i&(o^a),n=(s<<5|s>>>27)+u+f+1518500249+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<20;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=a^i&(o^a),n=(s<<5|s>>>27)+u+f+1518500249+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<32;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+1859775393+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<40;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+1859775393+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<60;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=i&o|a&(i^o),n=(s<<5|s>>>27)+u+f+2400959708+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;c<80;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=i^o^a,n=(s<<5|s>>>27)+u+f+3395469782+n,f=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;e.h0=e.h0+s|0,e.h1=e.h1+i|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+f|0,h-=64}}});var mf=G((dv,yf)=>{var Bt=ae();_e();Fn();df();var gf=yf.exports=Bt.pkcs1=Bt.pkcs1||{};gf.encode_rsa_oaep=function(e,t,r){var n,s,i,o;typeof r=="string"?(n=r,s=arguments[3]||void 0,i=arguments[4]||void 0):r&&(n=r.label||void 0,s=r.seed||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),i?i.start():i=Bt.md.sha1.create(),o||(o=i);var a=Math.ceil(e.n.bitLength()/8),f=a-2*i.digestLength-2;if(t.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=t.length,u.maxLength=f,u}n||(n=""),i.update(n,"raw");for(var c=i.digest(),h="",l=f-t.length,g=0;g<l;g++)h+="\0";var p=c.getBytes()+h+""+t;if(!s)s=Bt.random.getBytes(i.digestLength);else if(s.length!==i.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=s.length,u.digestLength=i.digestLength,u}var d=ks(s,a-i.digestLength-1,o),y=Bt.util.xorBytes(p,d,p.length),m=ks(y,i.digestLength,o),E=Bt.util.xorBytes(s,m,s.length);return"\0"+E+y};gf.decode_rsa_oaep=function(e,t,r){var n,s,i;typeof r=="string"?(n=r,s=arguments[3]||void 0):r&&(n=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=t.length,y.expectedLength=o,y}if(s===void 0?s=Bt.md.sha1.create():s.start(),i||(i=s),o<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),s.update(n,"raw");for(var a=s.digest().getBytes(),f=t.charAt(0),u=t.substring(1,s.digestLength+1),c=t.substring(1+s.digestLength),h=ks(c,s.digestLength,i),l=Bt.util.xorBytes(u,h,u.length),g=ks(l,o-s.digestLength-1,i),p=Bt.util.xorBytes(c,g,c.length),d=p.substring(0,s.digestLength),y=f!=="\0",m=0;m<s.digestLength;++m)y|=a.charAt(m)!==d.charAt(m);for(var E=1,x=s.digestLength,C=s.digestLength;C<p.length;C++){var b=p.charCodeAt(C),w=b&1^1,_=E?65534:0;y|=b&_,E=E&w,x+=E}if(y||p.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(x+1)};function ks(e,t,r){r||(r=Bt.md.sha1.create());for(var n="",s=Math.ceil(t/r.digestLength),i=0;i<s;++i){var o=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}});var bf=G((gv,Ao)=>{var or=ae();_e();Ds();Fn();(function(){if(or.prime){Ao.exports=or.prime;return}var e=Ao.exports=or.prime=or.prime||{},t=or.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var s=function(h,l){return h|l};e.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var d=l.prng||or.random,y={nextBytes:function(m){for(var E=d.getBytesSync(m.length),x=0;x<m.length;++x)m[x]=E.charCodeAt(x)}};if(p.name==="PRIMEINC")return i(h,y,p.options,g);throw new Error("Invalid prime generation algorithm: "+p.name)};function i(h,l,g,p){return"workers"in g?f(h,l,g,p):o(h,l,g,p)}function o(h,l,g,p){var d=u(h,l),y=0,m=c(d.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var E=10;"maxBlockTime"in g&&(E=g.maxBlockTime),a(d,h,l,y,m,E,p)}function a(h,l,g,p,d,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=u(l,g)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-E<y);or.util.setImmediate(function(){a(h,l,g,p,d,y,m)})}function f(h,l,g,p){if(typeof Worker>"u")return o(h,l,g,p);var d=u(h,l),y=g.workers,m=g.workLoad||100,E=m*30/8,x=g.workerScript||"forge/prime.worker.js";if(y===-1)return or.util.estimateCores(function(b,w){b&&(w=2),y=w-1,C()});C();function C(){y=Math.max(1,y);for(var b=[],w=0;w<y;++w)b[w]=new Worker(x);for(var _=y,w=0;w<y;++w)b[w].addEventListener("message",F);var A=!1;function F(K){if(!A){--_;var q=K.data;if(q.found){for(var X=0;X<b.length;++X)b[X].terminate();return A=!0,p(null,new t(q.prime,16))}d.bitLength()>h&&(d=u(h,l));var ce=d.toString(16);K.target.postMessage({hex:ce,workLoad:m}),d.dAddOffset(E,0)}}}}function u(h,l){var g=new t(h,l),p=h-1;return g.testBit(p)||g.bitwiseTo(t.ONE.shiftLeft(p),s,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Ns=G((yv,_f)=>{var H=ae();On();Ds();bs();mf();bf();Fn();_e();typeof te>"u"&&(te=H.jsbn.BigInteger);var te,Po=H.util.isNodejs?Cs():null,S=H.asn1,ft=H.util;H.pki=H.pki||{};_f.exports=H.pki.rsa=H.rsa=H.rsa||{};var j=H.pki,Pg=[6,4,2,4,2,4,6,2],Rg={name:"PrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Dg={name:"RSAPrivateKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},kg={name:"RSAPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Mg=H.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ng={name:"DigestInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Lg=function(e){var t;if(e.algorithm in j.oids)t=j.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=S.oidToDer(t).getBytes(),s=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);i.value.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,n)),i.value.push(S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,""));var o=S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,e.digest().getBytes());return s.value.push(i),s.value.push(o),S.toDer(s).getBytes()},Ef=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(te.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(te.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new te(H.util.bytesToHex(H.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(te.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var s=e.mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(i)<0;)s=s.add(t.p);var o=s.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o};j.rsa.encrypt=function(e,t,r){var n=r,s,i=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,s=If(e,t,r)):(s=H.util.createBuffer(),s.putBytes(e));for(var o=new te(s.toHex(),16),a=Ef(o,t,n),f=a.toString(16),u=H.util.createBuffer(),c=i-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(H.util.hexToBytes(f)),u.getBytes()};j.rsa.decrypt=function(e,t,r,n){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var i=new Error("Encrypted message length is invalid.");throw i.length=e.length,i.expected=s,i}var o=new te(H.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Ef(o,t,r),f=a.toString(16),u=H.util.createBuffer(),c=s-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(H.util.hexToBytes(f)),n!==!1?Ms(u.getBytes(),t,r):u.getBytes()};j.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||H.random,s={nextBytes:function(a){for(var f=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=f.charCodeAt(u)}},i=r.algorithm||"PRIMEINC",o;if(i==="PRIMEINC")o={algorithm:i,state:0,bits:e,rng:s,eInt:t||65537,e:new te(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+i);return o};j.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new te(null);r.fromInt(30);for(var n=0,s=function(h,l){return h|l},i=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,u=f-1;e.pqState===0?(e.num=new te(f,e.rng),e.num.testBit(u)||e.num.bitwiseTo(te.ONE.shiftLeft(u),s,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Fg(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Pg[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(te.ONE).gcd(e.e).compareTo(te.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(te.ONE),e.q1=e.q.subtract(te.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(te.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:j.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:j.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-i,i=o}return e.keys!==null};j.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!H.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(vf("generateKeyPair"))return Po.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,u){if(a)return n(a);n(null,{privateKey:j.privateKeyFromPem(u),publicKey:j.publicKeyFromPem(f)})});if(xf("generateKey")&&xf("exportKey"))return ft.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Sf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ft.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=j.privateKeyFromAsn1(S.fromDer(H.util.createBuffer(a)));n(null,{privateKey:f,publicKey:j.setRsaPublicKey(f.n,f.e)})}});if(wf("generateKey")&&wf("exportKey")){var s=ft.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Sf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);s.oncomplete=function(a){var f=a.target.result,u=ft.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(c){var h=c.target.result,l=j.privateKeyFromAsn1(S.fromDer(H.util.createBuffer(h)));n(null,{privateKey:l,publicKey:j.setRsaPublicKey(l.n,l.e)})},u.onerror=function(c){n(c)}},s.onerror=function(a){n(a)};return}}else if(vf("generateKeyPairSync")){var i=Po.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:j.privateKeyFromPem(i.privateKey),publicKey:j.publicKeyFromPem(i.publicKey)}}}var o=j.rsa.createKeyPairGenerationState(e,t,r);if(!n)return j.rsa.stepKeyPairGenerationState(o,0),o.keys;Og(o,r,n)};j.setRsaPublicKey=j.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,s,i){if(typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSAES-PKCS1-V1_5"),s==="RSAES-PKCS1-V1_5")s={encode:function(a,f,u){return If(a,f,2).getBytes()}};else if(s==="RSA-OAEP"||s==="RSAES-OAEP")s={encode:function(a,f){return H.pkcs1.encode_rsa_oaep(f,a,i)}};else if(["RAW","NONE","NULL",null].indexOf(s)!==-1)s={encode:function(a){return a}};else if(typeof s=="string")throw new Error('Unsupported encryption scheme: "'+s+'".');var o=s.encode(n,r,!0);return j.rsa.encrypt(o,r,!0)},r.verify=function(n,s,i,o){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),i==="RSASSA-PKCS1-V1_5"?i={verify:function(f,u){u=Ms(u,r,!0);var c=S.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!S.validate(c,Ng,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var p=S.derToOid(h.algorithmIdentifier);if(!(p===H.oids.md2||p===H.oids.md5||p===H.oids.sha1||p===H.oids.sha224||p===H.oids.sha256||p===H.oids.sha384||p===H.oids.sha512||p===H.oids["sha512-224"]||p===H.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=p,g}if((p===H.oids.md2||p===H.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(f,u){return u=Ms(u,r,!0),f===u}});var a=j.rsa.decrypt(s,r,!0,!1);return i.verify(n,a,r.n.bitLength())},r};j.setRsaPrivateKey=j.rsa.setPrivateKey=function(e,t,r,n,s,i,o,a){var f={n:e,e:t,d:r,p:n,q:s,dP:i,dQ:o,qInv:a};return f.decrypt=function(u,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=j.rsa.decrypt(u,f,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:Ms};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(g,p){return H.pkcs1.decode_rsa_oaep(p,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,f,!1)},f.sign=function(u,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:Lg},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},h=1);var l=c.encode(u,f.n.bitLength());return j.rsa.encrypt(l,f,h)},f};j.wrapRsaPrivateKey=function(e){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(0).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(j.oids.rsaEncryption).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(e).getBytes())])};j.privateKeyFromAsn1=function(e){var t={},r=[];if(S.validate(e,Rg,t,r)&&(e=S.fromDer(H.util.createBuffer(t.privateKey))),t={},r=[],!S.validate(e,Dg,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var s,i,o,a,f,u,c,h;return s=H.util.createBuffer(t.privateKeyModulus).toHex(),i=H.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=H.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=H.util.createBuffer(t.privateKeyPrime1).toHex(),f=H.util.createBuffer(t.privateKeyPrime2).toHex(),u=H.util.createBuffer(t.privateKeyExponent1).toHex(),c=H.util.createBuffer(t.privateKeyExponent2).toHex(),h=H.util.createBuffer(t.privateKeyCoefficient).toHex(),j.setRsaPrivateKey(new te(s,16),new te(i,16),new te(o,16),new te(a,16),new te(f,16),new te(u,16),new te(c,16),new te(h,16))};j.privateKeyToAsn1=j.privateKeyToRSAPrivateKey=function(e){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(0).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.n)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.e)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.d)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.p)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.q)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.dP)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.dQ)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.qInv))])};j.publicKeyFromAsn1=function(e){var t={},r=[];if(S.validate(e,Mg,t,r)){var n=S.derToOid(t.publicKeyOid);if(n!==j.oids.rsaEncryption){var s=new Error("Cannot read public key. Unknown OID.");throw s.oid=n,s}e=t.rsaPublicKey}if(r=[],!S.validate(e,kg,t,r)){var s=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw s.errors=r,s}var i=H.util.createBuffer(t.publicKeyModulus).toHex(),o=H.util.createBuffer(t.publicKeyExponent).toHex();return j.setRsaPublicKey(new te(i,16),new te(o,16))};j.publicKeyToAsn1=j.publicKeyToSubjectPublicKeyInfo=function(e){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(j.oids.rsaEncryption).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,[j.publicKeyToRSAPublicKey(e)])])};j.publicKeyToRSAPublicKey=function(e){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.n)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Tt(e.e))])};function If(e,t,r){var n=H.util.createBuffer(),s=Math.ceil(t.n.bitLength()/8);if(e.length>s-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=s-11,i}n.putByte(0),n.putByte(r);var o=s-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<o;++f)n.putByte(a)}else for(;o>0;){for(var u=0,c=H.random.getBytes(o),f=0;f<o;++f)a=c.charCodeAt(f),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(e),n}function Ms(e,t,r,n){var s=Math.ceil(t.n.bitLength()/8),i=H.util.createBuffer(e),o=i.getByte(),a=i.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=s-3-n;for(var u=0;u<f;++u)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++f}else if(a===2)for(f=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++f}var c=i.getByte();if(c!==0||f!==s-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Og(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),s();function s(){i(e.pBits,function(a,f){if(a)return r(a);if(e.p=f,e.q!==null)return o(a,e.q);i(e.qBits,o)})}function i(a,f){H.prime.generateProbablePrime(a,n,f)}function o(a,f){if(a)return r(a);if(e.q=f,e.p.compareTo(e.q)<0){var u=e.p;e.p=e.q,e.q=u}if(e.p.subtract(te.ONE).gcd(e.e).compareTo(te.ONE)!==0){e.p=null,s();return}if(e.q.subtract(te.ONE).gcd(e.e).compareTo(te.ONE)!==0){e.q=null,i(e.qBits,o);return}if(e.p1=e.p.subtract(te.ONE),e.q1=e.q.subtract(te.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(te.ONE)!==0){e.p=e.q=null,s();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,i(e.qBits,o);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:j.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:j.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Tt(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=H.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Fg(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function vf(e){return H.util.isNodejs&&typeof Po[e]=="function"}function xf(e){return typeof ft.globalScope<"u"&&typeof ft.globalScope.crypto=="object"&&typeof ft.globalScope.crypto.subtle=="object"&&typeof ft.globalScope.crypto.subtle[e]=="function"}function wf(e){return typeof ft.globalScope<"u"&&typeof ft.globalScope.msCrypto=="object"&&typeof ft.globalScope.msCrypto.subtle=="object"&&typeof ft.globalScope.msCrypto.subtle[e]=="function"}function Sf(e){for(var t=H.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Rf=G((mv,Pf)=>{var L=ae();Es();On();Nu();Er();bs();wo();Vu();Fn();ef();Ns();_e();typeof Cf>"u"&&(Cf=L.jsbn.BigInteger);var Cf,I=L.asn1,$=L.pki=L.pki||{};Pf.exports=$.pbe=L.pbe=L.pbe||{};var Cr=$.oids,Ug={name:"EncryptedPrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Kg={name:"PBES2Algorithms",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},qg={name:"pkcs-12PbeParams",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"iterations"}]};$.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=L.random.getBytesSync(r.saltSize),s=r.count,i=I.integerToDer(s),o,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,c,h;switch(r.algorithm){case"aes128":o=16,u=16,c=Cr["aes128-CBC"],h=L.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,c=Cr["aes192-CBC"],h=L.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,c=Cr["aes256-CBC"],h=L.aes.createEncryptionCipher;break;case"des":o=8,u=8,c=Cr.desCBC,h=L.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Af(g),d=L.pkcs5.pbkdf2(t,n,s,o,p),y=L.random.getBytesSync(u),m=h(d);m.start(y),m.update(I.toDer(e)),m.finish(),f=m.output.getBytes();var E=Vg(n,i,o,g);a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Cr.pkcs5PBES2).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Cr.pkcs5PBKDF2).getBytes()),E]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(c).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var x=new L.util.ByteBuffer(n),d=$.pbe.generatePkcs12Key(t,x,1,s,o),y=$.pbe.generatePkcs12Key(t,x,2,s,o),m=L.des.createEncryptionCipher(d);m.start(y),m.update(I.toDer(e)),m.finish(),f=m.output.getBytes(),a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(Cr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,i.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[a,I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,f)]);return C};$.decryptPrivateKeyInfo=function(e,t){var r=null,n={},s=[];if(!I.validate(e,Ug,n,s)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=I.derToOid(n.encryptionOid),a=$.pbe.getCipher(o,n.encryptionParams,t),f=L.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=I.fromDer(a.output)),r};$.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:I.toDer(e).getBytes()};return L.pem.encode(r,{maxline:t})};$.encryptedPrivateKeyFromPem=function(e){var t=L.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return I.fromDer(t.body)};$.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=$.wrapRsaPrivateKey($.privateKeyToAsn1(e));return n=$.encryptPrivateKeyInfo(n,t,r),$.encryptedPrivateKeyToPem(n)}var s,i,o,a;switch(r.algorithm){case"aes128":s="AES-128-CBC",o=16,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"aes192":s="AES-192-CBC",o=24,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"aes256":s="AES-256-CBC",o=32,i=L.random.getBytesSync(16),a=L.aes.createEncryptionCipher;break;case"3des":s="DES-EDE3-CBC",o=24,i=L.random.getBytesSync(8),a=L.des.createEncryptionCipher;break;case"des":s="DES-CBC",o=8,i=L.random.getBytesSync(8),a=L.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=L.pbe.opensslDeriveBytes(t,i.substr(0,8),o),c=a(u);c.start(i),c.update(I.toDer($.privateKeyToAsn1(e))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:s,parameters:L.util.bytesToHex(i).toUpperCase()},body:c.output.getBytes()};return L.pem.encode(h)};$.decryptRsaPrivateKey=function(e,t){var r=null,n=L.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var s=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw s.headerType=s,s}if(n.procType&&n.procType.type==="ENCRYPTED"){var i,o;switch(n.dekInfo.algorithm){case"DES-CBC":i=8,o=L.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,o=L.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,o=L.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,o=L.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,o=L.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,o=function(h){return L.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,o=function(h){return L.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,o=function(h){return L.rc2.createDecryptionCipher(h,128)};break;default:var s=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw s.algorithm=n.dekInfo.algorithm,s}var a=L.util.hexToBytes(n.dekInfo.parameters),f=L.pbe.opensslDeriveBytes(t,a.substr(0,8),i),u=o(f);if(u.start(a),u.update(L.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=$.decryptPrivateKeyInfo(I.fromDer(r),t):r=I.fromDer(r),r!==null&&(r=$.privateKeyFromAsn1(r)),r};$.pbe.generatePkcs12Key=function(e,t,r,n,s,i){var o,a;if(typeof i>"u"||i===null){if(!("sha1"in L.md))throw new Error('"sha1" hash algorithm unavailable.');i=L.md.sha1.create()}var f=i.digestLength,u=i.blockLength,c=new L.util.ByteBuffer,h=new L.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var l=h.length(),g=t.length(),p=new L.util.ByteBuffer;p.fillWithByte(r,u);var d=u*Math.ceil(g/u),y=new L.util.ByteBuffer;for(a=0;a<d;a++)y.putByte(t.at(a%g));var m=u*Math.ceil(l/u),E=new L.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%l));var x=y;x.putBuffer(E);for(var C=Math.ceil(s/f),b=1;b<=C;b++){var w=new L.util.ByteBuffer;w.putBytes(p.bytes()),w.putBytes(x.bytes());for(var _=0;_<n;_++)i.start(),i.update(w.getBytes()),w=i.digest();var A=new L.util.ByteBuffer;for(a=0;a<u;a++)A.putByte(w.at(a%f));var F=Math.ceil(g/u)+Math.ceil(l/u),K=new L.util.ByteBuffer;for(o=0;o<F;o++){var q=new L.util.ByteBuffer(x.getBytes(u)),X=511;for(a=A.length()-1;a>=0;a--)X=X>>8,X+=A.at(a)+q.at(a),q.setAt(a,X&255);K.putBuffer(q)}x=K,c.putBuffer(w)}return c.truncate(c.length()-s),c};$.pbe.getCipher=function(e,t,r){switch(e){case $.oids.pkcs5PBES2:return $.pbe.getCipherForPBES2(e,t,r);case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case $.oids["pbewithSHAAnd40BitRC2-CBC"]:return $.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};$.pbe.getCipherForPBES2=function(e,t,r){var n={},s=[];if(!I.validate(t,Kg,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}if(e=I.derToOid(n.kdfOid),e!==$.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=e,i.supportedOids=["pkcs5PBKDF2"],i}if(e=I.derToOid(n.encOid),e!==$.oids["aes128-CBC"]&&e!==$.oids["aes192-CBC"]&&e!==$.oids["aes256-CBC"]&&e!==$.oids["des-EDE3-CBC"]&&e!==$.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var o=n.kdfSalt,a=L.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,u;switch($.oids[e]){case"aes128-CBC":f=16,u=L.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=L.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=L.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=L.des.createDecryptionCipher;break;case"desCBC":f=8,u=L.des.createDecryptionCipher;break}var c=Tf(n.prfOid),h=L.pkcs5.pbkdf2(r,o,a,f,c),l=n.encIv,g=u(h);return g.start(l),g};$.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},s=[];if(!I.validate(t,qg,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=L.util.createBuffer(n.salt),a=L.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,u,c;switch(e){case $.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,c=L.des.startDecrypting;break;case $.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,c=function(d,y){var m=L.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=e,i}var h=Tf(n.prfOid),l=$.pbe.generatePkcs12Key(r,o,1,a,f,h);h.start();var g=$.pbe.generatePkcs12Key(r,o,2,a,u,h);return c(l,g)};$.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in L.md))throw new Error('"md5" hash algorithm unavailable.');n=L.md.md5.create()}t===null&&(t="");for(var s=[Bf(n,e+t)],i=16,o=1;i<r;++o,i+=16)s.push(Bf(n,s[o-1]+e+t));return s.join("").substr(0,r)};function Bf(e,t){return e.start().update(t).digest().getBytes()}function Tf(e){var t;if(!e)t="hmacWithSHA1";else if(t=$.oids[I.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Af(t)}function Af(e){var t=L.md;switch(e){case"hmacWithSHA224":t=L.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Vg(e,t,r,n){var s=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&s.value.push(I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,L.util.hexToBytes(r.toString(16))),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer($.oids[n]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),s}});var d0=G((pw,p0)=>{var ge=ae();Er();_e();var Hn=p0.exports=ge.sha512=ge.sha512||{};ge.md.sha512=ge.md.algorithms.sha512=Hn;var h0=ge.sha384=ge.sha512.sha384=ge.sha512.sha384||{};h0.create=function(){return Hn.create("SHA-384")};ge.md.sha384=ge.md.algorithms.sha384=h0;ge.sha512.sha256=ge.sha512.sha256||{create:function(){return Hn.create("SHA-512/256")}};ge.md["sha512/256"]=ge.md.algorithms["sha512/256"]=ge.sha512.sha256;ge.sha512.sha224=ge.sha512.sha224||{create:function(){return Hn.create("SHA-512/224")}};ge.md["sha512/224"]=ge.md.algorithms["sha512/224"]=ge.sha512.sha224;Hn.create=function(e){if(l0||tm(),typeof e>"u"&&(e="SHA-512"),!(e in Rr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Rr[e],r=null,n=ge.util.createBuffer(),s=new Array(80),i=0;i<80;++i)s[i]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,u=0;u<f;++u)a.fullMessageLength.push(0);n=ge.util.createBuffer(),r=new Array(t.length);for(var u=0;u<t.length;++u)r[u]=t[u].slice(0);return a},a.start(),a.update=function(f,u){u==="utf8"&&(f=ge.util.encodeUtf8(f));var c=f.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=c[1],c[1]=c[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(f),f0(r,s,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=ge.util.createBuffer();f.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,c=u&a.blockLength-1;f.putBytes(ra.substr(0,a.blockLength-c));for(var h,l,g=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,g+=l,f.putInt32(g>>>0),g=h>>>0;f.putInt32(g);for(var d=new Array(r.length),p=0;p<r.length;++p)d[p]=r[p].slice(0);f0(d,s,f);var y=ge.util.createBuffer(),m;e==="SHA-512"?m=d.length:e==="SHA-384"?m=d.length-2:m=d.length-4;for(var p=0;p<m;++p)y.putInt32(d[p][0]),(p!==m-1||e!=="SHA-512/224")&&y.putInt32(d[p][1]);return y},a};var ra=null,l0=!1,na=null,Rr=null;function tm(){ra=String.fromCharCode(128),ra+=ge.util.fillString(String.fromCharCode(0),128),na=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Rr={},Rr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Rr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Rr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Rr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],l0=!0}function f0(e,t,r){for(var n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E,x,C,b,w,_,A,F,K,q,X,ce,Oe,P,M,D,k,B,O,V,W=r.length();W>=128;){for(P=0;P<16;++P)t[P][0]=r.getInt32()>>>0,t[P][1]=r.getInt32()>>>0;for(;P<80;++P)k=t[P-2],M=k[0],D=k[1],n=((M>>>19|D<<13)^(D>>>29|M<<3)^M>>>6)>>>0,s=((M<<13|D>>>19)^(D<<3|M>>>29)^(M<<26|D>>>6))>>>0,O=t[P-15],M=O[0],D=O[1],i=((M>>>1|D<<31)^(M>>>8|D<<24)^M>>>7)>>>0,o=((M<<31|D>>>1)^(M<<24|D>>>8)^(M<<25|D>>>7))>>>0,B=t[P-7],V=t[P-16],D=s+B[1]+o+V[1],t[P][0]=n+B[0]+i+V[0]+(D/4294967296>>>0)>>>0,t[P][1]=D>>>0;for(d=e[0][0],y=e[0][1],m=e[1][0],E=e[1][1],x=e[2][0],C=e[2][1],b=e[3][0],w=e[3][1],_=e[4][0],A=e[4][1],F=e[5][0],K=e[5][1],q=e[6][0],X=e[6][1],ce=e[7][0],Oe=e[7][1],P=0;P<80;++P)u=((_>>>14|A<<18)^(_>>>18|A<<14)^(A>>>9|_<<23))>>>0,c=((_<<18|A>>>14)^(_<<14|A>>>18)^(A<<23|_>>>9))>>>0,h=(q^_&(F^q))>>>0,l=(X^A&(K^X))>>>0,a=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,f=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,g=(d&m|x&(d^m))>>>0,p=(y&E|C&(y^E))>>>0,D=Oe+c+l+na[P][1]+t[P][1],n=ce+u+h+na[P][0]+t[P][0]+(D/4294967296>>>0)>>>0,s=D>>>0,D=f+p,i=a+g+(D/4294967296>>>0)>>>0,o=D>>>0,ce=q,Oe=X,q=F,X=K,F=_,K=A,D=w+s,_=b+n+(D/4294967296>>>0)>>>0,A=D>>>0,b=x,w=C,x=m,C=E,m=d,E=y,D=s+o,d=n+i+(D/4294967296>>>0)>>>0,y=D>>>0;D=e[0][1]+y,e[0][0]=e[0][0]+d+(D/4294967296>>>0)>>>0,e[0][1]=D>>>0,D=e[1][1]+E,e[1][0]=e[1][0]+m+(D/4294967296>>>0)>>>0,e[1][1]=D>>>0,D=e[2][1]+C,e[2][0]=e[2][0]+x+(D/4294967296>>>0)>>>0,e[2][1]=D>>>0,D=e[3][1]+w,e[3][0]=e[3][0]+b+(D/4294967296>>>0)>>>0,e[3][1]=D>>>0,D=e[4][1]+A,e[4][0]=e[4][0]+_+(D/4294967296>>>0)>>>0,e[4][1]=D>>>0,D=e[5][1]+K,e[5][0]=e[5][0]+F+(D/4294967296>>>0)>>>0,e[5][1]=D>>>0,D=e[6][1]+X,e[6][0]=e[6][0]+q+(D/4294967296>>>0)>>>0,e[6][1]=D>>>0,D=e[7][1]+Oe,e[7][0]=e[7][0]+ce+(D/4294967296>>>0)>>>0,e[7][1]=D>>>0,W-=128}}});var W0=G((HS,G0)=>{"use strict";function xe(e,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}xe.prototype.peekAt=function(t){var r=t;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};xe.prototype.get=function(t){return this.peekAt(t)};xe.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};xe.prototype.peekFront=function(){return this.peek()};xe.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(xe.prototype,"length",{get:function(){return this.size()}});xe.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};xe.prototype.unshift=function(t){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=t,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};xe.prototype.shift=function(){var t=this._head;if(t!==this._tail){var r=this._list[t];return this._list[t]=void 0,this._head=t+1&this._capacityMask,t<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};xe.prototype.push=function(t){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=t,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};xe.prototype.pop=function(){var t=this._tail;if(t!==this._head){var r=this._list.length;this._tail=t-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&t>1e4&&t<=r>>>2&&this._shrinkArray(),n}};xe.prototype.removeOne=function(t){var r=t;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),s=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(t<n/2){for(o=t;o>0;o--)this._list[r]=this._list[r=r-1+s&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+s&this._capacityMask}else{for(o=n-1-t;o>0;o--)this._list[r]=this._list[r=r+1+s&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+s&this._capacityMask}return i}}};xe.prototype.remove=function(t,r){var n=t,s,i=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return s=new Array(1),s[0]=this.removeOne(n),s;if(n===0&&n+r>=o)return s=this.toArray(),this.clear(),s;n+r>o&&(r=o-n);var f;for(s=new Array(r),f=0;f<r;f++)s[f]=this._list[this._head+n+f&this._capacityMask];if(n=this._head+n&this._capacityMask,t+r===o){for(this._tail=this._tail-r+a&this._capacityMask,f=r;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(t===0){for(this._head=this._head+r+a&this._capacityMask,f=r-1;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(n<o/2){for(this._head=this._head+t+r+a&this._capacityMask,f=t;f>0;f--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;i>0;)this._list[n=n-1+a&this._capacityMask]=void 0,i--;t<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,f=o-(r+t);f>0;f--)this.push(this._list[n++]);for(n=this._tail;i>0;)this._list[n=n+1+a&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),s}}};xe.prototype.splice=function(t,r){var n=t;if(n===(n|0)){var s=this.size();if(n<0&&(n+=s),!(n>s))if(arguments.length>2){var i,o,a,f=arguments.length,u=this._list.length,c=2;if(!s||n<s/2){for(o=new Array(n),i=0;i<n;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);f>c;)this.unshift(arguments[--f]);for(i=n;i>0;i--)this.unshift(o[i-1])}else{o=new Array(s-(n+r));var h=o.length;for(i=0;i<h;i++)o[i]=this._list[this._head+n+r+i&this._capacityMask];for(r===0?(a=[],n!=s&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);c<f;)this.push(arguments[c++]);for(i=0;i<h;i++)this.push(o[i])}return a}else return this.remove(n,r)}};xe.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};xe.prototype.isEmpty=function(){return this._head===this._tail};xe.prototype.toArray=function(){return this._copyArray(!1)};xe.prototype._fromArray=function(t){var r=t.length,n=this._nextPowerOf2(r);this._list=new Array(n),this._capacityMask=n-1,this._tail=r;for(var s=0;s<r;s++)this._list[s]=t[s]};xe.prototype._copyArray=function(t,r){var n=this._list,s=n.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),a=0,f;if(t||this._head>this._tail){for(f=this._head;f<s;f++)o[a++]=n[f];for(f=0;f<this._tail;f++)o[a++]=n[f]}else for(f=this._head;f<this._tail;f++)o[a++]=n[f];return o};xe.prototype._growArray=function(){if(this._head!=0){var t=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=t}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};xe.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};xe.prototype._nextPowerOf2=function(t){var r=Math.log(t)/Math.log(2),n=1<<r+1;return Math.max(n,4)};G0.exports=xe});var fh=G((x4,uh)=>{"use strict";function ch(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function Qm(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return ch(e,r)}catch{r.message=e.message,r.stack=e.stack;let s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(e)),ch(new s,r)}}uh.exports=Qm});var sb={};Re(sb,{GossipSub:()=>xi,gossipsub:()=>nb,multicodec:()=>rb});function ts(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}var rs=class{buffer;mask;top;btm;next;constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},Or=class{size;hwm;head;tail;constructor(t={}){this.hwm=t.splitLimit??16,this.head=new rs(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new rs(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};var Si=class extends Error{type;code;constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function kt(e={}){return Fh(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Fh(e,t){t=t??{};let r=t.onEnd,n=new Or,s,i,o,a=ts(),f=async()=>{try{return n.isEmpty()?o?{done:!0}:await new Promise((y,m)=>{i=E=>{i=null,n.push(E);try{y(e(n))}catch(x){m(x)}return s}}):e(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=ts()})}},u=y=>i!=null?i(y):(n.push(y),s),c=y=>(n=new Or,i!=null?i({error:y}):(n.push({error:y}),s)),h=y=>{if(o)return s;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:y})},l=y=>o?s:(o=!0,y!=null?c(y):u({done:!0})),g=()=>(n=new Or,l(),{done:!0}),p=y=>(l(y),{done:!0});if(s={[Symbol.asyncIterator](){return this},next:f,return:g,throw:p,push:h,end:l,get readableLength(){return n.size},onEmpty:async y=>{let m=y?.signal;if(m?.throwIfAborted(),n.isEmpty())return;let E,x;m!=null&&(E=new Promise((C,b)=>{x=()=>{b(new Si)},m.addEventListener("abort",x)}));try{await Promise.race([a.promise,E])}finally{x!=null&&m!=null&&m?.removeEventListener("abort",x)}}},r==null)return s;let d=s;return s={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(y){return d.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return d.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(y){return d.end(y),r!=null&&(r(y),r=void 0),s},get readableLength(){return d.readableLength}},s}function Uh(e){return e[Symbol.asyncIterator]!=null}function Kh(...e){let t=[];for(let r of e)Uh(r)||t.push(r);return t.length===e.length?function*(){for(let r of t)yield*r}():async function*(){let r=kt({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async n=>{for await(let s of n)r.push(s)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var Oa=Kh;function Fr(e,...t){if(e==null)throw new Error("Empty pipeline");if(Ei(e)){let n=e;e=()=>n.source}else if(Ua(e)||Fa(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&Ei(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)Ei(r[n])&&(r[n]=Vh(r[n]));return qh(...r)}var qh=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Fa=e=>e?.[Symbol.asyncIterator]!=null,Ua=e=>e?.[Symbol.iterator]!=null,Ei=e=>e==null?!1:e.sink!=null&&e.source!=null,Vh=e=>t=>{let r=e.sink(t);if(r?.then!=null){let n=kt({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let s,i=e.source;if(Fa(i))s=async function*(){yield*i,n.end()};else if(Ua(i))s=function*(){yield*i,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Oa(n,s())}return e.source};var U=class extends Error{code;props;constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Ka=Symbol.for("@libp2p/peer-id");var Ti={};Re(Ti,{base58btc:()=>De,base58flickr:()=>$h});function zh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,f=e.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,d++;for(var x=(E-m)*c+1>>>0,C=new Uint8Array(x);m!==E;){for(var b=p[m],w=0,_=x-1;(b!==0||w<y)&&_!==-1;_--,w++)b+=256*C[_]>>>0,C[_]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=w,m++}for(var A=x-y;A!==x&&C[A]===0;)A++;for(var F=f.repeat(d);A<x;++A)F+=e.charAt(C[A]);return F}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===f;)y++,d++;for(var E=(p.length-d)*u+1>>>0,x=new Uint8Array(E);p[d];){var C=r[p.charCodeAt(d)];if(C===255)return;for(var b=0,w=E-1;(C!==0||b<m)&&w!==-1;w--,b++)C+=a*x[w]>>>0,x[w]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var _=E-m;_!==E&&x[_]===0;)_++;for(var A=new Uint8Array(y+(E-_)),F=y;_!==E;)A[F++]=x[_++];return A}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var Hh=zh,Gh=Hh,qa=Gh;var vb=new Uint8Array(0);var Va=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Mt=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var za=e=>new TextEncoder().encode(e),Ha=e=>new TextDecoder().decode(e);var Ii=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},_i=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Wa(this,t)}},Ci=class{constructor(t){this.decoders=t}or(t){return Wa(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Wa=(e,t)=>new Ci({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Bi=class{constructor(t,r,n,s){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Ii(t,r,n),this.decoder=new _i(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Ur=({name:e,prefix:t,encode:r,decode:n})=>new Bi(e,t,r,n),Zt=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:s}=qa(r,t);return Ur({prefix:e,name:t,encode:n,decode:i=>Mt(s(i))})},Wh=(e,t,r,n)=>{let s={};for(let c=0;c<t.length;++c)s[t[c]]=c;let i=e.length;for(;e[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,f=0,u=0;for(let c=0;c<i;++c){let h=s[e[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,o[u++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},jh=(e,t,r)=>{let n=t[t.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Se=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ur({prefix:t,name:e,encode(s){return jh(s,n,r)},decode(s){return Wh(s,n,r,e)}});var De=Zt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$h=Zt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ai={};Re(Ai,{base10:()=>Yh});var Yh=Zt({prefix:"9",name:"base10",alphabet:"0123456789"});var Pi={};Re(Pi,{base16:()=>Zh,base16upper:()=>Qh});var Zh=Se({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Qh=Se({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ri={};Re(Ri,{base2:()=>Xh});var Xh=Se({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Di={};Re(Di,{base256emoji:()=>nl});var ja=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Jh=ja.reduce((e,t,r)=>(e[r]=t,e),[]),el=ja.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function tl(e){return e.reduce((t,r)=>(t+=Jh[r],t),"")}function rl(e){let t=[];for(let r of e){let n=el[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var nl=Ur({prefix:"\u{1F680}",name:"base256emoji",encode:tl,decode:rl});var ki={};Re(ki,{base32:()=>Nt,base32hex:()=>al,base32hexpad:()=>ul,base32hexpadupper:()=>fl,base32hexupper:()=>cl,base32pad:()=>il,base32padupper:()=>ol,base32upper:()=>sl,base32z:()=>hl});var Nt=Se({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sl=Se({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),il=Se({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ol=Se({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),al=Se({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),cl=Se({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ul=Se({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fl=Se({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hl=Se({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Mi={};Re(Mi,{base36:()=>ll,base36upper:()=>pl});var ll=Zt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pl=Zt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ni={};Re(Ni,{base64:()=>Kr,base64pad:()=>dl,base64url:()=>gl,base64urlpad:()=>yl});var Kr=Se({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dl=Se({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gl=Se({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yl=Se({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Li={};Re(Li,{base8:()=>ml});var ml=Se({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Oi={};Re(Oi,{identity:()=>bl});var bl=Ur({prefix:"\0",name:"identity",encode:e=>Ha(e),decode:e=>za(e)});var Mb=new TextEncoder,Nb=new TextDecoder;var Ui={};Re(Ui,{identity:()=>Gr});var wl=Za,$a=128,Sl=127,El=~Sl,Il=Math.pow(2,31);function Za(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Il;)t[r++]=e&255|$a,e/=128;for(;e&El;)t[r++]=e&255|$a,e>>>=7;return t[r]=e|0,Za.bytes=r-n+1,t}var _l=Fi,Cl=128,Ya=127;function Fi(e,n){var r=0,n=n||0,s=0,i=n,o,a=e.length;do{if(i>=a)throw Fi.bytes=0,new RangeError("Could not decode varint");o=e[i++],r+=s<28?(o&Ya)<<s:(o&Ya)*Math.pow(2,s),s+=7}while(o>=Cl);return Fi.bytes=i-n,r}var Bl=Math.pow(2,7),Tl=Math.pow(2,14),Al=Math.pow(2,21),Pl=Math.pow(2,28),Rl=Math.pow(2,35),Dl=Math.pow(2,42),kl=Math.pow(2,49),Ml=Math.pow(2,56),Nl=Math.pow(2,63),Ll=function(e){return e<Bl?1:e<Tl?2:e<Al?3:e<Pl?4:e<Rl?5:e<Dl?6:e<kl?7:e<Ml?8:e<Nl?9:10},Ol={encode:wl,decode:_l,encodingLength:Ll},Fl=Ol,Sn=Fl;var En=(e,t=0)=>[Sn.decode(e,t),Sn.decode.bytes],qr=(e,t,r=0)=>(Sn.encode(e,t,r),t),Vr=e=>Sn.encodingLength(e);var Qt=(e,t)=>{let r=t.byteLength,n=Vr(e),s=n+Vr(r),i=new Uint8Array(s+r);return qr(e,i,0),qr(r,i,n),i.set(t,s),new zr(e,r,t,i)},Hr=e=>{let t=Mt(e),[r,n]=En(t),[s,i]=En(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new zr(r,s,o,t)},Qa=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Va(e.bytes,r.bytes)}},zr=class{constructor(t,r,n,s){this.code=t,this.size=r,this.digest=n,this.bytes=s}};var Xa=0,Ul="identity",Ja=Mt,Kl=e=>Qt(Xa,Ja(e)),Gr={code:Xa,name:Ul,encode:Ja,digest:Kl};var Vi={};Re(Vi,{sha256:()=>Te,sha512:()=>ql});var qi=({name:e,code:t,encode:r})=>new Ki(e,t,r),Ki=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Qt(this.code,r):r.then(n=>Qt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var tc=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Te=qi({name:"sha2-256",code:18,encode:tc("SHA-256")}),ql=qi({name:"sha2-512",code:19,encode:tc("SHA-512")});var rc=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return zl(r,zi(e),t||De.encoder);default:return Hl(r,zi(e),t||Nt.encoder)}};var nc=new WeakMap,zi=e=>{let t=nc.get(e);if(t==null){let r=new Map;return nc.set(e,r),r}return t},Xt=class e{constructor(t,r,n,s){this.code=r,this.version=t,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==In)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Gl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Qt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&Qa(t.multihash,n.multihash)}toString(t){return rc(this,t)}toJSON(){return{"/":rc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:s,multihash:i,bytes:o}=r;return new e(n,s,i,o||sc(n,s,i.bytes))}else if(r[Wl]===!0){let{version:n,multihash:s,code:i}=r,o=Hr(s);return e.create(n,i,o)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==In)throw new Error(`Version 0 CID must use dag-pb (code: ${In}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let s=sc(t,r,n.bytes);return new e(t,r,n,s)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,In,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,s=Mt(t.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new zr(r.multihashCode,r.digestSize,i,s);return[r.version===0?e.createV0(o):e.createV1(r.codec,o),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=En(t.subarray(r));return r+=l,h},s=n(),i=In;if(s===18?(s=0,r=0):i=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),f=n(),u=r+f,c=u-o;return{version:s,codec:i,multihashCode:a,digestSize:f,multihashSize:c,size:u}}static parse(t,r){let[n,s]=Vl(t,r),i=e.decode(s);if(i.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return zi(i).set(n,t),i}},Vl=(e,t)=>{switch(e[0]){case"Q":{let r=t||De;return[De.prefix,r.decode(`${De.prefix}${e}`)]}case De.prefix:{let r=t||De;return[De.prefix,r.decode(e)]}case Nt.prefix:{let r=t||Nt;return[Nt.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},zl=(e,t,r)=>{let{prefix:n}=r;if(n!==De.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=t.get(n);if(s==null){let i=r.encode(e).slice(1);return t.set(n,i),i}else return s},Hl=(e,t,r)=>{let{prefix:n}=r,s=t.get(n);if(s==null){let i=r.encode(e);return t.set(n,i),i}else return s},In=112,Gl=18,sc=(e,t,r)=>{let n=Vr(e),s=n+Vr(t),i=new Uint8Array(s+r.byteLength);return qr(e,i,0),qr(t,i,n),i.set(r,s),i},Wl=Symbol.for("@ipld/js-cid/CID");var Jt={...Oi,...Ri,...Li,...Ai,...Pi,...ki,...Mi,...Ti,...Ni,...Di},Qb={...Vi,...Ui};function Ke(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var jl=Symbol.for("nodejs.util.inspect.custom"),ic=Object.values(Jt).map(e=>e.decoder).reduce((e,t)=>e.or(t),Jt.identity.decoder),oc=114,ac=36,cc=37,_n=class{type;multihash;privateKey;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Ka]=!0;toString(){return this.string==null&&(this.string=De.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Xt.createV1(oc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Ke(this.multihash.bytes,t);if(typeof t=="string")return Lt(t).equals(this);if(t?.multihash?.bytes!=null)return Ke(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[jl](){return`PeerId(${this.toString()})`}},Cn=class extends _n{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Bn=class extends _n{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.multihash.digest}},Tn=class extends _n{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.multihash.digest}};function Lt(e,t){if(t=t??ic,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Hr(De.decode(`z${e}`));return e.startsWith("12D")?new Bn({multihash:r}):e.startsWith("16U")?new Tn({multihash:r}):new Cn({multihash:r})}return Wr(ic.decode(e))}function Wr(e){try{let t=Hr(e);if(t.code===Gr.code){if(t.digest.length===ac)return new Bn({multihash:t});if(t.digest.length===cc)return new Tn({multihash:t})}if(t.code===Te.code)return new Cn({multihash:t})}catch{return $l(Xt.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function $l(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==oc)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Te.code)return new Cn({multihash:e.multihash});if(t.code===Gr.code){if(t.digest.length===ac)return new Bn({multihash:e.multihash});if(t.digest.length===cc)return new Tn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}var nt=he(pc(),1);nt.default.formatters.b=e=>e==null?"undefined":De.baseEncode(e);nt.default.formatters.t=e=>e==null?"undefined":Nt.baseEncode(e);nt.default.formatters.m=e=>e==null?"undefined":Kr.baseEncode(e);nt.default.formatters.p=e=>e==null?"undefined":e.toString();nt.default.formatters.c=e=>e==null?"undefined":e.toString();nt.default.formatters.k=e=>e==null?"undefined":e.toString();nt.default.formatters.a=e=>e==null?"undefined":e.toString();function ap(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function os(e){let t=ap(`${e}:trace`);return nt.default.enabled(`${e}:trace`)&&nt.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=(0,nt.default)(`${e}:trace`)),Object.assign((0,nt.default)(e),{error:(0,nt.default)(`${e}:error`),trace:t})}var as=class extends EventTarget{#e=new Map;listenerCount(t){let r=this.#e.get(t);return r==null?0:r.length}addEventListener(t,r,n){super.addEventListener(t,r,n);let s=this.#e.get(t);s==null&&(s=[],this.#e.set(t,s)),s.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(t,r,n){super.removeEventListener(t.toString(),r??null,n);let s=this.#e.get(t);s!=null&&(s=s.filter(({callback:i})=>i!==r),this.#e.set(t,s))}dispatchEvent(t){let r=super.dispatchEvent(t),n=this.#e.get(t.type);return n==null||(n=n.filter(({once:s})=>!s),this.#e.set(t.type,n)),r}safeDispatchEvent(t,r){return this.dispatchEvent(new er(t,r))}},Hi=class extends Event{detail;constructor(t,r){super(t,r),this.detail=r?.detail}},er=globalThis.CustomEvent??Hi;var cs=class{gossip;msgs=new Map;msgIdToStrFn;history=[];notValidatedCount=0;constructor(t,r,n){this.gossip=t,this.msgIdToStrFn=n;for(let s=0;s<r;s++)this.history[s]=[]}get size(){return this.msgs.size}put(t,r,n=!1){let{msgIdStr:s}=t;return this.msgs.has(s)?!1:(this.msgs.set(s,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...t,topic:r.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(t,r){let n=this.msgs.get(t);n&&!n.validated&&n.originatingPeers.add(r)}get(t){return this.msgs.get(this.msgIdToStrFn(t))?.message}getWithIWantCount(t,r){let n=this.msgs.get(t);if(!n)return null;let s=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,s),{msg:n.message,count:s}}getGossipIDs(t){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(s=>{let i=this.msgs.get(s.msgIdStr);if(i&&i.validated&&t.has(s.topic)){let o=r.get(s.topic);o||(o=[],r.set(s.topic,o)),o.push(s.msgId)}});return r}validate(t){let r=this.msgs.get(t);if(!r)return null;r.validated||this.notValidatedCount--;let{message:n,originatingPeers:s}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:s}}shift(){this.history[this.history.length-1].forEach(r=>{let n=this.msgs.get(r.msgIdStr);n&&(this.msgs.delete(r.msgIdStr),n.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(t){let r=this.msgs.get(t);return r?(this.msgs.delete(t),r):null}};var fu=he(uu(),1),{RPC:kn}=fu.default;var io="/floodsub/1.0.0",oo="/meshsub/1.0.0",gs="/meshsub/1.1.0";var hu="ERR_TOPIC_VALIDATOR_REJECT",lu="ERR_TOPIC_VALIDATOR_IGNORE";function St(e){if(e.length<=1)return e;let t=()=>Math.floor(Math.random()*Math.floor(e.length));for(let r=0;r<e.length;r++){let n=t(),s=e[r];e[r]=e[n],e[n]=s}return e}function wr(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ft(e=0){return globalThis.Buffer?.alloc!=null?wr(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function ct(e=0){return globalThis.Buffer?.allocUnsafe!=null?wr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function du(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var pu=du("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ao=du("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=ct(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),bp={utf8:pu,"utf-8":pu,hex:Jt.base16,latin1:ao,ascii:ao,binary:ao,...Jt},ys=bp;function le(e,t="utf8"){let r=ys[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function gu(e){return le(e,"base64")}var mS=he(On(),1),bS=he(Rf(),1);var Bm=he(ae(),1);function Ae(e,t="utf8"){let r=ys[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wr(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var ta={};Re(ta,{Ed25519PrivateKey:()=>Pr,Ed25519PublicKey:()=>zn,generateKeyPair:()=>Xy,generateKeyPairFromSeed:()=>o0,unmarshalEd25519PrivateKey:()=>Zy,unmarshalEd25519PublicKey:()=>Qy});function Df(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ro(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function kf(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Df(e.outputLen),Df(e.blockLen)}function tn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Mf(e,t){Ro(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Ls=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Nf=e=>e instanceof Uint8Array;var Os=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),mt=(e,t)=>e<<32-t|e>>>t,zg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!zg)throw new Error("Non little-endian hardware is not supported");function Do(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Kn(e){if(typeof e=="string"&&(e=Do(e)),!Nf(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Fs(...e){let t=new Uint8Array(e.reduce((n,s)=>n+s.length,0)),r=0;return e.forEach(n=>{if(!Nf(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var rn=class{clone(){return this._cloneInto()}},Iv={}.toString;function Us(e){let t=n=>e().update(Kn(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function nn(e=32){if(Ls&&typeof Ls.getRandomValues=="function")return Ls.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Hg(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),f=n?4:0,u=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+u,a,n)}var sn=class extends rn{constructor(t,r,n,s){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Os(this.buffer)}update(t){tn(this);let{view:r,buffer:n,blockLen:s}=this;t=Kn(t);let i=t.length;for(let o=0;o<i;){let a=Math.min(s-this.pos,i-o);if(a===s){let f=Os(t);for(;s<=i-o;o+=s)this.process(f,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){tn(this),Mf(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:s,isLE:i}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)r[h]=0;Hg(n,s-8,BigInt(this.length*8),i),this.process(n,0);let a=Os(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=f/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,c[h],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%r&&t.buffer.set(n),t}};var Ks=BigInt(4294967295),ko=BigInt(32);function Lf(e,t=!1){return t?{h:Number(e&Ks),l:Number(e>>ko&Ks)}:{h:Number(e>>ko&Ks)|0,l:Number(e&Ks)|0}}function Gg(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:i,l:o}=Lf(e[s],t);[r[s],n[s]]=[i,o]}return[r,n]}var Wg=(e,t)=>BigInt(e>>>0)<<ko|BigInt(t>>>0),jg=(e,t,r)=>e>>>r,$g=(e,t,r)=>e<<32-r|t>>>r,Yg=(e,t,r)=>e>>>r|t<<32-r,Zg=(e,t,r)=>e<<32-r|t>>>r,Qg=(e,t,r)=>e<<64-r|t>>>r-32,Xg=(e,t,r)=>e>>>r-32|t<<64-r,Jg=(e,t)=>t,ey=(e,t)=>e,ty=(e,t,r)=>e<<r|t>>>32-r,ry=(e,t,r)=>t<<r|e>>>32-r,ny=(e,t,r)=>t<<r-32|e>>>64-r,sy=(e,t,r)=>e<<r-32|t>>>64-r;function iy(e,t,r,n){let s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}var oy=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),ay=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,cy=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),uy=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,fy=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),hy=(e,t,r,n,s,i)=>t+r+n+s+i+(e/2**32|0)|0;var ly={fromBig:Lf,split:Gg,toBig:Wg,shrSH:jg,shrSL:$g,rotrSH:Yg,rotrSL:Zg,rotrBH:Qg,rotrBL:Xg,rotr32H:Jg,rotr32L:ey,rotlSH:ty,rotlSL:ry,rotlBH:ny,rotlBL:sy,add:iy,add3L:oy,add3H:ay,add4L:cy,add4H:uy,add5H:hy,add5L:fy},Y=ly;var[py,dy]=(()=>Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ar=new Uint32Array(80),cr=new Uint32Array(80),Mo=class extends sn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:f,Eh:u,El:c,Fh:h,Fl:l,Gh:g,Gl:p,Hh:d,Hl:y}=this;return[t,r,n,s,i,o,a,f,u,c,h,l,g,p,d,y]}set(t,r,n,s,i,o,a,f,u,c,h,l,g,p,d,y){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=u|0,this.El=c|0,this.Fh=h|0,this.Fl=l|0,this.Gh=g|0,this.Gl=p|0,this.Hh=d|0,this.Hl=y|0}process(t,r){for(let x=0;x<16;x++,r+=4)ar[x]=t.getUint32(r),cr[x]=t.getUint32(r+=4);for(let x=16;x<80;x++){let C=ar[x-15]|0,b=cr[x-15]|0,w=Y.rotrSH(C,b,1)^Y.rotrSH(C,b,8)^Y.shrSH(C,b,7),_=Y.rotrSL(C,b,1)^Y.rotrSL(C,b,8)^Y.shrSL(C,b,7),A=ar[x-2]|0,F=cr[x-2]|0,K=Y.rotrSH(A,F,19)^Y.rotrBH(A,F,61)^Y.shrSH(A,F,6),q=Y.rotrSL(A,F,19)^Y.rotrBL(A,F,61)^Y.shrSL(A,F,6),X=Y.add4L(_,q,cr[x-7],cr[x-16]),ce=Y.add4H(X,w,K,ar[x-7],ar[x-16]);ar[x]=ce|0,cr[x]=X|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:f,Dh:u,Dl:c,Eh:h,El:l,Fh:g,Fl:p,Gh:d,Gl:y,Hh:m,Hl:E}=this;for(let x=0;x<80;x++){let C=Y.rotrSH(h,l,14)^Y.rotrSH(h,l,18)^Y.rotrBH(h,l,41),b=Y.rotrSL(h,l,14)^Y.rotrSL(h,l,18)^Y.rotrBL(h,l,41),w=h&g^~h&d,_=l&p^~l&y,A=Y.add5L(E,b,_,dy[x],cr[x]),F=Y.add5H(A,m,C,w,py[x],ar[x]),K=A|0,q=Y.rotrSH(n,s,28)^Y.rotrBH(n,s,34)^Y.rotrBH(n,s,39),X=Y.rotrSL(n,s,28)^Y.rotrBL(n,s,34)^Y.rotrBL(n,s,39),ce=n&i^n&a^i&a,Oe=s&o^s&f^o&f;m=d|0,E=y|0,d=g|0,y=p|0,g=h|0,p=l|0,{h,l}=Y.add(u|0,c|0,F|0,K|0),u=a|0,c=f|0,a=i|0,f=o|0,i=n|0,o=s|0;let P=Y.add3L(K,X,Oe);n=Y.add3H(P,F,q,ce),s=P|0}({h:n,l:s}=Y.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Y.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:f}=Y.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:u,l:c}=Y.add(this.Dh|0,this.Dl|0,u|0,c|0),{h,l}=Y.add(this.Eh|0,this.El|0,h|0,l|0),{h:g,l:p}=Y.add(this.Fh|0,this.Fl|0,g|0,p|0),{h:d,l:y}=Y.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,s,i,o,a,f,u,c,h,l,g,p,d,y,m,E)}roundClean(){ar.fill(0),cr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var No=Us(()=>new Mo);var zs={};Re(zs,{bitGet:()=>wy,bitLen:()=>xy,bitMask:()=>qn,bitSet:()=>Sy,bytesToHex:()=>Vt,bytesToNumberBE:()=>zt,bytesToNumberLE:()=>ur,concatBytes:()=>Ht,createHmacDrbg:()=>Fo,ensureBytes:()=>Ee,equalBytes:()=>by,hexToBytes:()=>Br,hexToNumber:()=>Oo,numberToBytesBE:()=>fr,numberToBytesLE:()=>Tr,numberToHexUnpadded:()=>Uf,numberToVarBytesBE:()=>my,utf8ToBytes:()=>vy,validateObject:()=>At});var Ff=BigInt(0),qs=BigInt(1),gy=BigInt(2),Vs=e=>e instanceof Uint8Array,yy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Vt(e){if(!Vs(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=yy[e[r]];return t}function Uf(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Oo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Br(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let s=n*2,i=e.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function zt(e){return Oo(Vt(e))}function ur(e){if(!Vs(e))throw new Error("Uint8Array expected");return Oo(Vt(Uint8Array.from(e).reverse()))}function fr(e,t){return Br(e.toString(16).padStart(t*2,"0"))}function Tr(e,t){return fr(e,t).reverse()}function my(e){return Br(Uf(e))}function Ee(e,t,r){let n;if(typeof t=="string")try{n=Br(t)}catch(i){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${i}`)}else if(Vs(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${e} expected ${r} bytes, got ${s}`);return n}function Ht(...e){let t=new Uint8Array(e.reduce((n,s)=>n+s.length,0)),r=0;return e.forEach(n=>{if(!Vs(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function by(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function vy(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function xy(e){let t;for(t=0;e>Ff;e>>=qs,t+=1);return t}function wy(e,t){return e>>BigInt(t)&qs}var Sy=(e,t,r)=>e|(r?qs:Ff)<<BigInt(t),qn=e=>(gy<<BigInt(e-1))-qs,Lo=e=>new Uint8Array(e),Of=e=>Uint8Array.from(e);function Fo(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Lo(e),s=Lo(e),i=0,o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>r(s,n,...h),f=(h=Lo())=>{s=a(Of([0]),h),n=a(),h.length!==0&&(s=a(Of([1]),h),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<t;){n=a();let g=n.slice();l.push(g),h+=n.length}return Ht(...l)};return(h,l)=>{o(),f(h);let g;for(;!(g=l(u()));)f();return o(),g}}var Ey={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function At(e,t,r={}){let n=(s,i,o)=>{let a=Ey[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);let f=e[s];if(!(o&&f===void 0)&&!a(f,e))throw new Error(`Invalid param ${String(s)}=${f} (${typeof f}), expected ${i}`)};for(let[s,i]of Object.entries(t))n(s,i,!1);for(let[s,i]of Object.entries(r))n(s,i,!0);return e}var Pe=BigInt(0),me=BigInt(1),Ar=BigInt(2),Iy=BigInt(3),Uo=BigInt(4),Kf=BigInt(5),qf=BigInt(8),_y=BigInt(9),Cy=BigInt(16);function ue(e,t){let r=e%t;return r>=Pe?r:t+r}function By(e,t,r){if(r<=Pe||t<Pe)throw new Error("Expected power/modulo > 0");if(r===me)return Pe;let n=me;for(;t>Pe;)t&me&&(n=n*e%r),e=e*e%r,t>>=me;return n}function be(e,t,r){let n=e;for(;t-- >Pe;)n*=n,n%=r;return n}function Hs(e,t){if(e===Pe||t<=Pe)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ue(e,t),n=t,s=Pe,i=me,o=me,a=Pe;for(;r!==Pe;){let u=n/r,c=n%r,h=s-o*u,l=i-a*u;n=r,r=c,s=o,i=a,o=h,a=l}if(n!==me)throw new Error("invert: does not exist");return ue(s,t)}function Ty(e){let t=(e-me)/Ar,r,n,s;for(r=e-me,n=0;r%Ar===Pe;r/=Ar,n++);for(s=Ar;s<e&&By(s,t,e)!==e-me;s++);if(n===1){let o=(e+me)/Uo;return function(f,u){let c=f.pow(u,o);if(!f.eql(f.sqr(c),u))throw new Error("Cannot find square root");return c}}let i=(r+me)/Ar;return function(a,f){if(a.pow(f,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,c=a.pow(a.mul(a.ONE,s),r),h=a.pow(f,i),l=a.pow(f,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let g=1;for(let d=a.sqr(l);g<u&&!a.eql(d,a.ONE);g++)d=a.sqr(d);let p=a.pow(c,me<<BigInt(u-g-1));c=a.sqr(p),h=a.mul(h,p),l=a.mul(l,c),u=g}return h}}function Ay(e){if(e%Uo===Iy){let t=(e+me)/Uo;return function(n,s){let i=n.pow(s,t);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(e%qf===Kf){let t=(e-Kf)/qf;return function(n,s){let i=n.mul(s,Ar),o=n.pow(i,t),a=n.mul(s,o),f=n.mul(n.mul(a,Ar),o),u=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(u),s))throw new Error("Cannot find square root");return u}}return e%Cy,Ty(e)}var Vf=(e,t)=>(ue(e,t)&me)===me,Py=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ko(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Py.reduce((n,s)=>(n[s]="function",n),t);return At(e,r)}function Ry(e,t,r){if(r<Pe)throw new Error("Expected power > 0");if(r===Pe)return e.ONE;if(r===me)return t;let n=e.ONE,s=t;for(;r>Pe;)r&me&&(n=e.mul(n,s)),s=e.sqr(s),r>>=me;return n}function Dy(e,t){let r=new Array(t.length),n=t.reduce((i,o,a)=>e.is0(o)?i:(r[a]=i,e.mul(i,o)),e.ONE),s=e.inv(n);return t.reduceRight((i,o,a)=>e.is0(o)?i:(r[a]=e.mul(i,r[a]),e.mul(i,o)),s),r}function qo(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Gs(e,t,r=!1,n={}){if(e<=Pe)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:s,nByteLength:i}=qo(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Ay(e),a=Object.freeze({ORDER:e,BITS:s,BYTES:i,MASK:qn(s),ZERO:Pe,ONE:me,create:f=>ue(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Pe<=f&&f<e},is0:f=>f===Pe,isOdd:f=>(f&me)===me,neg:f=>ue(-f,e),eql:(f,u)=>f===u,sqr:f=>ue(f*f,e),add:(f,u)=>ue(f+u,e),sub:(f,u)=>ue(f-u,e),mul:(f,u)=>ue(f*u,e),pow:(f,u)=>Ry(a,f,u),div:(f,u)=>ue(f*Hs(u,e),e),sqrN:f=>f*f,addN:(f,u)=>f+u,subN:(f,u)=>f-u,mulN:(f,u)=>f*u,inv:f=>Hs(f,e),sqrt:n.sqrt||(f=>o(a,f)),invertBatch:f=>Dy(a,f),cmov:(f,u,c)=>c?u:f,toBytes:f=>r?Tr(f,i):fr(f,i),fromBytes:f=>{if(f.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${f.length}`);return r?ur(f):zt(f)}});return Object.freeze(a)}function zf(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}function Hf(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Vo(e){let t=Hf(e);return t+Math.ceil(t/2)}function Gf(e,t,r=!1){let n=e.length,s=Hf(t),i=Vo(t);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);let o=r?zt(e):ur(e),a=ue(o,t-me)+me;return r?Tr(a,s):fr(a,s)}var My=BigInt(0),zo=BigInt(1);function Ws(e,t){let r=(s,i)=>{let o=i.negate();return s?o:i},n=s=>{let i=Math.ceil(t/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,i){let o=e.ZERO,a=s;for(;i>My;)i&zo&&(o=o.add(a)),a=a.double(),i>>=zo;return o},precomputeWindow(s,i){let{windows:o,windowSize:a}=n(i),f=[],u=s,c=u;for(let h=0;h<o;h++){c=u,f.push(c);for(let l=1;l<a;l++)c=c.add(u),f.push(c);u=c.double()}return f},wNAF(s,i,o){let{windows:a,windowSize:f}=n(s),u=e.ZERO,c=e.BASE,h=BigInt(2**s-1),l=2**s,g=BigInt(s);for(let p=0;p<a;p++){let d=p*f,y=Number(o&h);o>>=g,y>f&&(y-=l,o+=zo);let m=d,E=d+Math.abs(y)-1,x=p%2!==0,C=y<0;y===0?c=c.add(r(x,i[m])):u=u.add(r(C,i[E]))}return{p:u,f:c}},wNAFCached(s,i,o,a){let f=s._WINDOW_SIZE||1,u=i.get(s);return u||(u=this.precomputeWindow(s,f),f!==1&&i.set(s,a(u))),this.wNAF(f,u,o)}}}function Vn(e){return Ko(e.Fp),At(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...qo(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var bt=BigInt(0),st=BigInt(1),js=BigInt(2),Ny=BigInt(8),Ly={zip215:!0};function Oy(e){let t=Vn(e);return At(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function $s(e){let t=Oy(e),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:f}=t,u=js<<BigInt(a*8)-st,c=r.create,h=t.uvRatio||((k,B)=>{try{return{isValid:!0,value:r.sqrt(k*r.inv(B))}}catch{return{isValid:!1,value:bt}}}),l=t.adjustScalarBytes||(k=>k),g=t.domain||((k,B,O)=>{if(B.length||O)throw new Error("Contexts/pre-hash are not supported");return k}),p=k=>typeof k=="bigint"&&bt<k,d=(k,B)=>p(k)&&p(B)&&k<B,y=k=>k===bt||d(k,u);function m(k,B){if(d(k,B))return k;throw new Error(`Expected valid scalar < ${B}, got ${typeof k} ${k}`)}function E(k){return k===bt?k:m(k,n)}let x=new Map;function C(k){if(!(k instanceof b))throw new Error("ExtendedPoint expected")}class b{constructor(B,O,V,W){if(this.ex=B,this.ey=O,this.ez=V,this.et=W,!y(B))throw new Error("x required");if(!y(O))throw new Error("y required");if(!y(V))throw new Error("z required");if(!y(W))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(B){if(B instanceof b)throw new Error("extended point not allowed");let{x:O,y:V}=B||{};if(!y(O)||!y(V))throw new Error("invalid affine point");return new b(O,V,st,c(O*V))}static normalizeZ(B){let O=r.invertBatch(B.map(V=>V.ez));return B.map((V,W)=>V.toAffine(O[W])).map(b.fromAffine)}_setWindowSize(B){this._WINDOW_SIZE=B,x.delete(this)}assertValidity(){let{a:B,d:O}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:V,ey:W,ez:Z,et:J}=this,oe=c(V*V),ee=c(W*W),se=c(Z*Z),Ce=c(se*se),we=c(oe*B),Fe=c(se*c(we+ee)),Ue=c(Ce+c(O*c(oe*ee)));if(Fe!==Ue)throw new Error("bad point: equation left != right (1)");let Be=c(V*W),qe=c(Z*J);if(Be!==qe)throw new Error("bad point: equation left != right (2)")}equals(B){C(B);let{ex:O,ey:V,ez:W}=this,{ex:Z,ey:J,ez:oe}=B,ee=c(O*oe),se=c(Z*W),Ce=c(V*oe),we=c(J*W);return ee===se&&Ce===we}is0(){return this.equals(b.ZERO)}negate(){return new b(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:B}=t,{ex:O,ey:V,ez:W}=this,Z=c(O*O),J=c(V*V),oe=c(js*c(W*W)),ee=c(B*Z),se=O+V,Ce=c(c(se*se)-Z-J),we=ee+J,Fe=we-oe,Ue=ee-J,Be=c(Ce*Fe),qe=c(we*Ue),Dt=c(Ce*Ue),yr=c(Fe*we);return new b(Be,qe,yr,Dt)}add(B){C(B);let{a:O,d:V}=t,{ex:W,ey:Z,ez:J,et:oe}=this,{ex:ee,ey:se,ez:Ce,et:we}=B;if(O===BigInt(-1)){let Ta=c((Z-W)*(se+ee)),Aa=c((Z+W)*(se-ee)),wi=c(Aa-Ta);if(wi===bt)return this.double();let Pa=c(J*js*we),Ra=c(oe*js*Ce),Da=Ra+Pa,ka=Aa+Ta,Ma=Ra-Pa,Th=c(Da*wi),Ah=c(ka*Ma),Ph=c(Da*Ma),Rh=c(wi*ka);return new b(Th,Ah,Rh,Ph)}let Fe=c(W*ee),Ue=c(Z*se),Be=c(oe*V*we),qe=c(J*Ce),Dt=c((W+Z)*(ee+se)-Fe-Ue),yr=qe-Be,wn=qe+Be,Ba=c(Ue-O*Fe),Ih=c(Dt*yr),_h=c(wn*Ba),Ch=c(Dt*Ba),Bh=c(yr*wn);return new b(Ih,_h,Bh,Ch)}subtract(B){return this.add(B.negate())}wNAF(B){return A.wNAFCached(this,x,B,b.normalizeZ)}multiply(B){let{p:O,f:V}=this.wNAF(m(B,n));return b.normalizeZ([O,V])[0]}multiplyUnsafe(B){let O=E(B);return O===bt?_:this.equals(_)||O===st?this:this.equals(w)?this.wNAF(O).p:A.unsafeLadder(this,O)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(B){let{ex:O,ey:V,ez:W}=this,Z=this.is0();B==null&&(B=Z?Ny:r.inv(W));let J=c(O*B),oe=c(V*B),ee=c(W*B);if(Z)return{x:bt,y:st};if(ee!==st)throw new Error("invZ was invalid");return{x:J,y:oe}}clearCofactor(){let{h:B}=t;return B===st?this:this.multiplyUnsafe(B)}static fromHex(B,O=!1){let{d:V,a:W}=t,Z=r.BYTES;B=Ee("pointHex",B,Z);let J=B.slice(),oe=B[Z-1];J[Z-1]=oe&-129;let ee=ur(J);ee===bt||(O?m(ee,u):m(ee,r.ORDER));let se=c(ee*ee),Ce=c(se-st),we=c(V*se-W),{isValid:Fe,value:Ue}=h(Ce,we);if(!Fe)throw new Error("Point.fromHex: invalid y coordinate");let Be=(Ue&st)===st,qe=(oe&128)!==0;if(!O&&Ue===bt&&qe)throw new Error("Point.fromHex: x=0 and x_0=1");return qe!==Be&&(Ue=c(-Ue)),b.fromAffine({x:Ue,y:ee})}static fromPrivateKey(B){return q(B).point}toRawBytes(){let{x:B,y:O}=this.toAffine(),V=Tr(O,r.BYTES);return V[V.length-1]|=B&st?128:0,V}toHex(){return Vt(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,st,c(t.Gx*t.Gy)),b.ZERO=new b(bt,st,st,bt);let{BASE:w,ZERO:_}=b,A=Ws(b,a*8);function F(k){return ue(k,n)}function K(k){return F(ur(k))}function q(k){let B=a;k=Ee("private key",k,B);let O=Ee("hashed private key",i(k),2*B),V=l(O.slice(0,B)),W=O.slice(B,2*B),Z=K(V),J=w.multiply(Z),oe=J.toRawBytes();return{head:V,prefix:W,scalar:Z,point:J,pointBytes:oe}}function X(k){return q(k).pointBytes}function ce(k=new Uint8Array,...B){let O=Ht(...B);return K(i(g(O,Ee("context",k),!!s)))}function Oe(k,B,O={}){k=Ee("message",k),s&&(k=s(k));let{prefix:V,scalar:W,pointBytes:Z}=q(B),J=ce(O.context,V,k),oe=w.multiply(J).toRawBytes(),ee=ce(O.context,oe,Z,k),se=F(J+ee*W);E(se);let Ce=Ht(oe,Tr(se,r.BYTES));return Ee("result",Ce,a*2)}let P=Ly;function M(k,B,O,V=P){let{context:W,zip215:Z}=V,J=r.BYTES;k=Ee("signature",k,2*J),B=Ee("message",B),s&&(B=s(B));let oe=ur(k.slice(J,2*J)),ee,se,Ce;try{ee=b.fromHex(O,Z),se=b.fromHex(k.slice(0,J),Z),Ce=w.multiplyUnsafe(oe)}catch{return!1}if(!Z&&ee.isSmallOrder())return!1;let we=ce(W,se.toRawBytes(),ee.toRawBytes(),B);return se.add(ee.multiplyUnsafe(we)).subtract(Ce).clearCofactor().equals(b.ZERO)}return w._setWindowSize(8),{CURVE:t,getPublicKey:X,sign:Oe,verify:M,ExtendedPoint:b,utils:{getExtendedPublicKey:q,randomPrivateKey:()=>o(r.BYTES),precompute(k=8,B=b.BASE){return B._setWindowSize(k),B.multiply(BigInt(3)),B}}}}var Go=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Wf=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Wv=BigInt(0),Fy=BigInt(1),Ho=BigInt(2),Uy=BigInt(5),jf=BigInt(10),Ky=BigInt(20),qy=BigInt(40),$f=BigInt(80);function Vy(e){let t=Go,n=e*e%t*e%t,s=be(n,Ho,t)*n%t,i=be(s,Fy,t)*e%t,o=be(i,Uy,t)*i%t,a=be(o,jf,t)*o%t,f=be(a,Ky,t)*a%t,u=be(f,qy,t)*f%t,c=be(u,$f,t)*u%t,h=be(c,$f,t)*u%t,l=be(h,jf,t)*o%t;return{pow_p_5_8:be(l,Ho,t)*e%t,b2:n}}function zy(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Hy(e,t){let r=Go,n=ue(t*t*t,r),s=ue(n*n*t,r),i=Vy(e*s).pow_p_5_8,o=ue(e*n*i,r),a=ue(t*o*o,r),f=o,u=ue(o*Wf,r),c=a===e,h=a===ue(-e,r),l=a===ue(-e*Wf,r);return c&&(o=f),(h||l)&&(o=u),Vf(o,r)&&(o=ue(-o,r)),{isValid:c||h,value:o}}var Gt=Gs(Go,void 0,!0),Wo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Gt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:No,randomBytes:nn,adjustScalarBytes:zy,uvRatio:Hy},on=$s(Wo);function Yf(e,t,r){if(t.length>255)throw new Error("Context is too big");return Fs(Do("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}var jv=$s({...Wo,domain:Yf}),$v=$s({...Wo,domain:Yf,prehash:No});var Gy=(Gt.ORDER+BigInt(3))/BigInt(8),Yv=Gt.pow(Ho,Gy),Zv=Gt.sqrt(Gt.neg(Gt.ONE)),Qv=(Gt.ORDER-BigInt(5))/BigInt(8),Xv=BigInt(486662);var Jv=zf(Gt,Gt.neg(BigInt(486664)));var ex=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),tx=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),rx=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),nx=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var sx=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var an=32,Wt=64,Ys=32;async function Zf(){let e=on.utils.randomPrivateKey(),t=on.getPublicKey(e);return{privateKey:e0(e,t),publicKey:t}}async function Qf(e){if(e.length!==Ys)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=on.getPublicKey(t);return{privateKey:e0(t,r),publicKey:r}}async function Xf(e,t){let r=e.subarray(0,Ys);return on.sign(t,r)}async function Jf(e,t,r){return on.verify(t,r,e)}function e0(e,t){let r=new Uint8Array(Wt);for(let n=0;n<Ys;n++)r[n]=e[n],r[Ys+n]=t[n];return r}function et(e,t){t==null&&(t=e.reduce((s,i)=>s+i.length,0));let r=ct(t),n=0;for(let s of e)r.set(s,n),n+=s.length;return wr(r)}var tt={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var jo={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function $o(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,s=e?.digest??"SHA-256",i=e?.saltLength??16,o=e?.iterations??32767,a=tt.get();r*=8;async function f(h,l){let g=a.getRandomValues(new Uint8Array(i)),p=a.getRandomValues(new Uint8Array(n)),d={name:t,iv:p};typeof l=="string"&&(l=Ae(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",jo,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},x=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,x,{name:t,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",jo,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},x=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,x,{name:t,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(d,y,h);return et([g,d.iv,new Uint8Array(m)])}async function u(h,l){let g=h.subarray(0,i),p=h.subarray(i,i+n),d=h.subarray(i+n),y={name:t,iv:p};typeof l=="string"&&(l=Ae(l));let m;if(l.length===0)try{let x={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(x,C,{name:t,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",jo,{name:"AES-GCM"},!0,["decrypt"])}else{let x={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(x,C,{name:t,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,d);return new Uint8Array(E)}return{encrypt:f,decrypt:u}}async function cn(e,t){let n=await $o().encrypt(e,t);return Kr.encode(n)}var Yo=he(ds(),1),r0=he(ro(),1),n0=he(Ot(),1),Zo=he(ls(),1),s0=he(Ji(),1);function jy(){n0.default._configure(),Yo.default._configure(r0.default),Zo.default._configure(s0.default)}jy();var i0=["uint64","int64","sint64","fixed64","sfixed64"];function $y(e){for(let t of i0){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Qo(e){return $y(new Yo.default(e))}function Yy(e){for(let t of i0){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function Xo(){return Yy(Zo.default.create())}function Zs(e,t){let r=Qo(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Qs(e,t){let r=Xo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var un;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(un||(un={}));function Xs(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Jo(e){function t(s){if(e[s.toString()]==null)throw new Error("Invalid enum value");return e[s]}let r=function(i,o){let a=t(i);o.int32(a)},n=function(i){let o=i.int32();return t(o)};return Xs("enum",un.VARINT,r,n)}function Js(e,t){return Xs("message",un.LENGTH_DELIMITED,e,t)}var ve;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(ve||(ve={}));var ea;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(ea||(ea={}));(function(e){e.codec=()=>Jo(ea)})(ve||(ve={}));var Pt;(function(e){let t;e.codec=()=>(t==null&&(t=Js((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ve.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=ve.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}return s})),t),e.encode=r=>Qs(r,e.codec()),e.decode=r=>Zs(r,e.codec())})(Pt||(Pt={}));var Rt;(function(e){let t;e.codec=()=>(t==null&&(t=Js((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ve.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=ve.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}return s})),t),e.encode=r=>Qs(r,e.codec()),e.decode=r=>Zs(r,e.codec())})(Rt||(Rt={}));var zn=class{_key;constructor(t){this._key=fn(t,an)}async verify(t,r){return Jf(this._key,r,t)}marshal(){return this._key}get bytes(){return Pt.encode({Type:ve.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}},Pr=class{_key;_publicKey;constructor(t,r){this._key=fn(t,Wt),this._publicKey=fn(r,an)}async sign(t){return Xf(this._key,t)}get public(){return new zn(this._publicKey)}marshal(){return this._key}get bytes(){return Rt.encode({Type:ve.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}async id(){let t=Gr.digest(this.public.bytes);return De.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return cn(this.bytes,t);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Zy(e){if(e.length>Wt){e=fn(e,Wt+an);let n=e.subarray(0,Wt),s=e.subarray(Wt,e.length);return new Pr(n,s)}e=fn(e,Wt);let t=e.subarray(0,Wt),r=e.subarray(an);return new Pr(t,r)}function Qy(e){return e=fn(e,an),new zn(e)}async function Xy(){let{privateKey:e,publicKey:t}=await Zf();return new Pr(e,t)}async function o0(e){let{privateKey:t,publicKey:r}=await Qf(e);return new Pr(t,r)}function fn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new U(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var Ux=he(_e(),1),Kx=he(Ds(),1),a0=he(ae(),1);function vt(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=et([new Uint8Array(t-r.length),r])}return le(r,"base64url")}function it(e){let t=c0(e);return new a0.default.jsbn.BigInteger(le(t,"base16"),16)}function c0(e,t){let r=Ae(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=et([new Uint8Array(t-r.length),r])}return r}var Jy={"P-256":256,"P-384":384,"P-521":521},em=Object.keys(Jy),Qx=em.join(" / ");var oa={};Re(oa,{MAX_KEY_SIZE:()=>jn,RsaPrivateKey:()=>hn,RsaPublicKey:()=>Wn,fromJwk:()=>fm,generateKeyPair:()=>hm,unmarshalRsaPrivateKey:()=>cm,unmarshalRsaPublicKey:()=>um});var Gn=he(ae(),1);var Nw=he(d0(),1);function hr(e){if(isNaN(e)||e<=0)throw new U("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return nn(e)}var mw=he(Ns(),1),sa=he(ae(),1);function g0(e,t){return t.map(r=>it(e[r]))}function y0(e){return sa.default.pki.setRsaPrivateKey(...g0(e,["n","e","d","p","q","dp","dq","qi"]))}function m0(e){return sa.default.pki.setRsaPublicKey(...g0(e,["n","e"]))}var Dr={};Re(Dr,{jwkToPkcs1:()=>nm,jwkToPkix:()=>im,pkcs1ToJwk:()=>rm,pkixToJwk:()=>sm});var xw=he(On(),1),ww=he(Ns(),1);var jt=he(ae(),1);function rm(e){let t=jt.default.asn1.fromDer(le(e,"ascii")),r=jt.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:vt(r.n),e:vt(r.e),d:vt(r.d),p:vt(r.p),q:vt(r.q),dp:vt(r.dP),dq:vt(r.dQ),qi:vt(r.qInv),alg:"RS256"}}function nm(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let t=jt.default.pki.privateKeyToAsn1({n:it(e.n),e:it(e.e),d:it(e.d),p:it(e.p),q:it(e.q),dP:it(e.dp),dQ:it(e.dq),qInv:it(e.qi)});return Ae(jt.default.asn1.toDer(t).getBytes(),"ascii")}function sm(e){let t=jt.default.asn1.fromDer(le(e,"ascii")),r=jt.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:vt(r.n),e:vt(r.e)}}function im(e){if(e.n==null||e.e==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let t=jt.default.pki.publicKeyToAsn1({n:it(e.n),e:it(e.e)});return Ae(jt.default.asn1.toDer(t).getBytes(),"ascii")}async function b0(e){let t=await tt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await w0(t);return{privateKey:r[0],publicKey:r[1]}}async function ia(e){let r=[await tt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await om(e)],n=await w0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function v0(e,t){let r=await tt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await tt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function x0(e,t,r){let n=await tt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return tt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function w0(e){if(e.privateKey==null||e.publicKey==null)throw new U("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([tt.get().subtle.exportKey("jwk",e.privateKey),tt.get().subtle.exportKey("jwk",e.publicKey)])}async function om(e){return tt.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function S0(e,t,r,n){let s=t?m0(e):y0(e),i=le(Uint8Array.from(r),"ascii"),o=n(i,s);return Ae(o,"ascii")}function E0(e,t){return S0(e,!0,t,(r,n)=>n.encrypt(r))}function I0(e,t){return S0(e,!1,t,(r,n)=>n.decrypt(r))}function ti(e){if(e.kty!=="RSA")throw new U("invalid key type","ERR_INVALID_KEY_TYPE");if(e.n==null)throw new U("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Ae(e.n,"base64url").length*8}var jn=8192,Wn=class{_key;constructor(t){this._key=t}async verify(t,r){return x0(this._key,r,t)}marshal(){return Dr.jwkToPkix(this._key)}get bytes(){return Pt.encode({Type:ve.RSA,Data:this.marshal()}).subarray()}encrypt(t){return E0(this._key,t)}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}},hn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return hr(16)}async sign(t){return v0(this._key,t)}get public(){if(this._publicKey==null)throw new U("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Wn(this._publicKey)}decrypt(t){return I0(this._key,t)}marshal(){return Dr.jwkToPkcs1(this._key)}get bytes(){return Rt.encode({Type:ve.RSA,Data:this.marshal()}).subarray()}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}async id(){let t=await this.public.hash();return le(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Gn.default.util.ByteBuffer(this.marshal()),s=Gn.default.asn1.fromDer(n),i=Gn.default.pki.privateKeyFromAsn1(s),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Gn.default.pki.encryptRsaPrivateKey(i,t,o)}else{if(r==="libp2p-key")return cn(this.bytes,t);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function cm(e){let t=Dr.pkcs1ToJwk(e);if(ti(t)>jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await ia(t);return new hn(r.privateKey,r.publicKey)}function um(e){let t=Dr.pkixToJwk(e);if(ti(t)>jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Wn(t)}async function fm(e){if(ti(e)>jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await ia(e);return new hn(t.privateKey,t.publicKey)}async function hm(e){if(e>jn)throw new U("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await b0(e);return new hn(t.privateKey,t.publicKey)}var la={};Re(la,{Secp256k1PrivateKey:()=>Yn,Secp256k1PublicKey:()=>$n,generateKeyPair:()=>Cm,unmarshalSecp256k1PrivateKey:()=>Im,unmarshalSecp256k1PublicKey:()=>_m});var lm=(e,t,r)=>e&t^~e&r,pm=(e,t,r)=>e&t^e&r^t&r,dm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),lr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pr=new Uint32Array(64),aa=class extends sn{constructor(){super(64,32,8,!1),this.A=lr[0]|0,this.B=lr[1]|0,this.C=lr[2]|0,this.D=lr[3]|0,this.E=lr[4]|0,this.F=lr[5]|0,this.G=lr[6]|0,this.H=lr[7]|0}get(){let{A:t,B:r,C:n,D:s,E:i,F:o,G:a,H:f}=this;return[t,r,n,s,i,o,a,f]}set(t,r,n,s,i,o,a,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,r){for(let h=0;h<16;h++,r+=4)pr[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let l=pr[h-15],g=pr[h-2],p=mt(l,7)^mt(l,18)^l>>>3,d=mt(g,17)^mt(g,19)^g>>>10;pr[h]=d+pr[h-7]+p+pr[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:f,G:u,H:c}=this;for(let h=0;h<64;h++){let l=mt(a,6)^mt(a,11)^mt(a,25),g=c+l+lm(a,f,u)+dm[h]+pr[h]|0,d=(mt(n,2)^mt(n,13)^mt(n,22))+pm(n,s,i)|0;c=u,u=f,f=a,a=o+g|0,o=i,i=s,s=n,n=g+d|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,f,u,c)}roundClean(){pr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var _0=Us(()=>new aa);function gm(e){let t=Vn(e);At(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:s}=t;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:ym,hexToBytes:mm}=zs,kr={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=kr;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:ym(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=kr,r=typeof e=="string"?mm(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:s,l:i}=kr._parseInt(r.subarray(2)),{d:o,l:a}=kr._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let c=u.toString(16);return c.length&1?`0${c}`:c},n=t(r(e.s)),s=t(r(e.r)),i=n.length/2,o=s.length/2,a=r(i),f=r(o);return`30${r(o+i+4)}02${f}${s}02${a}${n}`}},$t=BigInt(0),ht=BigInt(1),Hw=BigInt(2),C0=BigInt(3),Gw=BigInt(4);function bm(e){let t=gm(e),{Fp:r}=t,n=t.toBytes||((p,d,y)=>{let m=d.toAffine();return Ht(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),s=t.fromBytes||(p=>{let d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),m=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function i(p){let{a:d,b:y}=t,m=r.sqr(p),E=r.mul(m,p);return r.add(r.add(E,r.mul(p,d)),y)}if(!r.eql(r.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&$t<p&&p<t.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(p){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:m,n:E}=t;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Vt(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let x;try{x=typeof p=="bigint"?p:zt(Ee("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return m&&(x=ue(x,E)),a(x),x}let u=new Map;function c(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,m){if(this.px=d,this.py=y,this.pz=m,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(d){let{x:y,y:m}=d||{};if(!d||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let E=x=>r.eql(x,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(m=>m.pz));return d.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(s(Ee("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=i(d);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){c(d);let{px:y,py:m,pz:E}=this,{px:x,py:C,pz:b}=d,w=r.eql(r.mul(y,b),r.mul(x,E)),_=r.eql(r.mul(m,b),r.mul(C,E));return w&&_}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=t,m=r.mul(y,C0),{px:E,py:x,pz:C}=this,b=r.ZERO,w=r.ZERO,_=r.ZERO,A=r.mul(E,E),F=r.mul(x,x),K=r.mul(C,C),q=r.mul(E,x);return q=r.add(q,q),_=r.mul(E,C),_=r.add(_,_),b=r.mul(d,_),w=r.mul(m,K),w=r.add(b,w),b=r.sub(F,w),w=r.add(F,w),w=r.mul(b,w),b=r.mul(q,b),_=r.mul(m,_),K=r.mul(d,K),q=r.sub(A,K),q=r.mul(d,q),q=r.add(q,_),_=r.add(A,A),A=r.add(_,A),A=r.add(A,K),A=r.mul(A,q),w=r.add(w,A),K=r.mul(x,C),K=r.add(K,K),A=r.mul(K,q),b=r.sub(b,A),_=r.mul(K,F),_=r.add(_,_),_=r.add(_,_),new h(b,w,_)}add(d){c(d);let{px:y,py:m,pz:E}=this,{px:x,py:C,pz:b}=d,w=r.ZERO,_=r.ZERO,A=r.ZERO,F=t.a,K=r.mul(t.b,C0),q=r.mul(y,x),X=r.mul(m,C),ce=r.mul(E,b),Oe=r.add(y,m),P=r.add(x,C);Oe=r.mul(Oe,P),P=r.add(q,X),Oe=r.sub(Oe,P),P=r.add(y,E);let M=r.add(x,b);return P=r.mul(P,M),M=r.add(q,ce),P=r.sub(P,M),M=r.add(m,E),w=r.add(C,b),M=r.mul(M,w),w=r.add(X,ce),M=r.sub(M,w),A=r.mul(F,P),w=r.mul(K,ce),A=r.add(w,A),w=r.sub(X,A),A=r.add(X,A),_=r.mul(w,A),X=r.add(q,q),X=r.add(X,q),ce=r.mul(F,ce),P=r.mul(K,P),X=r.add(X,ce),ce=r.sub(q,ce),ce=r.mul(F,ce),P=r.add(P,ce),q=r.mul(X,P),_=r.add(_,q),q=r.mul(M,P),w=r.mul(Oe,w),w=r.sub(w,q),q=r.mul(Oe,X),A=r.mul(M,A),A=r.add(A,q),new h(w,_,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return g.wNAFCached(this,u,d,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,x)=>E.toAffine(m[x])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===$t)return y;if(a(d),d===ht)return this;let{endo:m}=t;if(!m)return g.unsafeLadder(this,d);let{k1neg:E,k1:x,k2neg:C,k2:b}=m.splitScalar(d),w=y,_=y,A=this;for(;x>$t||b>$t;)x&ht&&(w=w.add(A)),b&ht&&(_=_.add(A)),A=A.double(),x>>=ht,b>>=ht;return E&&(w=w.negate()),C&&(_=_.negate()),_=new h(r.mul(_.px,m.beta),_.py,_.pz),w.add(_)}multiply(d){a(d);let y=d,m,E,{endo:x}=t;if(x){let{k1neg:C,k1:b,k2neg:w,k2:_}=x.splitScalar(y),{p:A,f:F}=this.wNAF(b),{p:K,f:q}=this.wNAF(_);A=g.constTimeNegate(C,A),K=g.constTimeNegate(w,K),K=new h(r.mul(K.px,x.beta),K.py,K.pz),m=A.add(K),E=F.add(q)}else{let{p:C,f:b}=this.wNAF(y);m=C,E=b}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(d,y,m){let E=h.BASE,x=(b,w)=>w===$t||w===ht||!b.equals(E)?b.multiplyUnsafe(w):b.multiply(w),C=x(this,y).add(x(d,m));return C.is0()?void 0:C}toAffine(d){let{px:y,py:m,pz:E}=this,x=this.is0();d==null&&(d=x?r.ONE:r.inv(E));let C=r.mul(y,d),b=r.mul(m,d),w=r.mul(E,d);if(x)return{x:r.ZERO,y:r.ZERO};if(!r.eql(w,r.ONE))throw new Error("invZ was invalid");return{x:C,y:b}}isTorsionFree(){let{h:d,isTorsionFree:y}=t;if(d===ht)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=t;return d===ht?this:y?y(h,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return Vt(this.toRawBytes(d))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=t.nBitLength,g=Ws(h,t.endo?Math.ceil(l/2):l);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:i,isWithinCurveOrder:o}}function vm(e){let t=Vn(e);return At(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function B0(e){let t=vm(e),{Fp:r,n}=t,s=r.BYTES+1,i=2*r.BYTES+1;function o(P){return $t<P&&P<r.ORDER}function a(P){return ue(P,n)}function f(P){return Hs(P,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:l}=bm({...t,toBytes(P,M,D){let k=M.toAffine(),B=r.toBytes(k.x),O=Ht;return D?O(Uint8Array.from([M.hasEvenY()?2:3]),B):O(Uint8Array.from([4]),B,r.toBytes(k.y))},fromBytes(P){let M=P.length,D=P[0],k=P.subarray(1);if(M===s&&(D===2||D===3)){let B=zt(k);if(!o(B))throw new Error("Point is not on curve");let O=h(B),V=r.sqrt(O),W=(V&ht)===ht;return(D&1)===1!==W&&(V=r.neg(V)),{x:B,y:V}}else if(M===i&&D===4){let B=r.fromBytes(k.subarray(0,r.BYTES)),O=r.fromBytes(k.subarray(r.BYTES,2*r.BYTES));return{x:B,y:O}}else throw new Error(`Point of length ${M} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),g=P=>Vt(fr(P,t.nByteLength));function p(P){let M=n>>ht;return P>M}function d(P){return p(P)?a(-P):P}let y=(P,M,D)=>zt(P.slice(M,D));class m{constructor(M,D,k){this.r=M,this.s=D,this.recovery=k,this.assertValidity()}static fromCompact(M){let D=t.nByteLength;return M=Ee("compactSignature",M,D*2),new m(y(M,0,D),y(M,D,2*D))}static fromDER(M){let{r:D,s:k}=kr.toSig(Ee("DER",M));return new m(D,k)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new m(this.r,this.s,M)}recoverPublicKey(M){let{r:D,s:k,recovery:B}=this,O=_(Ee("msgHash",M));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");let V=B===2||B===3?D+t.n:D;if(V>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let W=B&1?"03":"02",Z=u.fromHex(W+g(V)),J=f(V),oe=a(-O*J),ee=a(k*J),se=u.BASE.multiplyAndAddUnsafe(Z,oe,ee);if(!se)throw new Error("point at infinify");return se.assertValidity(),se}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Br(this.toDERHex())}toDERHex(){return kr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Br(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let E={isValidPrivateKey(P){try{return c(P),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let P=Vo(t.n);return Gf(t.randomBytes(P),t.n)},precompute(P=8,M=u.BASE){return M._setWindowSize(P),M.multiply(BigInt(3)),M}};function x(P,M=!0){return u.fromPrivateKey(P).toRawBytes(M)}function C(P){let M=P instanceof Uint8Array,D=typeof P=="string",k=(M||D)&&P.length;return M?k===s||k===i:D?k===2*s||k===2*i:P instanceof u}function b(P,M,D=!0){if(C(P))throw new Error("first arg must be private key");if(!C(M))throw new Error("second arg must be public key");return u.fromHex(M).multiply(c(P)).toRawBytes(D)}let w=t.bits2int||function(P){let M=zt(P),D=P.length*8-t.nBitLength;return D>0?M>>BigInt(D):M},_=t.bits2int_modN||function(P){return a(w(P))},A=qn(t.nBitLength);function F(P){if(typeof P!="bigint")throw new Error("bigint expected");if(!($t<=P&&P<A))throw new Error(`bigint expected < 2^${t.nBitLength}`);return fr(P,t.nByteLength)}function K(P,M,D=q){if(["recovered","canonical"].some(we=>we in D))throw new Error("sign() legacy options not supported");let{hash:k,randomBytes:B}=t,{lowS:O,prehash:V,extraEntropy:W}=D;O==null&&(O=!0),P=Ee("msgHash",P),V&&(P=Ee("prehashed msgHash",k(P)));let Z=_(P),J=c(M),oe=[F(J),F(Z)];if(W!=null){let we=W===!0?B(r.BYTES):W;oe.push(Ee("extraEntropy",we))}let ee=Ht(...oe),se=Z;function Ce(we){let Fe=w(we);if(!l(Fe))return;let Ue=f(Fe),Be=u.BASE.multiply(Fe).toAffine(),qe=a(Be.x);if(qe===$t)return;let Dt=a(Ue*a(se+qe*J));if(Dt===$t)return;let yr=(Be.x===qe?0:2)|Number(Be.y&ht),wn=Dt;return O&&p(Dt)&&(wn=d(Dt),yr^=1),new m(qe,wn,yr)}return{seed:ee,k2sig:Ce}}let q={lowS:t.lowS,prehash:!1},X={lowS:t.lowS,prehash:!1};function ce(P,M,D=q){let{seed:k,k2sig:B}=K(P,M,D),O=t;return Fo(O.hash.outputLen,O.nByteLength,O.hmac)(k,B)}u.BASE._setWindowSize(8);function Oe(P,M,D,k=X){let B=P;if(M=Ee("msgHash",M),D=Ee("publicKey",D),"strict"in k)throw new Error("options.strict was renamed to lowS");let{lowS:O,prehash:V}=k,W,Z;try{if(typeof B=="string"||B instanceof Uint8Array)try{W=m.fromDER(B)}catch(Be){if(!(Be instanceof kr.Err))throw Be;W=m.fromCompact(B)}else if(typeof B=="object"&&typeof B.r=="bigint"&&typeof B.s=="bigint"){let{r:Be,s:qe}=B;W=new m(Be,qe)}else throw new Error("PARSE");Z=u.fromHex(D)}catch(Be){if(Be.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(O&&W.hasHighS())return!1;V&&(M=t.hash(M));let{r:J,s:oe}=W,ee=_(M),se=f(oe),Ce=a(ee*se),we=a(J*se),Fe=u.BASE.multiplyAndAddUnsafe(Z,Ce,we)?.toAffine();return Fe?a(Fe.x)===J:!1}return{CURVE:t,getPublicKey:x,getSharedSecret:b,sign:ce,verify:Oe,ProjectivePoint:u,Signature:m,utils:E}}var ri=class extends rn{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,kf(t);let n=Kn(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?t.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(t){return tn(this),this.iHash.update(t),this}digestInto(t){tn(this),Ro(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ca=(e,t,r)=>new ri(e,t).update(r).digest();ca.create=(e,t)=>new ri(e,t);function xm(e){return{hash:e,hmac:(t,...r)=>ca(e,t,Fs(...r)),randomBytes:nn}}function T0(e,t){let r=n=>B0({...e,...xm(n)});return Object.freeze({...r(t),create:r})}var R0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),A0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),wm=BigInt(1),ua=BigInt(2),P0=(e,t)=>(e+t/ua)/t;function Sm(e){let t=R0,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),u=e*e*e%t,c=u*u*e%t,h=be(c,r,t)*c%t,l=be(h,r,t)*c%t,g=be(l,ua,t)*u%t,p=be(g,s,t)*g%t,d=be(p,i,t)*p%t,y=be(d,a,t)*d%t,m=be(y,f,t)*y%t,E=be(m,a,t)*d%t,x=be(E,r,t)*c%t,C=be(x,o,t)*p%t,b=be(C,n,t)*u%t,w=be(b,ua,t);if(!fa.eql(fa.sqr(w),e))throw new Error("Cannot find square root");return w}var fa=Gs(R0,void 0,void 0,{sqrt:Sm}),Yt=T0({a:BigInt(0),b:BigInt(7),Fp:fa,n:A0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=A0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-wm*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=P0(i*e,t),f=P0(-n*e,t),u=ue(e-a*r-f*s,t),c=ue(-a*n-f*i,t),h=u>o,l=c>o;if(h&&(u=t-u),l&&(c=t-c),u>o||c>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:l,k2:c}}}},_0),nS=BigInt(0);var sS=Yt.ProjectivePoint;function D0(){return Yt.utils.randomPrivateKey()}async function k0(e,t){let{digest:r}=await Te.digest(t);try{return Yt.sign(r,e).toDERRawBytes()}catch(n){throw new U(String(n),"ERR_INVALID_INPUT")}}async function M0(e,t,r){try{let{digest:n}=await Te.digest(r);return Yt.verify(t,n,e)}catch(n){throw new U(String(n),"ERR_INVALID_INPUT")}}function N0(e){return Yt.ProjectivePoint.fromHex(e).toRawBytes(!0)}function L0(e){try{Yt.getPublicKey(e,!0)}catch(t){throw new U(String(t),"ERR_INVALID_PRIVATE_KEY")}}function ha(e){try{Yt.ProjectivePoint.fromHex(e)}catch(t){throw new U(String(t),"ERR_INVALID_PUBLIC_KEY")}}function O0(e){try{return Yt.getPublicKey(e,!0)}catch(t){throw new U(String(t),"ERR_INVALID_PRIVATE_KEY")}}var $n=class{_key;constructor(t){ha(t),this._key=t}async verify(t,r){return M0(this._key,r,t)}marshal(){return N0(this._key)}get bytes(){return Pt.encode({Type:ve.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}},Yn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r??O0(t),L0(this._key),ha(this._publicKey)}async sign(t){return k0(this._key,t)}get public(){return new $n(this._publicKey)}marshal(){return this._key}get bytes(){return Rt.encode({Type:ve.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Ke(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Te.digest(this.bytes);return t}async id(){let t=await this.public.hash();return le(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return cn(this.bytes,t);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Im(e){return new Yn(e)}function _m(e){return new $n(e)}async function Cm(){let e=D0();return new Yn(e)}var dr={rsa:oa,ed25519:ta,secp256k1:la};function pa(e){let t=Object.keys(dr).join(" / ");return new U(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Tm(e){if(e=e.toLowerCase(),e==="rsa"||e==="ed25519"||e==="secp256k1")return dr[e];throw pa(e)}function da(e){let t=Pt.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ve.RSA:return dr.rsa.unmarshalRsaPublicKey(r);case ve.Ed25519:return dr.ed25519.unmarshalEd25519PublicKey(r);case ve.Secp256k1:return dr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw pa(t.Type??"RSA")}}function F0(e,t){return t=(t??"rsa").toLowerCase(),Tm(t),e.bytes}async function U0(e){let t=Rt.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ve.RSA:return dr.rsa.unmarshalRsaPrivateKey(r);case ve.Ed25519:return dr.ed25519.unmarshalEd25519PrivateKey(r);case ve.Secp256k1:return dr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw pa(t.Type??"RSA")}}var Mr="StrictSign",ln="StrictNoSign",$e;(function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"})($e||($e={}));var K0;(function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"})(K0||(K0={}));var gr;(function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"})(gr||(gr={}));var Ye;(function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"})(Ye||(Ye={}));var Ve;(function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"})(Ve||(Ve={}));var ze;(function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"})(ze||(ze={}));function ga(e){switch(e){case $e.Ignore:return Ye.Ignore;case $e.Reject:return Ye.Reject}}async function ya(e,t){switch(e){case Mr:{if(!t)throw Error("Must provide PeerId");if(t.privateKey==null)throw Error("Cannot sign message, no private key present");if(t.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await U0(t.privateKey);return{type:gr.Signing,author:t,key:t.publicKey,privateKey:r}}case ln:return{type:gr.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}var fe="ERR_INVALID_PEER_SCORE_PARAMS";var Pm={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},Rm={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function q0(e={}){return{...Pm,...e,topics:e.topics?Object.entries(e.topics).reduce((t,[r,n])=>(t[r]=Dm(n),t),{}):{}}}function Dm(e={}){return{...Rm,...e}}function V0(e){for(let[t,r]of Object.entries(e.topics))try{km(r)}catch(n){throw new U(`invalid score parameters for topic ${t}: ${n.message}`,fe)}if(e.topicScoreCap<0)throw new U("invalid topic score cap; must be positive (or 0 for no cap)",fe);if(e.appSpecificScore===null||e.appSpecificScore===void 0)throw new U("missing application specific score function",fe);if(e.IPColocationFactorWeight>0)throw new U("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",fe);if(e.IPColocationFactorWeight!==0&&e.IPColocationFactorThreshold<1)throw new U("invalid IPColocationFactorThreshold; must be at least 1",fe);if(e.behaviourPenaltyWeight>0)throw new U("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",fe);if(e.behaviourPenaltyWeight!==0&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new U("invalid BehaviourPenaltyDecay; must be between 0 and 1",fe);if(e.decayInterval<1e3)throw new U("invalid DecayInterval; must be at least 1s",fe);if(e.decayToZero<=0||e.decayToZero>=1)throw new U("invalid DecayToZero; must be between 0 and 1",fe)}function km(e){if(e.topicWeight<0)throw new U("invalid topic weight; must be >= 0",fe);if(e.timeInMeshQuantum===0)throw new U("invalid TimeInMeshQuantum; must be non zero",fe);if(e.timeInMeshWeight<0)throw new U("invalid TimeInMeshWeight; must be positive (or 0 to disable)",fe);if(e.timeInMeshWeight!==0&&e.timeInMeshQuantum<=0)throw new U("invalid TimeInMeshQuantum; must be positive",fe);if(e.timeInMeshWeight!==0&&e.timeInMeshCap<=0)throw new U("invalid TimeInMeshCap; must be positive",fe);if(e.firstMessageDeliveriesWeight<0)throw new U("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",fe);if(e.firstMessageDeliveriesWeight!==0&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new U("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",fe);if(e.firstMessageDeliveriesWeight!==0&&e.firstMessageDeliveriesCap<=0)throw new U("invalid FirstMessageDeliveriesCap; must be positive",fe);if(e.meshMessageDeliveriesWeight>0)throw new U("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",fe);if(e.meshMessageDeliveriesWeight!==0&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new U("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",fe);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesCap<=0)throw new U("invalid MeshMessageDeliveriesCap; must be positive",fe);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesThreshold<=0)throw new U("invalid MeshMessageDeliveriesThreshold; must be positive",fe);if(e.meshMessageDeliveriesWindow<0)throw new U("invalid MeshMessageDeliveriesWindow; must be non-negative",fe);if(e.meshMessageDeliveriesWeight!==0&&e.meshMessageDeliveriesActivation<1e3)throw new U("invalid MeshMessageDeliveriesActivation; must be at least 1s",fe);if(e.meshFailurePenaltyWeight>0)throw new U("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",fe);if(e.meshFailurePenaltyWeight!==0&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new U("invalid MeshFailurePenaltyDecay; must be between 0 and 1",fe);if(e.invalidMessageDeliveriesWeight>0)throw new U("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",fe);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new U("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",fe)}var Mm={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function z0(e={}){return{...Mm,...e}}function H0(e,t,r,n){let s=0;Object.entries(t.topics).forEach(([o,a])=>{let f=r.topics[o];if(f===void 0)return;let u=0;if(a.inMesh){let g=a.meshTime/f.timeInMeshQuantum;g>f.timeInMeshCap&&(g=f.timeInMeshCap),u+=g*f.timeInMeshWeight}let c=a.firstMessageDeliveries;if(c>f.firstMessageDeliveriesCap&&(c=f.firstMessageDeliveriesCap),u+=c*f.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<f.meshMessageDeliveriesThreshold){let g=f.meshMessageDeliveriesThreshold-a.meshMessageDeliveries,p=g*g;u+=p*f.meshMessageDeliveriesWeight}let h=a.meshFailurePenalty;u+=h*f.meshFailurePenaltyWeight;let l=a.invalidMessageDeliveries*a.invalidMessageDeliveries;u+=l*f.invalidMessageDeliveriesWeight,s+=u*f.topicWeight}),r.topicScoreCap>0&&s>r.topicScoreCap&&(s=r.topicScoreCap);let i=r.appSpecificScore(e);if(s+=i*r.appSpecificWeight,t.knownIPs.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),f=a?a.size:0;if(f>r.IPColocationFactorThreshold){let u=f-r.IPColocationFactorThreshold,c=u*u;s+=c*r.IPColocationFactorWeight}}),t.behaviourPenalty>r.behaviourPenaltyThreshold){let o=t.behaviourPenalty-r.behaviourPenaltyThreshold,a=o*o;s+=a*r.behaviourPenaltyWeight}return s}var j0=he(W0(),1),Ze;(function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"})(Ze||(Ze={}));var ni=class{records;queue;constructor(){this.records=new Map,this.queue=new j0.default}getRecord(t){return this.records.get(t)}ensureRecord(t){let r=this.records.get(t);if(r)return r;r={status:Ze.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(t,r);let n={msgId:t,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let t=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<t;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};function ii(e,t,r=()=>!0){let n=new Set;if(t<=0)return n;for(let s of e){if(n.size>=t)break;r(s)&&(n.add(s),e.delete(s))}return n}function $0(e,t){return ii(e,t,()=>!0)}var si=class extends Map{getDefault;constructor(t){super(),this.getDefault=t}getOrDefault(t){let r=super.get(t);return r===void 0&&(r=this.getDefault(),this.set(t,r)),r}};var pn=os("libp2p:gossipsub:score"),oi=class{params;metrics;peerStats=new Map;peerIPs=new si(()=>new Set);scoreCache=new Map;deliveryRecords=new ni;_backgroundInterval;scoreCacheValidityMs;computeScore;constructor(t,r,n){this.params=t,this.metrics=r,V0(t),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??H0}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){pn("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),pn("started")}stop(){if(!this._backgroundInterval){pn("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),pn("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([t,r])=>[t,r]))}messageFirstSeenTimestampMs(t){let r=this.deliveryRecords.getRecord(t);return r?r.firstSeenTsMs:null}refreshScores(){let t=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,s)=>{if(!n.connected){t>n.expire&&(this.removeIPsForPeer(s,n.knownIPs),this.peerStats.delete(s),this.scoreCache.delete(s));return}Object.entries(n.topics).forEach(([i,o])=>{let a=this.params.topics[i];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=t-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(t){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(t);if(!r)return 0;let n=Date.now(),s=this.scoreCache.get(t);if(s&&s.cacheUntil>n)return s.score;this.metrics?.scoreFnRuns.inc();let i=this.computeScore(t,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return s?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-s.score)),s.score=i,s.cacheUntil=o):this.scoreCache.set(t,{score:i,cacheUntil:o}),i}addPenalty(t,r,n){let s=this.peerStats.get(t);s&&(s.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(t){let r={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(t,r)}addIP(t,r){let n=this.peerStats.get(t);n&&n.knownIPs.add(r),this.peerIPs.getOrDefault(r).add(t)}removeIP(t,r){let n=this.peerStats.get(t);n&&n.knownIPs.delete(r);let s=this.peerIPs.get(r);s&&(s.delete(t),s.size===0&&this.peerIPs.delete(r))}removePeer(t){let r=this.peerStats.get(t);if(r){if(this.score(t)>0){this.removeIPsForPeer(t,r.knownIPs),this.peerStats.delete(t);return}Object.entries(r.topics).forEach(([n,s])=>{s.firstMessageDeliveries=0;let i=this.params.topics[n].meshMessageDeliveriesThreshold;if(s.inMesh&&s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.inMesh=!1,s.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(t,r){let n=this.peerStats.get(t);if(n){let s=this.getPtopicStats(n,r);s&&(s.inMesh=!0,s.graftTime=Date.now(),s.meshTime=0,s.meshMessageDeliveriesActive=!1)}}prune(t,r){let n=this.peerStats.get(t);if(n){let s=this.getPtopicStats(n,r);if(s){let i=this.params.topics[r].meshMessageDeliveriesThreshold;if(s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.meshMessageDeliveriesActive=!1,s.inMesh=!1}}}validateMessage(t){this.deliveryRecords.ensureRecord(t)}deliverMessage(t,r,n){this.markFirstMessageDelivery(t,n);let s=this.deliveryRecords.ensureRecord(r),i=Date.now();if(s.status!==Ze.unknown){pn("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",t,i-s.firstSeenTsMs,Ze[s.status]);return}s.status=Ze.valid,s.validated=i,s.peers.forEach(o=>{o!==t.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(t,r){this.markInvalidMessageDelivery(t,r)}rejectMessage(t,r,n,s){switch(s){case Ye.Error:this.markInvalidMessageDelivery(t,n);return;case Ye.Blacklisted:return}let i=this.deliveryRecords.ensureRecord(r);if(i.status!==Ze.unknown){pn("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",t,Date.now()-i.firstSeenTsMs,Ze[i.status]);return}if(s===Ye.Ignore){i.status=Ze.ignored,i.peers.clear();return}i.status=Ze.invalid,this.markInvalidMessageDelivery(t,n),i.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),i.peers.clear()}duplicateMessage(t,r,n){let s=this.deliveryRecords.ensureRecord(r);if(!s.peers.has(t))switch(s.status){case Ze.unknown:s.peers.add(t);break;case Ze.valid:s.peers.add(t),this.markDuplicateMessageDelivery(t,n,s.validated);break;case Ze.invalid:this.markInvalidMessageDelivery(t,n);break;case Ze.ignored:break}}markInvalidMessageDelivery(t,r){let n=this.peerStats.get(t);if(n){let s=this.getPtopicStats(n,r);s&&(s.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(t,r){let n=this.peerStats.get(t);if(n){let s=this.getPtopicStats(n,r);if(s){let i=this.params.topics[r].firstMessageDeliveriesCap;s.firstMessageDeliveries=Math.min(i,s.firstMessageDeliveries+1),s.inMesh&&(i=this.params.topics[r].meshMessageDeliveriesCap,s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(t,r,n){let s=this.peerStats.get(t);if(s){let i=n!==void 0?Date.now():0,o=this.getPtopicStats(s,r);if(o&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let u=i-n,c=u>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,c),c)return}let f=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(f,o.meshMessageDeliveries+1)}}}removeIPsForPeer(t,r){for(let n of r){let s=this.peerIPs.get(n);s&&(s.delete(t),s.size===0&&this.peerIPs.delete(n))}}getPtopicStats(t,r){let n=t.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t.topics[r]=n,n):null}};var ai=class{gossipsubIWantFollowupMs;msgIdToStrFn;metrics;promises=new Map;requestMsByMsg=new Map;requestMsByMsgExpire;constructor(t,r,n){this.gossipsubIWantFollowupMs=t,this.msgIdToStrFn=r,this.metrics=n,this.requestMsByMsgExpire=10*t}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(t,r){let n=Math.floor(Math.random()*r.length),s=r[n],i=this.msgIdToStrFn(s),o=this.promises.get(i);o||(o=new Map,this.promises.set(i,o));let a=Date.now();o.has(t)||(o.set(t,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,a)))}getBrokenPromises(){let t=Date.now(),r=new Map,n=0;return this.promises.forEach((s,i)=>{s.forEach((o,a)=>{o<t&&(r.set(a,(r.get(a)??0)+1),s.delete(a),n++)}),s.size||this.promises.delete(i)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(t,r=!1){this.trackMessage(t);let n=this.promises.get(t);n&&(this.promises.delete(t),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),r&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(n.size)))}rejectMessage(t,r){switch(this.trackMessage(t),r){case Ye.Error:return}this.promises.delete(t)}clear(){this.promises.clear()}prune(){let t=Date.now()-this.requestMsByMsgExpire,r=0;for(let[n,s]of this.requestMsByMsg.entries())if(s<t)this.requestMsByMsg.delete(n),r++;else break;this.metrics?.iwantMessagePruned.inc(r)}trackMessage(t){if(this.metrics){let r=this.requestMsByMsg.get(t);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(t))}}};var dn=class{entries=new Map;validityMs;constructor(t){this.validityMs=t.validityMs}get size(){return this.entries.size}put(t,r){return this.entries.has(t)?!0:(this.entries.set(t,{value:r,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){let t=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<t)this.entries.delete(r);else break}has(t){return this.entries.has(t)}get(t){let r=this.entries.get(t);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var Y0;(function(e){e.forward="forward",e.publish="publish"})(Y0||(Y0={}));var Qe;(function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"})(Qe||(Qe={}));var xt;(function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Excess="excess"})(xt||(xt={}));var yn;(function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"})(yn||(yn={}));var mn;(function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"})(mn||(mn={}));var gn;(function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"})(gn||(gn={}));function Z0(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:e.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:e.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:e.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:e.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:e.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:e.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:e.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:e.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:e.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:e.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",labelNames:["topic"],buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:e.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:e.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:e.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:e.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:e.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:e.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:e.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:e.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:e.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:e.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:e.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:e.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:e.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:e.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:e.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:e.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),iwantPromiseUntracked:e.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:e.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,s,i){let o=this.toTopic(n);switch(s){case Qe.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:o},i);break;case Qe.Random:this.meshPeerInclusionEventsRandom.inc({topic:o},i);break;case Qe.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:o},i);break;case Qe.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:o},i);break;case Qe.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:o},i);break;case Qe.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:o},i);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:o},i);break}},onRemoveFromMesh(n,s,i){let o=this.toTopic(n);switch(s){case xt.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:o},i);break;case xt.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:o},i);break;case xt.Prune:this.meshPeerChurnEventsPrune.inc({topic:o},i);break;case xt.Excess:this.meshPeerChurnEventsExcess.inc({topic:o},i);break;default:this.meshPeerChurnEventsUnknown.inc({topic:o},i);break}},onReportValidation(n,s,i){if(this.asyncValidationMcacheHit.inc({hit:n!=null?"hit":"miss"}),n!=null){let o=this.toTopic(n.message.topic);switch(s){case $e.Accept:this.acceptedMessagesTotal.inc({topic:o});break;case $e.Ignore:this.ignoredMessagesTotal.inc({topic:o});break;case $e.Reject:this.rejectedMessagesTotal.inc({topic:o});break;default:this.unknownValidationResultsTotal.inc({topic:o});break}}i!=null?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-i)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,s,i){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},s),this.ihaveRcvNotSeenMsgids.inc({topic:o},i)},onIwantRcv(n,s){for(let[i,o]of n){let a=this.toTopic(i);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(s)},onForwardMsg(n,s){let i=this.toTopic(n);this.msgForwardCount.inc({topic:i},1),this.msgForwardPeers.inc({topic:i},s)},onPublishMsg(n,s,i,o,a){let f=this.toTopic(n);this.msgPublishCount.inc({topic:f},1),this.msgPublishBytes.inc({topic:f},i*o),this.msgPublishPeersByTopic.inc({topic:f},i),this.directPeersPublishedTotal.inc({topic:f},s.direct),this.floodsubPeersPublishedTotal.inc({topic:f},s.floodsub),this.meshPeersPublishedTotal.inc({topic:f},s.mesh),this.fanoutPeersPublishedTotal.inc({topic:f},s.fanout),this.msgPublishTime.observe({topic:f},a/1e3)},onMsgRecvPreValidation(n){let s=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:s},1)},onMsgRecvError(n){let s=this.toTopic(n);this.msgReceivedError.inc({topic:s},1)},onPrevalidationResult(n,s){let i=this.toTopic(n);switch(s){case ze.duplicate:this.prevalidationDuplicateTotal.inc({topic:i});break;case ze.invalid:this.prevalidationInvalidTotal.inc({topic:i});break;case ze.valid:this.prevalidationValidTotal.inc({topic:i});break;default:this.prevalidationUnknownTotal.inc({topic:i});break}},onMsgRecvInvalid(n,s){let i=this.toTopic(n),o=s.reason===Ye.Error?s.error:s.reason;this.msgReceivedInvalid.inc({error:o},1),this.msgReceivedInvalidByTopic.inc({topic:i},1)},onDuplicateMsgDelivery(n,s,i){if(this.duplicateMsgDeliveryDelay.observe(s/1e3),i){let o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onPublishDuplicateMsg(n){let s=this.toTopic(n);this.duplicateMsgIgnored.inc({topic:s},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(n,s){this.rpcRecvBytes.inc(s),this.rpcRecvCount.inc(1),n.subscriptions&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages&&this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),n.control.ihave&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,s){if(this.rpcSentBytes.inc(s),this.rpcSentCount.inc(1),n.subscriptions&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages&&this.rpcSentMessage.inc(n.messages.length),n.control){let i=n.control.ihave?.length??0,o=n.control.iwant?.length??0,a=n.control.graft?.length??0,f=n.control.prune?.length??0;i>0&&this.rpcSentIHave.inc(i),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),f>0&&this.rpcSentPrune.inc(f),(i>0||o>0||a>0||f>0)&&this.rpcSentControl.inc(1)}},registerScores(n,s){let i=0,o=0,a=0,f=0;for(let u of n)u>=s.graylistThreshold&&i++,u>=s.publishThreshold&&o++,u>=s.gossipThreshold&&a++,u>=0&&f++;this.peersByScoreThreshold.set({threshold:gn.graylist},i),this.peersByScoreThreshold.set({threshold:gn.publish},o),this.peersByScoreThreshold.set({threshold:gn.gossip},a),this.peersByScoreThreshold.set({threshold:gn.mesh},f),this.score.set(n)},registerScoreWeights(n){for(let[s,i]of n.byTopic)this.scoreWeights.set({topic:s,p:"p1"},i.p1w),this.scoreWeights.set({topic:s,p:"p2"},i.p2w),this.scoreWeights.set({topic:s,p:"p3"},i.p3w),this.scoreWeights.set({topic:s,p:"p3b"},i.p3bw),this.scoreWeights.set({topic:s,p:"p4"},i.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,s){let i=new Map;n.forEach((o,a)=>{let f=this.topicStrToLabel.get(a)??"unknown",u=i.get(f);u||(u=new Set,i.set(f,u)),o.forEach(c=>u?.add(c))});for(let[o,a]of i){let f=[];a.forEach(u=>{f.push(s.get(u)??0)}),this.scorePerMesh.set({topic:o},f)}}}}var dE=he(Es(),1),Lm=he(ae(),1);var Um=he(wo(),1),Km=he(_e(),1);var Q0=Ae("libp2p-pubsub:");async function X0(e,t,r,n){switch(e.type){case gr.Signing:{let s={from:e.author.toBytes(),data:n,seqno:hr(8),topic:t,signature:void 0,key:void 0},i=et([Q0,kn.Message.encode(s).finish()]);s.signature=await e.privateKey.sign(i),s.key=e.key;let o={type:"signed",from:e.author,data:r,sequenceNumber:BigInt(`0x${le(s.seqno,"base16")}`),topic:t,signature:s.signature,key:s.key};return{raw:s,msg:o}}case gr.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:t}}}}async function J0(e,t){switch(e){case ln:return t.signature!=null?{valid:!1,error:Ve.SignaturePresent}:t.seqno!=null?{valid:!1,error:Ve.SeqnoPresent}:t.key!=null?{valid:!1,error:Ve.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case Mr:{if(t.seqno==null)return{valid:!1,error:Ve.InvalidSeqno};if(t.seqno.length!==8)return{valid:!1,error:Ve.InvalidSeqno};if(t.signature==null)return{valid:!1,error:Ve.InvalidSignature};if(t.from==null)return{valid:!1,error:Ve.InvalidPeerId};let r;try{r=Wr(t.from)}catch{return{valid:!1,error:Ve.InvalidPeerId}}let n;if(t.key){if(n=da(t.key),r.publicKey!==void 0&&!Ke(n.bytes,r.publicKey))return{valid:!1,error:Ve.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:Ve.InvalidPeerId};n=da(r.publicKey)}let s={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},i=et([Q0,kn.Message.encode(s).finish()]);return await n.verify(i,t.signature)?{valid:!0,message:{type:"signed",from:r,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${le(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??F0(n)}}:{valid:!1,error:Ve.InvalidSignature}}}}var eh=(e,t)=>{let r=Ae(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n};function th(e){if(e.type!=="signed")throw new Error("expected signed message type");if(e.sequenceNumber==null)throw Error("missing seqno field");return eh(e.from.toBytes(),e.sequenceNumber)}async function rh(e){return await Te.encode(e.data)}function qm(e,t,r,n,s){let i=0,o=new Map;if(Object.entries(t.topics).forEach(([l,g])=>{let p=s.get(l)??"unknown",d=r.topics[l];if(d===void 0)return;let y=o.get(p);y||(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,y));let m=0,E=0,x=0,C=0,b=0;if(g.inMesh){let F=Math.max(g.meshTime/d.timeInMeshQuantum,d.timeInMeshCap);m+=F*d.timeInMeshWeight}let w=g.firstMessageDeliveries;if(w>d.firstMessageDeliveriesCap&&(w=d.firstMessageDeliveriesCap),E+=w*d.firstMessageDeliveriesWeight,g.meshMessageDeliveriesActive&&g.meshMessageDeliveries<d.meshMessageDeliveriesThreshold){let F=d.meshMessageDeliveriesThreshold-g.meshMessageDeliveries,K=F*F;x+=K*d.meshMessageDeliveriesWeight}let _=g.meshFailurePenalty;C+=_*d.meshFailurePenaltyWeight;let A=g.invalidMessageDeliveries*g.invalidMessageDeliveries;b+=A*d.invalidMessageDeliveriesWeight,i+=(m+E+x+C+b)*d.topicWeight,y.p1w+=m,y.p2w+=E,y.p3w+=x,y.p3bw+=C,y.p4w+=b}),r.topicScoreCap>0&&i>r.topicScoreCap){i=r.topicScoreCap;let l=r.topicScoreCap/i;for(let g of o.values())g.p1w*=l,g.p2w*=l,g.p3w*=l,g.p3bw*=l,g.p4w*=l}let a=0,f=0,u=0,c=r.appSpecificScore(e);a+=c*r.appSpecificWeight,t.knownIPs.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let g=n.get(l),p=g?g.size:0;if(p>r.IPColocationFactorThreshold){let d=p-r.IPColocationFactorThreshold,y=d*d;f+=y*r.IPColocationFactorWeight}});let h=t.behaviourPenalty*t.behaviourPenalty;return u+=h*r.behaviourPenaltyWeight,i+=a+f+u,{byTopic:o,p5w:a,p6w:f,p7w:u,score:i}}function nh(e,t,r,n,s){let i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of e){let a=t.get(o);if(a){let f=qm(o,a,r,n,s);for(let[u,c]of f.byTopic){let h=i.byTopic.get(u);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(u,h)),h.p1w.push(c.p1w),h.p2w.push(c.p2w),h.p3w.push(c.p3w),h.p3bw.push(c.p3bw),h.p4w.push(c.p4w)}i.p5w.push(f.p5w),i.p6w.push(f.p6w),i.p7w.push(f.p7w),i.score.push(f.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}var Zn=class extends Error{constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function sh(e){if(e!=null){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}function ma(e,t,r){let n=r??{},s=sh(e);async function*i(){let o,a=()=>{o?.()};for(t.addEventListener("abort",a);;){let f;try{if(t.aborted){let{abortMessage:c,abortCode:h}=n;throw new Zn(c,h)}let u=new Promise((c,h)=>{o=()=>{let{abortMessage:l,abortCode:g}=n;h(new Zn(l,g))}});f=await Promise.race([u,s.next()]),o=null}catch(u){t.removeEventListener("abort",a);let c=u.type==="aborted"&&t.aborted;if(c&&n.onAbort!=null&&n.onAbort(e),typeof s.return=="function")try{let h=s.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(c&&n.returnOnAbort===!0)return;throw u}if(f.done===!0)break;yield f.value}t.removeEventListener("abort",a)}return i()}var oh=Symbol.for("@achingbrain/uint8arraylist");function ih(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let s=r+n.byteLength;if(t<s)return{buf:n,index:t-r};r=s}throw new RangeError("index is out of bounds")}function ci(e){return!!e?.[oh]}var bn=class e{constructor(...t){Object.defineProperty(this,oh,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ci(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ci(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=ih(this.bufs,t);return r.buf[r.index]}set(t,r){let n=ih(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(ci(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:s}=this._subList(t,r);return et(n,s)}subarray(t,r){let{bufs:n,length:s}=this._subList(t,r);return n.length===1?n[0]:et(n,s)}sublist(t,r){let{bufs:n,length:s}=this._subList(t,r),i=new e;return i.length=s,i.bufs=n,i}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],s=0;for(let i=0;i<this.bufs.length;i++){let o=this.bufs[i],a=s,f=a+o.byteLength;if(s=f,t>=f)continue;let u=t>=a&&t<f,c=r>a&&r<=f;if(u&&c){if(t===a&&r===f){n.push(o);break}let h=t-a;n.push(o.subarray(h,h+(r-t)));break}if(u){if(t===0){n.push(o);continue}n.push(o.subarray(t-a));continue}if(c){if(r===f){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!ci(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let s=n.byteLength;if(s===0)throw new TypeError("search must be at least 1 byte long");let i=256,o=new Int32Array(i);for(let h=0;h<i;h++)o[h]=-1;for(let h=0;h<s;h++)o[n[h]]=h;let a=o,f=this.byteLength-n.byteLength,u=n.byteLength-1,c;for(let h=r;h<=f;h+=c){c=0;for(let l=u;l>=0;l--){let g=this.get(h+l);if(n[l]!==g){c=Math.max(1,l-a[g]);break}}if(c===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=ct(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let s=Ft(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt16(0,r,n),this.write(s,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt32(0,r,n),this.write(s,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigInt64(0,r,n),this.write(s,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=ct(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let s=Ft(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint16(0,r,n),this.write(s,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint32(0,r,n),this.write(s,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigUint64(0,r,n),this.write(s,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let s=Ft(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat32(0,r,n),this.write(s,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let s=Ft(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat64(0,r,n),this.write(s,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Ke(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((s,i)=>s+i.byteLength,0)),n.length=r,n}};function ui(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var ah=4294967296,Qn=class e{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new e(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new e(r,n)}toBytes(t,r=0){let n=ui(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new e;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,s=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,s=~s>>>0,++s>ah&&(s=0,++n>ah&&(n=0))),new e(n,s)}static fromNumber(t){if(t===0)return new e;let r=t<0;r&&(t=-t);let n=t>>>0,s=(t-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new e(s,n)}static fromBytes(t,r=0){let n=ui(t),s=new e,i=0;if(t.length-r>4){for(;i<4;++i)if(s.lo=(s.lo|(n.get(r)&127)<<i*7)>>>0,n.get(r++)<128)return s;if(s.lo=(s.lo|(n.get(r)&127)<<28)>>>0,s.hi=(s.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return s;i=0}else for(;i<4;++i){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(s.lo=(s.lo|(n.get(r)&127)<<i*7)>>>0,n.get(r++)<128)return s}if(t.length-r>4){for(;i<5;++i)if(s.hi=(s.hi|(n.get(r)&127)<<i*7+3)>>>0,n.get(r++)<128)return s}else if(r<t.byteLength)for(;i<5;++i){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(s.hi=(s.hi|(n.get(r)&127)<<i*7+3)>>>0,n.get(r++)<128)return s}throw RangeError("invalid varint encoding")}};var Vm=Math.pow(2,7),zm=Math.pow(2,14),Hm=Math.pow(2,21),Gm=Math.pow(2,28),Wm=Math.pow(2,35),jm=Math.pow(2,42),$m=Math.pow(2,49),Ym=Math.pow(2,56),Zm=Math.pow(2,63),Nr={encodingLength(e){return e<Vm?1:e<zm?2:e<Hm?3:e<Gm?4:e<Wm?5:e<jm?6:e<$m?7:e<Ym?8:e<Zm?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=ct(Nr.encodingLength(e))),Qn.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return Qn.fromBytes(e,t).toNumber(!0)}};function fi(e){return e[Symbol.asyncIterator]!=null}var hi=e=>{let t=Nr.encodingLength(e),r=ct(t);return Nr.encode(e,r),hi.bytes=t,r};hi.bytes=0;function li(e,t){t=t??{};let r=t.lengthEncoder??hi;function*n(s){let i=r(s.byteLength);i instanceof Uint8Array?yield i:yield*i,s instanceof Uint8Array?yield s:yield*s}return fi(e)?async function*(){for await(let s of e)yield*n(s)}():function*(){for(let s of e)yield*n(s)}()}li.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??hi;return new bn(r(e.byteLength),e)};var vn=he(fh(),1);var Xm=8,Jm=1024*1024*4,Lr;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(Lr||(Lr={}));var ba=e=>{let t=Nr.decode(e);return ba.bytes=Nr.encodingLength(t),t};ba.bytes=0;function Xn(e,t){let r=new bn,n=Lr.LENGTH,s=-1,i=t?.lengthDecoder??ba,o=t?.maxLengthLength??Xm,a=t?.maxDataLength??Jm;function*f(){for(;r.byteLength>0;){if(n===Lr.LENGTH)try{if(s=i(r),s<0)throw(0,vn.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>a)throw(0,vn.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=i.bytes;r.consume(u),t?.onLength!=null&&t.onLength(s),n=Lr.DATA}catch(u){if(u instanceof RangeError){if(r.byteLength>o)throw(0,vn.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===Lr.DATA){if(r.byteLength<s)break;let u=r.sublist(0,s);r.consume(s),t?.onData!=null&&t.onData(u),yield u,n=Lr.LENGTH}}}return fi(e)?async function*(){for await(let u of e)r.append(u),yield*f();if(r.byteLength>0)throw(0,vn.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of e)r.append(u),yield*f();if(r.byteLength>0)throw(0,vn.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Xn.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:i,value:o}=await e.next(r);if(i===!0)return;o!=null&&(yield o)}catch(i){if(i.code==="ERR_UNDER_READ")return{done:!0,value:null};throw i}finally{r=1}}();return Xn(n,{...t??{},onLength:i=>{r=i}})};var pi=class{rawStream;pushable;closeController;maxBufferSize;constructor(t,r,n){this.rawStream=t,this.pushable=kt({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,Fr(ma(this.pushable,this.closeController.signal,{returnOnAbort:!0}),s=>li(s),this.rawStream).catch(r)}get protocol(){return this.rawStream.protocol}push(t){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(t)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}},di=class{source;rawStream;closeController;constructor(t,r={}){this.rawStream=t,this.closeController=new AbortController,this.source=ma(Fr(this.rawStream,n=>Xn(n,r)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}};var hh=he(so(),1),lh={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function ph(e,t){t={...t};let r=hh.default.Reader.create(e),n=e.length,s=n===void 0?r.len:r.pos+n,i={};for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.length<t.maxSubscriptions?i.subscriptions.push(e1(r,r.uint32())):r.skipType(o&7);break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.length<t.maxMessages?i.messages.push(t1(r,r.uint32())):r.skipType(o&7);break;case 3:i.control=r1(r,r.uint32(),t);break;default:r.skipType(o&7);break}}return i}function e1(e,t){let r=t===void 0?e.len:e.pos+t,n={};for(;e.pos<r;){let s=e.uint32();switch(s>>>3){case 1:n.subscribe=e.bool();break;case 2:n.topic=e.string();break;default:e.skipType(s&7);break}}return n}function t1(e,t){let r=t===void 0?e.len:e.pos+t,n={};for(;e.pos<r;){let s=e.uint32();switch(s>>>3){case 1:n.from=e.bytes();break;case 2:n.data=e.bytes();break;case 3:n.seqno=e.bytes();break;case 4:n.topic=e.string();break;case 5:n.signature=e.bytes();break;case 6:n.key=e.bytes();break;default:e.skipType(s&7);break}}if(!n.topic)throw Error("missing required 'topic'");return n}function r1(e,t,r){let n=t===void 0?e.len:e.pos+t,s={};for(;e.pos<n;){let i=e.uint32();switch(i>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.length<r.maxControlMessages?s.ihave.push(n1(e,e.uint32(),r)):e.skipType(i&7);break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.length<r.maxControlMessages?s.iwant.push(s1(e,e.uint32(),r)):e.skipType(i&7);break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.length<r.maxControlMessages?s.graft.push(i1(e,e.uint32())):e.skipType(i&7);break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.length<r.maxControlMessages?s.prune.push(o1(e,e.uint32(),r)):e.skipType(i&7);break;default:e.skipType(i&7);break}}return s}function n1(e,t,r){let n=t===void 0?e.len:e.pos+t,s={};for(;e.pos<n;){let i=e.uint32();switch(i>>>3){case 1:s.topicID=e.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIhaveMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(i&7);break;default:e.skipType(i&7);break}}return s}function s1(e,t,r){let n=t===void 0?e.len:e.pos+t,s={};for(;e.pos<n;){let i=e.uint32();switch(i>>>3){case 1:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIwantMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(i&7);break;default:e.skipType(i&7);break}}return s}function i1(e,t){let r=t===void 0?e.len:e.pos+t,n={};for(;e.pos<r;){let s=e.uint32();switch(s>>>3){case 1:n.topicID=e.string();break;default:e.skipType(s&7);break}}return n}function o1(e,t,r){let n=t===void 0?e.len:e.pos+t,s={};for(;e.pos<n;){let i=e.uint32();switch(i>>>3){case 1:s.topicID=e.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),r.maxPeerInfos-- >0?s.peers.push(a1(e,e.uint32())):e.skipType(i&7);break;case 3:s.backoff=e.uint64();break;default:e.skipType(i&7);break}}return s}function a1(e,t){let r=t===void 0?e.len:e.pos+t,n={};for(;e.pos<r;){let s=e.uint32();switch(s>>>3){case 1:n.peerID=e.bytes();break;case 2:n.signedPeerRecord=e.bytes();break;default:e.skipType(s&7);break}}return n}var gi=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,s){return this.readAtomically(()=>{let i=0,o=0,a=this.peekChar();if(a===void 0)return;let f=a==="0",u=2**(8*s)-1;for(;;){let c=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let l=Number.parseInt(h,t);if(!Number.isNaN(l))return l});if(c===void 0)break;if(i*=t,i+=c,i>u||(o+=1,r!==void 0&&o>r))return}if(o!==0)return!n&&f&&o>1?void 0:i})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let s=n*2;if(n<r.length-3){let o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(o!==void 0)return r[s]=o[0],r[s+1]=o[1],r[s+2]=o[2],r[s+3]=o[3],[s+4,!0]}let i=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(i===void 0)return[s,!1];r[s]=i>>8,r[s+1]=i&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,s]=t(r);if(n===16)return r;if(s||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let i=new Uint8Array(14),o=16-(n+2),[a]=t(i.subarray(0,o));return r.set(i.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var c1=45;var dh=new gi;function yi(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>c1))return dh.new(e).parseWith(()=>dh.readIPAddr())}var z4=parseInt("0xFFFF",16),H4=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);var g1=Math.pow(2,7),y1=Math.pow(2,14),m1=Math.pow(2,21),va=Math.pow(2,28),xa=Math.pow(2,35),wa=Math.pow(2,42),Sa=Math.pow(2,49),He=128,Ge=127;function mi(e){if(e<g1)return 1;if(e<y1)return 2;if(e<m1)return 3;if(e<va)return 4;if(e<xa)return 5;if(e<wa)return 6;if(e<Sa)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function b1(e,t){let r=e[t],n=0;if(n+=r&Ge,r<He||(r=e[t+1],n+=(r&Ge)<<7,r<He)||(r=e[t+2],n+=(r&Ge)<<14,r<He)||(r=e[t+3],n+=(r&Ge)<<21,r<He)||(r=e[t+4],n+=(r&Ge)*va,r<He)||(r=e[t+5],n+=(r&Ge)*xa,r<He)||(r=e[t+6],n+=(r&Ge)*wa,r<He)||(r=e[t+7],n+=(r&Ge)*Sa,r<He))return n;throw new RangeError("Could not decode varint")}function v1(e,t){let r=e.get(t),n=0;if(n+=r&Ge,r<He||(r=e.get(t+1),n+=(r&Ge)<<7,r<He)||(r=e.get(t+2),n+=(r&Ge)<<14,r<He)||(r=e.get(t+3),n+=(r&Ge)<<21,r<He)||(r=e.get(t+4),n+=(r&Ge)*va,r<He)||(r=e.get(t+5),n+=(r&Ge)*xa,r<He)||(r=e.get(t+6),n+=(r&Ge)*wa,r<He)||(r=e.get(t+7),n+=(r&Ge)*Sa,r<He))return n;throw new RangeError("Could not decode varint")}function bi(e,t=0){return e instanceof Uint8Array?b1(e,t):v1(e,t)}function Ea(e){return!!yi(e)}var mh=function(e,t=0,r){t=~~t,r=r??e.length-t;let n=new DataView(e.buffer);if(r===4){let s=[];for(let i=0;i<r;i++)s.push(e[t+i]);return s.join(".")}if(r===16){let s=[];for(let i=0;i<r;i+=2)s.push(n.getUint16(t+i).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ia={},_a={},S1=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];S1.forEach(e=>{let t=E1(...e);_a[t.code]=t,Ia[t.name]=t});function E1(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:!!n,path:!!s}}function Jn(e){if(typeof e=="number"){if(_a[e]!=null)return _a[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Ia[e]!=null)return Ia[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var D8=Jn("ip4"),k8=Jn("ip6"),M8=Jn("ipcidr");function xh(e,t){switch(Jn(e).code){case 4:case 41:return I1(t);case 42:return bh(t);case 6:case 273:case 33:case 132:return wh(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bh(t);case 421:return C1(t);case 444:return vh(t);case 445:return vh(t);case 466:return _1(t);default:return le(t,"base16")}}var Ca=Object.values(Jt).map(e=>e.decoder),N8=function(){let e=Ca[0].or(Ca[1]);return Ca.slice(2).forEach(t=>e=e.or(t)),e}();function I1(e){let t=mh(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!Ea(t))throw new Error("invalid ip address");return t}function wh(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function bh(e){let t=bi(e);if(e=e.slice(mi(t)),e.length!==t)throw new Error("inconsistent lengths");return le(e)}function _1(e){let t=bi(e),r=e.slice(mi(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+le(r,"base64url")}function C1(e){let t=bi(e),r=e.slice(mi(t));if(r.length!==t)throw new Error("inconsistent lengths");return le(r,"base58btc")}function vh(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=le(t,"base32"),s=wh(r);return`${n}:${s}`}var vi;(function(e){e[e.ip4=4]="ip4",e[e.ip6=41]="ip6"})(vi||(vi={}));function Sh(e){for(let t of e.tuples())switch(t[0]){case vi.ip4:case vi.ip6:return xh(t[0],t[1])}return null}var rb=gs,ot;(function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"})(ot||(ot={}));var xi=class extends as{globalSignaturePolicy;multicodecs=[gs,oo];publishConfig;dataTransform;peers=new Set;streamsInbound=new Map;streamsOutbound=new Map;outboundInflightQueue=kt({objectMode:!0});direct=new Set;floodsubPeers=new Set;seenCache;acceptFromWhitelist=new Map;topics=new Map;subscriptions=new Set;mesh=new Map;fanout=new Map;fanoutLastpub=new Map;gossip=new Map;control=new Map;peerhave=new Map;iasked=new Map;backoff=new Map;outbound=new Map;msgIdFn;fastMsgIdFn;msgIdToStrFn;fastMsgIdCache;publishedMessageIds;mcache;score;topicValidators=new Map;log;heartbeatTicks=0;gossipTracer;components;directPeerInitial=null;static multicodec=gs;opts;decodeRpcLimits;metrics;status={code:ot.stopped};maxInboundStreams;maxOutboundStreams;allowedTopics;heartbeatTimer=null;constructor(t,r={}){super();let n={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...r,scoreParams:q0(r.scoreParams),scoreThresholds:z0(r.scoreThresholds)};if(this.components=t,this.decodeRpcLimits=n.decodeRpcLimits??lh,this.globalSignaturePolicy=n.globalSignaturePolicy??Mr,n.fallbackToFloodsub&&this.multicodecs.push(io),this.log=os(n.debugName??"libp2p:gossipsub"),this.opts=n,this.direct=new Set(n.directPeers.map(s=>s.id.toString())),this.seenCache=new dn({validityMs:n.seenTTL}),this.publishedMessageIds=new dn({validityMs:n.seenTTL}),r.msgIdFn)this.msgIdFn=r.msgIdFn;else switch(this.globalSignaturePolicy){case Mr:this.msgIdFn=th;break;case ln:this.msgIdFn=rh;break}if(r.fastMsgIdFn&&(this.fastMsgIdFn=r.fastMsgIdFn,this.fastMsgIdCache=new dn({validityMs:n.seenTTL})),this.msgIdToStrFn=r.msgIdToStrFn??gu,this.mcache=r.messageCache||new cs(n.mcacheGossip,n.mcacheLength,this.msgIdToStrFn),r.dataTransform&&(this.dataTransform=r.dataTransform),r.metricsRegister){if(!r.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let s=Math.max(...Object.values(n.scoreParams.topics).map(o=>o.meshMessageDeliveriesWindow),1e3),i=Z0(r.metricsRegister,r.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:n.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:s/1e3});i.mcacheSize.addCollect(()=>this.onScrapeMetrics(i));for(let o of this.multicodecs)i.protocolsEnabled.set({protocol:o},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new ai(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new oi(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:n.heartbeatInterval}),this.maxInboundStreams=r.maxInboundStreams,this.maxOutboundStreams=r.maxOutboundStreams,this.allowedTopics=n.allowedTopics?new Set(n.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(t=>Lt(t))}isStarted(){return this.status.code===ot.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await ya(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=kt({objectMode:!0}),Fr(this.outboundInflightQueue,async i=>{for await(let{peerId:o,connection:a}of i)await this.createOutboundStream(o,a)}).catch(i=>this.log.error("outbound inflight queue error",i)),await Promise.all(this.opts.directPeers.map(async i=>{await this.components.peerStore.merge(i.id,{multiaddrs:i.addrs})}));let t=this.components.registrar;await Promise.all(this.multicodecs.map(i=>t.handle(i,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)},n=await Promise.all(this.multicodecs.map(i=>t.register(i,r))),s=setTimeout(this.runHeartbeat,100);this.status={code:ot.started,registrarTopologyIds:n,heartbeatTimeout:s,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async i=>await this.connect(i)))}).catch(i=>{this.log(i)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==ot.started)return;let{registrarTopologyIds:t}=this.status;this.status={code:ot.stopped};let r=this.components.registrar;await Promise.all(this.multicodecs.map(n=>r.unhandle(n))),t.forEach(n=>r.unregister(n)),this.outboundInflightQueue.end();for(let n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(let n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:t,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.direction,r.remoteAddr),this.createInboundStream(n,t),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(t,r){this.metrics?.newConnectionCount.inc({status:r.status}),!(!this.isStarted()||r.status!=="open")&&(this.addPeer(t,r.direction,r.remoteAddr),this.outboundInflightQueue.push({peerId:t,connection:r}))}onPeerDisconnected(t){this.log("connection ended %p",t),this.removePeer(t)}async createOutboundStream(t,r){if(!this.isStarted())return;let n=t.toString();if(this.peers.has(n)&&!this.streamsOutbound.has(n))try{let s=new pi(await r.newStream(this.multicodecs),o=>this.log.error("outbound pipe error",o),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",t),this.streamsOutbound.set(n,s);let i=s.protocol;i===io&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:i},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(s){this.log.error("createOutboundStream error",s)}}async createInboundStream(t,r){if(!this.isStarted())return;let n=t.toString();if(!this.peers.has(n))return;let s=this.streamsInbound.get(n);s!==void 0&&(this.log("replacing existing inbound steam %s",n),s.close()),this.log("create inbound stream %s",n);let i=new di(r,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,i),this.pipePeerReadStream(t,i.source).catch(o=>this.log(o))}addPeer(t,r,n){let s=t.toString();if(!this.peers.has(s)){this.log("new peer %p",t),this.peers.add(s),this.score.addPeer(s);let i=Sh(n);i!==null?this.score.addIP(s,i):this.log("Added peer has no IP in current address %s %s",s,n.toString()),this.outbound.has(s)||this.outbound.set(s,r==="outbound")}}removePeer(t){let r=t.toString();if(!this.peers.has(r))return;this.log("delete peer %p",t),this.peers.delete(r);let n=this.streamsOutbound.get(r),s=this.streamsInbound.get(r);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),s?.close(),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let i of this.topics.values())i.delete(r);for(let[i,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(i,xt.Dc,1);for(let i of this.fanout.values())i.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===ot.started}getMeshPeers(t){let r=this.mesh.get(t);return r?Array.from(r):[]}getSubscribers(t){let r=this.topics.get(t);return(r?Array.from(r):[]).map(n=>Lt(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(t,r){try{await Fr(r,async n=>{for await(let s of n)try{let i=s.subarray(),o=ph(i,this.decodeRpcLimits);if(this.metrics?.onRpcRecv(o,i.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(t,o)}catch(a){this.metrics?.onRpcRecvError(),this.log(a)}else this.handleReceivedRpc(t,o).catch(a=>{this.metrics?.onRpcRecvError(),this.log(a)})}catch(i){this.metrics?.onRpcDataError(),this.log(i)}})}catch(n){this.metrics?.onPeerReadStreamError(),this.handlePeerReadStreamError(n,t)}}handlePeerReadStreamError(t,r){this.log.error(t),this.onPeerDisconnected(r)}async handleReceivedRpc(t,r){if(!this.acceptFrom(t.toString())){this.log("received message from unacceptable peer %p",t),this.metrics?.rpcRecvNotAccepted.inc();return}let n=r.subscriptions?r.subscriptions.length:0,s=r.messages?r.messages.length:0,i=0,o=0,a=0,f=0;if(r.control&&(r.control.ihave&&(i=r.control.ihave.length),r.control.iwant&&(o=r.control.iwant.length),r.control.graft&&(a=r.control.graft.length),r.control.prune&&(f=r.control.prune.length)),this.log(`rpc.from ${t.toString()} subscriptions ${n} messages ${s} ihave ${i} iwant ${o} graft ${a} prune ${f}`),r.subscriptions&&r.subscriptions.length>0){let u=[];r.subscriptions.forEach(c=>{let h=c.topic,l=c.subscribe===!0;if(h!=null){if(this.allowedTopics&&!this.allowedTopics.has(h))return;this.handleReceivedSubscription(t,h,l),u.push({topic:h,subscribe:l})}}),this.dispatchEvent(new er("subscription-change",{detail:{peerId:t,subscriptions:u}}))}if(r.messages)for(let u of r.messages){if(this.allowedTopics&&!this.allowedTopics.has(u.topic))continue;let c=this.handleReceivedMessage(t,u).catch(h=>{this.metrics?.onMsgRecvError(u.topic),this.log(h)});this.opts.awaitRpcMessageHandler&&await c}r.control&&await this.handleControlMessage(t.toString(),r.control)}handleReceivedSubscription(t,r,n){this.log("subscription update from %p topic %s",t,r);let s=this.topics.get(r);s==null&&(s=new Set,this.topics.set(r,s)),n?s.add(t.toString()):s.delete(t.toString())}async handleReceivedMessage(t,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(t,r);switch(this.metrics?.onPrevalidationResult(r.topic,n.code),n.code){case ze.duplicate:this.score.duplicateMessage(t.toString(),n.msgIdStr,r.topic),this.gossipTracer.deliverMessage(n.msgIdStr,!0),this.mcache.observeDuplicate(n.msgIdStr,t.toString());return;case ze.invalid:if(n.msgIdStr){let s=n.msgIdStr;this.score.rejectMessage(t.toString(),s,r.topic,n.reason),this.gossipTracer.rejectMessage(s,n.reason)}else this.score.rejectInvalidMessage(t.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case ze.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.peerId.equals(t)||this.opts.emitSelf)&&(super.dispatchEvent(new er("gossipsub:message",{detail:{propagationSource:t,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new er("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,t.toString())}}async validateReceivedMessage(t,r){let n=this.fastMsgIdFn?.(r),s=n!==void 0?this.fastMsgIdCache?.get(n):void 0;if(s)return{code:ze.duplicate,msgIdStr:s};let i=await J0(this.globalSignaturePolicy,r);if(!i.valid)return{code:ze.invalid,reason:Ye.Error,error:i.error};let o=i.message;try{this.dataTransform&&(o.data=this.dataTransform.inboundTransform(r.topic,o.data))}catch(h){return this.log("Invalid message, transform failed",h),{code:ze.invalid,reason:Ye.Error,error:Ve.TransformFailed}}let a=await this.msgIdFn(o),f=this.msgIdToStrFn(a),u={msgId:a,msgIdStr:f};if(n!==void 0&&this.fastMsgIdCache&&this.fastMsgIdCache.put(n,f)&&this.metrics?.fastMsgIdCacheCollision.inc(),this.seenCache.has(f))return{code:ze.duplicate,msgIdStr:f};this.seenCache.put(f);let c=this.topicValidators.get(r.topic);if(c!=null){let h;try{h=await c(t,o)}catch(l){let g=l.code;g===lu&&(h=$e.Ignore),g===hu?h=$e.Reject:h=$e.Ignore}if(h!==$e.Accept)return{code:ze.invalid,reason:ga(h),msgIdStr:f}}return{code:ze.valid,messageId:u,msg:o}}getScore(t){return this.score.score(t)}sendSubscriptions(t,r,n){this.sendRpc(t,{subscriptions:r.map(s=>({topic:s,subscribe:n}))})}async handleControlMessage(t,r){if(r===void 0)return;let n=r.ihave?this.handleIHave(t,r.ihave):[],s=r.iwant?this.handleIWant(t,r.iwant):[],i=r.graft?await this.handleGraft(t,r.graft):[];if(r.prune&&await this.handlePrune(t,r.prune),!n.length&&!s.length&&!i.length)return;let o=this.sendRpc(t,{messages:s,control:{iwant:n,prune:i}}),a=n[0]?.messageIDs;a&&(o?this.gossipTracer.addPromise(t,a):this.metrics?.iwantPromiseUntracked.inc(1))}acceptFrom(t){if(this.direct.has(t))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(t);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let s=this.score.score(t);return s>=0?this.acceptFromWhitelist.set(t,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(t),s>=this.opts.scoreThresholds.graylistThreshold}handleIHave(t,r){if(!r.length)return[];let n=this.score.score(t);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",t,n),this.metrics?.ihaveRcvIgnored.inc({reason:mn.LowScore}),[];let s=(this.peerhave.get(t)??0)+1;if(this.peerhave.set(t,s),s>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",t,s),this.metrics?.ihaveRcvIgnored.inc({reason:mn.MaxIhave}),[];let i=this.iasked.get(t)??0;if(i>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",t,i),this.metrics?.ihaveRcvIgnored.inc({reason:mn.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:c})=>{if(!u||!c||!this.mesh.has(u))return;let h=0;c.forEach(l=>{let g=this.msgIdToStrFn(l);this.seenCache.has(g)||(o.set(g,l),h++)}),this.metrics?.onIhaveRcv(u,c.length,h)}),!o.size)return[];let a=o.size;a+i>5e3&&(a=5e3-i),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,t);let f=Array.from(o.values());return St(f),f=f.slice(0,a),this.iasked.set(t,i+a),[{messageIDs:f}]}handleIWant(t,r){if(!r.length)return[];let n=this.score.score(t);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",t,n),[];let s=new Map,i=new Map,o=0;return r.forEach(({messageIDs:a})=>{a&&a.forEach(f=>{let u=this.msgIdToStrFn(f),c=this.mcache.getWithIWantCount(u,t);if(c==null){o++;return}if(i.set(c.msg.topic,1+(i.get(c.msg.topic)??0)),c.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",t,f);return}s.set(u,c.msg)})}),this.metrics?.onIwantRcv(i,o),s.size?(this.log("IWANT: Sending %d messages to %s",s.size,t),Array.from(s.values())):(this.log("IWANT: Could not provide any wanted messages to %s",t),[])}async handleGraft(t,r){let n=[],s=this.score.score(t),i=Date.now(),o=this.opts.doPX;if(r.forEach(({topicID:f})=>{if(!f)return;let u=this.mesh.get(f);if(!u){o=!1;return}if(u.has(t))return;if(this.direct.has(t)){this.log("GRAFT: ignoring request from direct peer %s",t),n.push(f),o=!1;return}let c=this.backoff.get(f)?.get(t);if(typeof c=="number"&&i<c){this.log("GRAFT: ignoring backed off peer %s",t),this.score.addPenalty(t,1,yn.GraftBackoff),o=!1;let h=c+this.opts.graftFloodThreshold-this.opts.pruneBackoff;i<h&&this.score.addPenalty(t,1,yn.GraftBackoff),this.addBackoff(t,f),n.push(f);return}if(s<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",t,s,f),n.push(f),o=!1,this.addBackoff(t,f);return}if(u.size>=this.opts.Dhi&&!this.outbound.get(t)){n.push(f),this.addBackoff(t,f);return}this.log("GRAFT: Add mesh link from %s in %s",t,f),this.score.graft(t,f),u.add(t),this.metrics?.onAddToMesh(f,Qe.Subscribed,1)}),!n.length)return[];await this.components.peerStore.merge(Lt(t),{tags:{"gossipsub-mesh-peer":{value:100}}});let a=!1;return await Promise.all(n.map(f=>this.makePrune(t,f,o,a)))}async handlePrune(t,r){let n=this.score.score(t);for(let{topicID:s,backoff:i,peers:o}of r){if(s==null)continue;let a=this.mesh.get(s);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",t,s),this.score.prune(t,s),a.has(t)&&(a.delete(t),this.metrics?.onRemoveFromMesh(s,xt.Prune,1)),typeof i=="number"&&i>0?this.doAddBackoff(t,s,i*1e3):this.addBackoff(t,s),o&&o.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",t,n,s);continue}await this.pxConnect(o)}}await this.components.peerStore.save(Lt(t),{tags:{"gossipsub-mesh-peer":{}}})}addBackoff(t,r){this.doAddBackoff(t,r,this.opts.pruneBackoff)}doAddBackoff(t,r,n){let s=this.backoff.get(r);s||(s=new Map,this.backoff.set(r,s));let i=Date.now()+n;(s.get(t)??0)<i&&s.set(t,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((t,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,t),this.score.addPenalty(r,t,yn.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let t=Date.now();this.backoff.forEach((r,n)=>{r.forEach((s,i)=>{s+1*this.opts.heartbeatInterval<t&&r.delete(i)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let t=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||t.push(r)}),await Promise.all(t.map(async r=>await this.connect(r)))}async pxConnect(t){t.length>this.opts.prunePeers&&(St(t),t=t.slice(0,this.opts.prunePeers));let r=[];await Promise.all(t.map(async n=>{if(!n.peerID)return;let s=Wr(n.peerID),i=s.toString();if(!this.peers.has(i)){if(!n.signedPeerRecord){r.push(i);return}try{if(!await this.components.peerStore.consumePeerRecord(n.signedPeerRecord,s)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(i)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(t){this.log("Initiating connection with %s",t);let r=Lt(t),n=await this.components.connectionManager.openConnection(r);for(let s of this.multicodecs)for(let i of this.components.registrar.getTopologies(s))i.onConnect?.(r,n)}subscribe(t){if(this.status.code!==ot.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(t)){this.subscriptions.add(t);for(let r of this.peers.keys())this.sendSubscriptions(r,[t],!0)}this.join(t)}unsubscribe(t){if(this.status.code!==ot.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(t);if(this.log("unsubscribe from %s - am subscribed %s",t,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[t],!1);this.leave(t)}join(t){if(this.status.code!==ot.started)throw new Error("Gossipsub has not started");if(this.mesh.has(t))return;this.log("JOIN %s",t),this.metrics?.onJoin(t);let r=new Set,n=this.backoff.get(t),s=this.fanout.get(t);if(s&&(this.fanout.delete(t),this.fanoutLastpub.delete(t),s.forEach(i=>{!this.direct.has(i)&&this.score.score(i)>=0&&(!n||!n.has(i))&&r.add(i)}),this.metrics?.onAddToMesh(t,Qe.Fanout,r.size)),r.size<this.opts.D){let i=r.size;this.getRandomGossipPeers(t,this.opts.D,a=>!r.has(a)&&!this.direct.has(a)&&this.score.score(a)>=0&&(!n||!n.has(a))).forEach(a=>{r.add(a)}),this.metrics?.onAddToMesh(t,Qe.Random,r.size-i)}this.mesh.set(t,r),r.forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,t),this.sendGraft(i,t)})}leave(t){if(this.status.code!==ot.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",t),this.metrics?.onLeave(t);let r=this.mesh.get(t);r&&(Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,t),await this.sendPrune(n,t)))).catch(n=>{this.log("Error sending prunes to mesh peers",n)}),this.mesh.delete(t))}selectPeersToForward(t,r,n){let s=new Set,i=this.topics.get(t);i&&(this.direct.forEach(a=>{i.has(a)&&r!==a&&!n?.has(a)&&s.add(a)}),this.floodsubPeers.forEach(a=>{i.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&s.add(a)}));let o=this.mesh.get(t);return o&&o.size>0&&o.forEach(a=>{r!==a&&!n?.has(a)&&s.add(a)}),s}selectPeersToPublish(t){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},s=this.topics.get(t);if(s)if(this.opts.floodPublish)s.forEach(i=>{this.direct.has(i)?(r.add(i),n.direct++):this.score.score(i)>=this.opts.scoreThresholds.publishThreshold&&(r.add(i),n.floodsub++)});else{this.direct.forEach(o=>{s.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{s.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let i=this.mesh.get(t);if(i&&i.size>0)i.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(t);if(o&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(t,this.opts.D,f=>this.score.score(f)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(t,a),a.forEach(f=>{r.add(f),n.fanout++}))}this.fanoutLastpub.set(t,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(t,r,n,s){n&&this.score.deliverMessage(n,t,r.topic);let i=this.selectPeersToForward(r.topic,n,s);i.forEach(o=>{this.sendRpc(o,{messages:[r]})}),this.metrics?.onForwardMsg(r.topic,i.size)}async publish(t,r,n){let s=Date.now(),i=this.dataTransform?this.dataTransform.outboundTransform(t,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let{raw:o,msg:a}=await X0(this.publishConfig,t,r,i),f=await this.msgIdFn(a),u=this.msgIdToStrFn(f),c=n?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(u)){if(c)return this.metrics?.onPublishDuplicateMsg(t),{recipients:[]};throw Error("PublishError.Duplicate")}let{tosend:h,tosendCount:l}=this.selectPeersToPublish(t),g=this.opts.emitSelf===!0&&this.subscriptions.has(t),p=n?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(h.size===0&&!p&&!g)throw Error("PublishError.InsufficientPeers");this.seenCache.put(u),this.mcache.put({msgId:f,msgIdStr:u},o,!0),this.publishedMessageIds.put(u);for(let y of h)this.sendRpc(y,{messages:[o]})||h.delete(y);let d=Date.now()-s;return this.metrics?.onPublishMsg(t,l,h.size,o.data!=null?o.data.length:0,d),g&&(h.add(this.components.peerId.toString()),super.dispatchEvent(new er("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:u,msg:a}})),super.dispatchEvent(new er("message",{detail:a}))),{recipients:Array.from(h.values()).map(y=>Lt(y))}}reportMessageValidationResult(t,r,n){let s;if(n===$e.Accept){if(s=this.mcache.validate(t),s!=null){let{message:o,originatingPeers:a}=s;this.score.deliverMessage(r,t,o.topic),this.forwardMessage(t,s.message,r,a)}}else if(s=this.mcache.remove(t),s){let o=ga(n),{message:a,originatingPeers:f}=s;this.score.rejectMessage(r,t,a.topic,o);for(let u of f)this.score.rejectMessage(u,t,a.topic,o)}let i=this.score.messageFirstSeenTimestampMs(t);this.metrics?.onReportValidation(s,n,i)}sendGraft(t,r){let n=[{topicID:r}];this.sendRpc(t,{control:{graft:n}})}async sendPrune(t,r){let s=[await this.makePrune(t,r,this.opts.doPX,!0)];this.sendRpc(t,{control:{prune:s}})}sendRpc(t,r){let n=this.streamsOutbound.get(t);if(!n)return this.log(`Cannot send RPC to ${t} as there is no open stream to it available`),!1;let s=this.control.get(t);s&&(this.piggybackControl(t,r,s),this.control.delete(t));let i=this.gossip.get(t);i&&(this.piggybackGossip(t,r,i),this.gossip.delete(t));let o=kn.encode(r).finish();try{n.push(o)}catch(a){return this.log.error(`Cannot send rpc to ${t}`,a),s&&this.control.set(t,s),i&&this.gossip.set(t,i),!1}return this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(t,r,n){if(n.graft){r.control||(r.control={}),r.control.graft||(r.control.graft=[]);for(let s of n.graft)s.topicID&&this.mesh.get(s.topicID)?.has(t)&&r.control.graft.push(s)}if(n.prune){r.control||(r.control={}),r.control.prune||(r.control.prune=[]);for(let s of n.prune)s.topicID&&!this.mesh.get(s.topicID)?.has(t)&&r.control.prune.push(s)}}piggybackGossip(t,r,n){r.control||(r.control={}),r.control.ihave=n}async sendGraftPrune(t,r,n){let s=this.opts.doPX,i=!1;for(let[o,a]of t){let f=a.map(h=>({topicID:h})),u=[],c=r.get(o);c&&(u=await Promise.all(c.map(async h=>await this.makePrune(o,h,s&&!(n.get(o)??!1),i))),r.delete(o)),this.sendRpc(o,{control:{graft:f,prune:u}})}for(let[o,a]of r){let f=await Promise.all(a.map(async u=>await this.makePrune(o,u,s&&!(n.get(o)??!1),i)));this.sendRpc(o,{control:{prune:f}})}}emitGossip(t){let r=this.mcache.getGossipIDs(new Set(t.keys()));for(let[n,s]of t)this.doEmitGossip(n,s,r.get(n)??[])}doEmitGossip(t,r,n){if(!n.length||(St(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!r.size))return;let s=this.opts.Dlazy,i=.25*r.size,o=r;i>s&&(s=i),s>o.size?s=o.size:o=St(Array.from(o)).slice(0,s),o.forEach(a=>{let f=n;n.length>5e3&&(f=St(f.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:t,messageIDs:f})})}flush(){for(let[t,r]of this.gossip.entries())this.gossip.delete(t),this.sendRpc(t,{control:{ihave:r}});for(let[t,r]of this.control.entries())this.control.delete(t),this.sendRpc(t,{control:{graft:r.graft,prune:r.prune}})}pushGossip(t,r){this.log("Add gossip to %s",t);let n=this.gossip.get(t)||[];this.gossip.set(t,n.concat(r))}async makePrune(t,r,n,s){if(this.score.prune(t,r),this.streamsOutbound.get(t).protocol===oo)return{topicID:r,peers:[]};let i=s?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,o=i/1e3;if(this.doAddBackoff(t,r,i),!n)return{topicID:r,peers:[],backoff:o};let a=this.getRandomGossipPeers(r,this.opts.prunePeers,u=>u!==t&&this.score.score(u)>=0),f=await Promise.all(Array.from(a).map(async u=>{let c=Lt(u),h;try{h=await this.components.peerStore.get(c)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}return{peerID:c.toBytes(),signedPeerRecord:h?.peerRecordEnvelope}}));return{topicID:r,peers:f,backoff:o}}runHeartbeat=()=>{let t=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(r=>{this.log("Error running heartbeat",r)}).finally(()=>{if(t?.(),this.status.code===ot.started){clearTimeout(this.status.heartbeatTimeout);let r=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;r<this.opts.heartbeatInterval*.25&&(r+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,r)}})};async heartbeat(){let{D:t,Dlo:r,Dhi:n,Dscore:s,Dout:i,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,f=p=>{let d=a.get(p);return d===void 0&&(d=this.score.score(p),a.set(p,d)),d},u=new Map,c=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,d)=>{let y=this.topics.get(d),m=new Set,E=new Set;if(l.set(d,E),y){let b=St(Array.from(y)),w=this.backoff.get(d);for(let _ of b){let A=this.streamsOutbound.get(_);if(A&&this.multicodecs.includes(A.protocol)&&!p.has(_)&&!this.direct.has(_)){let F=f(_);(!w||!w.has(_))&&F>=0&&m.add(_),F>=this.opts.scoreThresholds.gossipThreshold&&E.add(_)}}}let x=(b,w)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",b,d),this.addBackoff(b,d),p.delete(b),f(b)>=this.opts.scoreThresholds.gossipThreshold&&E.add(b),this.metrics?.onRemoveFromMesh(d,w,1);let _=c.get(b);_?_.push(d):c.set(b,[d])},C=(b,w)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",b,d),this.score.graft(b,d),p.add(b),E.delete(b),this.metrics?.onAddToMesh(d,w,1);let _=u.get(b);_?_.push(d):u.set(b,[d])};if(p.forEach(b=>{let w=f(b);w<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,w,d),x(b,xt.BadScore),h.set(b,!0))}),p.size<r){let b=t-p.size;$0(m,b).forEach(_=>{C(_,Qe.NotEnough)})}if(p.size>n){let b=Array.from(p);b.sort((_,A)=>f(A)-f(_)),b=b.slice(0,s).concat(St(b.slice(s)));let w=0;if(b.slice(0,t).forEach(_=>{this.outbound.get(_)&&w++}),w<i){let _=F=>{let K=b[F];for(let q=F;q>0;q--)b[q]=b[q-1];b[0]=K};if(w>0){let F=w;for(let K=1;K<t&&F>0;K++)this.outbound.get(b[K])&&(_(K),F--)}let A=t-w;for(let F=t;F<b.length&&A>0;F++)this.outbound.get(b[F])&&(_(F),A--)}b.slice(t).forEach(_=>{x(_,xt.Excess)})}if(p.size>=r){let b=0;if(p.forEach(w=>{this.outbound.get(w)&&b++}),b<i){let w=i-b;ii(m,w,A=>this.outbound.get(A)===!0).forEach(A=>{C(A,Qe.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let b=Array.from(p).sort((A,F)=>f(A)-f(F)),w=Math.floor(p.size/2),_=f(b[w]);if(_<this.opts.scoreThresholds.opportunisticGraftThreshold){let A=this.opts.opportunisticGraftPeers,F=ii(m,A,K=>f(K)>_);for(let K of F)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",K,d),C(K,Qe.Opportunistic)}}});let g=Date.now();this.fanoutLastpub.forEach((p,d)=>{p+o<g&&(this.fanout.delete(d),this.fanoutLastpub.delete(d))}),this.fanout.forEach((p,d)=>{let y=this.topics.get(d);p.forEach(C=>{(!y.has(C)||f(C)<this.opts.scoreThresholds.publishThreshold)&&p.delete(C)});let m=this.topics.get(d),E=[],x=new Set;if(l.set(d,x),m){let C=St(Array.from(m));for(let b of C){let w=this.streamsOutbound.get(b);if(w&&this.multicodecs.includes(w.protocol)&&!p.has(b)&&!this.direct.has(b)){let _=f(b);_>=this.opts.scoreThresholds.publishThreshold&&E.push(b),_>=this.opts.scoreThresholds.gossipThreshold&&x.add(b)}}}if(p.size<t){let C=t-p.size;E.slice(0,C).forEach(b=>{p.add(b),x?.delete(b)})}}),this.emitGossip(l),await this.sendGraftPrune(u,c,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new er("gossipsub:heartbeat"))}getRandomGossipPeers(t,r,n=()=>!0){let s=this.topics.get(t);if(!s)return new Set;let i=[];return s.forEach(o=>{let a=this.streamsOutbound.get(o);a&&this.multicodecs.includes(a.protocol)&&n(o)&&i.push(o)}),i=St(i),r>0&&i.length>r&&(i=i.slice(0,r)),new Set(i)}onScrapeMetrics(t){t.mcacheSize.set(this.mcache.size),t.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),t.cacheSize.set({cache:"direct"},this.direct.size),t.cacheSize.set({cache:"seenCache"},this.seenCache.size),t.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),t.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),t.cacheSize.set({cache:"mcache"},this.mcache.size),t.cacheSize.set({cache:"score"},this.score.size),t.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),t.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),t.cacheSize.set({cache:"topics"},this.topics.size),t.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),t.cacheSize.set({cache:"mesh"},this.mesh.size),t.cacheSize.set({cache:"fanout"},this.fanout.size),t.cacheSize.set({cache:"peers"},this.peers.size),t.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),t.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),t.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),t.cacheSize.set({cache:"gossip"},this.gossip.size),t.cacheSize.set({cache:"control"},this.control.size),t.cacheSize.set({cache:"peerhave"},this.peerhave.size),t.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0,n=Date.now();t.connectedPeersBackoffSec.reset();for(let a of this.backoff.values()){r+=a.size;for(let[f,u]of a.entries())this.peers.has(f)&&t.connectedPeersBackoffSec.observe(Math.max(0,u-n)/1e3)}t.cacheSize.set({cache:"backoff"},r);for(let[a,f]of this.topics)t.topicPeersCount.set({topicStr:a},f.size);for(let[a,f]of this.mesh)t.meshPeerCounts.set({topicStr:a},f.size);let s=[],i=new Map;t.behaviourPenalty.reset();for(let a of this.peers.keys()){let f=this.score.score(a);s.push(f),i.set(a,f),t.behaviourPenalty.observe(this.score.peerStats.get(a)?.behaviourPenalty??0)}t.registerScores(s,this.opts.scoreThresholds),t.registerScorePerMesh(this.mesh,i);let o=nh(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,t.topicStrToLabel);t.registerScoreWeights(o)}};function nb(e={}){return t=>new xi(t,e)}return Oh(sb);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PGossipsub}));
